0000                             ; ----------------------------------------------------------------------------
0000                             ;Micro-Soft Altair BASIC 3.2 (4K) - Annotated Disassembly
0000                             ;	
0000                             ;Copyright 1975, Bill Gates, Paul Allen, Monte Davidoff
0000                             ;Source: http://altairbasic.org/ compiled by Reuben Harris
0000                             ;Additional cleanup, relocation by Charles Mangin, March, 2019
0000                             ; ----------------------------------------------------------------------------
0000                UART_RX:   EQU   $18   
0000                UART_TX:   EQU   $18   
0000                UART_RX_STATUS:   EQU   $19   
0000                UART_TX_STATUS:   EQU   $19   
0000                UART_RX_FULL:   EQU   $01   
0000                UART_TX_FULL:   EQU   $04   
0000                STK_TOP:   EQU   0x0F1A   
0000                          .ORG   00   
0000   F3           START:    DI      
0001   C3 21 0D               JMP   Init   
0004   90 04                  DW   0490h   
0006   F9 07                  DW   07F9h   
0008   7E           SYNTAXCHECK:   MOV   A,M   ;A=Byte of BASIC program.
0009   E3                     XTHL      ;HL=return address.
000A   BE                     CMP   M   ;Compare to byte expected.
000B   23                     INX   H   ;Return address++;
000C   E3                     XTHL      ; 
000D   C2 D0 01               JNZ   SyntaxError   ;Error if not what was expected.
0010   23           NEXTCHAR:   INX   H   
0011   7E                     MOV   A,M   
0012   FE 3A                  CPI   0x3A   
0014   D0                     RNC      
0015   C3 5E 04               JMP   NextChar_tail   
0018   F5           OUTCHAR:   PUSH   PSW   
0019   3A 27 00               LDA   TERMINAL_X   
001C   C3 6E 03               JMP   OutChar_tail   
001F   00                     NOP      
0020   7C           COMPAREHLDE:   MOV   A,H   
0021   92                     SUB   D   
0022   C0                     RNZ      
0023   7D                     MOV   A,L   
0024   93                     SUB   E   
0025   C9                     RET      
0026   01           TERMINAL_Y:   DB   01   
0027   00           TERMINAL_X:   DB   00   
0028   3A 72 01     FTESTSIGN:   LDA   FACCUM+3   
002B   B7                     ORA   A   
002C   C2 DA 09               JNZ   FTestSign_tail   
002F   C9                     RET      
0030   E3           PUSHNEXTWORD:   XTHL      
0031   22 3B 00               SHLD   L003A+1   
0034   E1                     POP   H   
0035   4E                     MOV   C,M   
0036   23                     INX   H   
0037   46                     MOV   B,M   
0038   23                     INX   H   
0039   C5                     PUSH   B   
003A   C3 3A 00     L003A:    JMP   L003A   
003D   E4 09        KW_INLINE_FNS:   DW   Sgn   
003F   A2 0A                  DW   Int   
0041   F8 09                  DW   Abs   
0043   98 04                  DW   FunctionCallError   
0045   21 0C                  DW   Sqr   
0047   5F 0C                  DW   Rnd   
0049   95 0C                  DW   Sin   
004B   79           KW_ARITH_OP_FNS:   DB   79h   
004C   10 08                  DW   FAdd   ;+
004E   79                     DB   79h   
004F   0A 08                  DW   FSub   ;-
0051   7C                     DB   7Ch   
0052   E3 08                  DW   FMul   ;*
0054   7C                     DB   7Ch   
0055   2F 09                  DW   FDiv   ;/
0057   45 4E C4     KEYWORDS:   DB   45h,4Eh,0C4h   ;"END"	80
005A   46 4F D2               DB   46h,4Fh,0D2h   ; 	"FOR"
005D   4E 45 58 D4            DB   4Eh,45h,58h,0D4h   ; 	"NEXT"	82
0061   44 41 54 C1            DB   44h,41h,54h,0C1h   ; 	"DATA"	83
0065   49 4E 50 55 D4         DB   49h,4Eh,50h,55h,0D4h   ; 	"INPUT"	84
006A   44 49 CD               DB   44h,49h,0CDh   ; 	"DIM"	85
006D   52 45 41 C4            DB   52h,45h,41h,0C4h   ; 	"READ"	86
0071   4C 45 D4               DB   4Ch,45h,0D4h   ; 	"LET"	87
0074   47 4F 54 CF            DB   47h,4Fh,54h,0CFh   ; 	"GOTO"	88
0078   52 55 CE               DB   52h,55h,0CEh   ; 	"RUN"	89
007B   49 C6                  DB   49h,0C6h   ; 	"IF"	8A	; Ifl
007D   52 45 53 54 4F 52 C5   DB   52h,45h,53h,54h,4Fh,52h,0C5h   ; 	"RESTORE"	8B
0084   47 4F 53 55 C2         DB   47h,4Fh,53h,55h,0C2h   ; 	"GOSUB"	8C
0089   52 45 54 55 52 CE      DB   52h,45h,54h,55h,52h,0CEh   ; 	"RETURN"	8D
008F   52 45 CD               DB   52h,45h,0CDh   ; 	"REM"	8E
0092   53 54 4F D0            DB   53h,54h,4Fh,0D0h   ; 	"STOP"	8F
0096   50 52 49 4E D4         DB   50h,52h,49h,4Eh,0D4h   ; 	"PRINT"	90
009B   4C 49 53 D4            DB   4Ch,49h,53h,0D4h   ; 	"LIST"	91
009F   43 4C 45 41 D2         DB   43h,4Ch,45h,41h,0D2h   ; 	"CLEAR"	92
00A4   4E 45 D7               DB   4Eh,45h,0D7h   ; 	"NEW"	93
00A7                             ; 
00A7   54 41 42 A8            DB   54h,41h,42h,0A8h   ; 	"TAB("	94
00AB   54 CF                  DB   54h,0CFh   ; 	"TO"	95
00AD   54 48 45 CE            DB   54h,48h,45h,0CEh   ; 	"THEN"	96
00B1   53 54 45 D0            DB   53h,54h,45h,0D0h   ; 	"STEP"	97
00B5                             ; 
00B5   AB                     DB   0xAB   ; 	"+"	98
00B6   AD                     DB   0xAD   ; 	"-"	99
00B7   AA                     DB   0xAA   ; 	"*"	9A
00B8   AF                     DB   0xAF   ; 	"/"	9B
00B9   BE                     DB   0xBE   ; 	">"	9C
00BA   BD                     DB   0xBD   ; 	"="	9D
00BB   BC                     DB   0xBC   ; 	"<"	9E
00BC                             ; 
00BC   53 47 CE               DB   53h,47h,0CEh   ; 	"SGN"	9F
00BF   49 4E D4               DB   49h,4Eh,0D4h   ; 	"INT"	A0
00C2   41 42 D3               DB   41h,42h,0D3h   ; 	"ABS"	A1
00C5   55 53 D2               DB   55h,53h,0D2h   ; 	"USR"	A2
00C8   53 51 D2               DB   53h,51h,0D2h   ; 	"SQR"	A3
00CB   52 4E C4               DB   52h,4Eh,0C4h   ; 	"RND"	A4
00CE   53 49 CE               DB   53h,49h,0CEh   ; 	"SIN"	A5
00D1                             ; 
00D1   00                     DB   0x00   ; 	 	
00D2                             ; 
00D2   F7 01        KW_GENERAL_FNS:   DW   Stop   ;END
00D4   D5 03                  DW   For   ;FOR
00D6   49 06                  DW   Next   ;NEXT
00D8   F5 04                  DW   FindNextStatement   ;DATA
00DA   E4 05                  DW   Input   ;INPUT
00DC   16 07                  DW   Dim   ;DIM
00DE   F6 05                  DW   Read   ;READ
00E0   02 05                  DW   Let   ;LET
00E2   CF 04                  DW   Goto   ;GOTO
00E4   A1 02                  DW   Run   ;RUN
00E6   16 05                  DW   Ifl   ;IF
00E8   69 04                  DW   Restore   ;RESTORE
00EA   BE 04                  DW   Gosub   ;GOSUB
00EC   DF 04                  DW   Return   ;RETURN
00EE   F7 04                  DW   Rem   ;REM
00F0   F7 01                  DW   Stop   ;STOP
00F2   57 05                  DW   Print   ;PRINT
00F4   8E 03                  DW   List   ;LIST
00F6   A6 02                  DW   Clear   ;CLEAR
00F8   95 02                  DW   New   ;NEW
00FA   4E C6        ERROR_CODES:   DB   4Eh,0C6h   ;"NF"	NEXT without FOR.
00FC   53 CE                  DB   53h,0CEh   ;"SN"	Syntax Error
00FE   52 C7                  DB   52h,0C7h   ;"RG"	RETURN without GOSUB.
0100   4F C4                  DB   4Fh,0C4h   ;"OD"	Out of Data
0102   46 C3                  DB   46h,0C3h   ;"FC"	Illegal Function Call
0104   4F D6                  DB   4Fh,0D6h   ;"OV"	Overflow.
0106   4F CD                  DB   4Fh,0CDh   ;"OM"	Out of memory.
0108   55 D3                  DB   55h,0D3h   ;"US"	Undefined Subroutine
010A   42 D3                  DB   42h,0D3h   ;"BS"	Bad Subscript
010C   44 C4                  DB   44h,0C4h   ;"DD"	Duplicate Definition
010E   2F B0                  DB   2Fh,0B0h   ;"\0"	Division by zero.
0110   49 C4                  DB   49h,0C4h   ;"ID"	Invalid in Direct mode.
0112   2C                     DB   ","   ; 
0113   00 00 00 00 00 00 00 00 LINE_BUFFER:   DW   0000,0000,0000,0000h   ;72 chars
011B   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
0123   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
012B   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
0133   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
013B   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
0143   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
014B   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
0153   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ;		
015B   00           DIM_OR_EVAL:   DB   00h   ; 
015C   00           INPUT_OR_READ:   DB   00h   ; 
015D   00 00        PROG_PTR_TEMP:   DW   0000h   ; 
015F   00 00        L015F:    DW   0000h   ; 
0161   00 00        CURRENT_LINE:   DW   0000h   ; 
0163   1A 0F        STACK_TOP:   DW   0F1Ah   ; RELOCATE***
0165   00 00        PROGRAM_BASE:   DW   0000h   ; 
0167   00 00        VAR_BASE:   DW   0000h   ; 
0169   00 00        VAR_ARRAY_BASE:   DW   0000h   ; 
016B   00 00        VAR_TOP:   DW   0000h   ; 
016D   00 00        DATA_PROG_PTR:   DW   0000h   ; 
016F   00 00 00 00  FACCUM:   DB   00,00,00,00h   ; 
0173   00           FTEMP:    DB   00h   ; 
0174   00 00 00 00 00 00 FBUFFER:   DW   0000,0000,0000   
017A   00 00 00 00 00 00      DW   0000,0000,0000   
0180   00                     DB   00   ; 
0181   20 45 52 52 4F D2 00 SZERROR:   DB   0x20,0x45,0x52,0x52,0x4F,0xD2,0x00   ;" ERROR\0"	
0188   20 49 4E A0 00 SZIN:   DB   0x20,0x49,0x4E,0xA0,0x00   ;" IN \0"
018D   0D 4F CB 0D 00 SZOK:   DB   0x0D,0x4F,0xCB,0x0D,0x00   ;"\rOK\r\0"	
0192   21 04 00     GETFLOWPTR:   LXI   H,0004h   ;HL=SP+4 (ie get word
0195   39                     DAD   SP   ;just past return addr)
0196   7E                     MOV   A,M   ; 
0197   23                     INX   H   ; 
0198   FE 81                  CPI   0x81   ;"FOR"?
019A   C0                     RNZ      ;Return if not "FOR"
019B   F7                     RST   6   ; RST PushNextWord	;PUSH (HL)
019C   E3                     XTHL      ;POP HL (ie HL=(HL))
019D   E7                     RST   4   ; RST CompareHLDE	;HL==DE?
019E   01 0D 00               LXI   B,000Dh   ; 
01A1   E1                     POP   H   ;Restore HL
01A2   C8                     RZ      ;Return if var ptrs match.
01A3   09                     DAD   B   ;HL+=000D
01A4   C3 96 01               JMP   GetFlowPtr+4   ;Loop
01A7   CD C3 01     COPYMEMORYUP:   CALL   CheckEnoughMem   ; 
01AA   C5                     PUSH   B   ;Exchange BC with HL.
01AB   E3                     XTHL      ; 
01AC   C1                     POP   B   ; 
01AD   E7           COPYMEMLOOP:   RST   4   ;HL==DE?
01AE   7E                     MOV   A,M   ; 
01AF   02                     STAX   B   ; 
01B0   C8                     RZ      ;Exit if DE reached.
01B1   0B                     DCX   B   ; 
01B2   2B                     DCX   H   ; 
01B3   C3 AD 01               JMP   CopyMemLoop   ; 
01B6   E5           CHECKENOUGHVARSPACE:   PUSH   H   ; 
01B7   2A 6B 01               LHLD   VAR_TOP   ; 
01BA   06 00                  MVI   B,00h   ;BC=C*4
01BC   09                     DAD   B   ; 
01BD   09                     DAD   B   ; 
01BE   CD C3 01               CALL   CheckEnoughMem   ; 
01C1   E1                     POP   H   ; 
01C2   C9                     RET      ; 
01C3   D5           CHECKENOUGHMEM:   PUSH   D   ; 
01C4   EB                     XCHG      ; 
01C5   21 DE FF               LXI   H,0xFFDE   ;HL=-34 (extra 2 bytes for return address)
01C8   39                     DAD   SP   ; 
01C9   E7                     RST   4   ; 
01CA   EB                     XCHG      ; 
01CB   D1                     POP   D   ; 
01CC   D0                     RNC      ; 
01CD   1E 0C        OUTOFMEMORY:   MVI   E,0Ch   ; 
01CF   01                     DB   01   ;LXI B,....	;
01D0   1E 02        SYNTAXERROR:   MVI   E,02h   ; 
01D2   01                     DB   01   ;LXI B,....	;
01D3   1E 14        DIVIDEBYZERO:   MVI   E,14h   ; 
01D5   CD B5 02     ERROR:    CALL   ResetStack   ; 
01D8   CD 8A 05               CALL   NewLine   ; 
01DB   21 FA 00               LXI   H,ERROR_CODES   ; 
01DE   57                     MOV   D,A   ; 
01DF   3E 3F                  MVI   A,"?"   ;Print "?"
01E1   DF                     RST   03   ;RST OutChar	;
01E2   19                     DAD   D   ;HL points to error code.
01E3   7E                     MOV   A,M   ; 
01E4   DF                     RST   03   ;RST OutChar 11 011 111	;Print first char of code.
01E5   D7                     RST   02   ;RST NextChar 11 010 111	;
01E6   DF                     RST   03   ;RST OutChar	;Print second char of code.
01E7   21 81 01               LXI   H,szError   ;Print " ERROR".
01EA   CD A3 05               CALL   PrintString   ; 
01ED   2A 61 01               LHLD   CURRENT_LINE   ; 
01F0   7C                     MOV   A,H   ; 
01F1   A5                     ANA   L   ; 
01F2   3C                     INR   A   ; 
01F3   C4 2F 0B               CNZ   PrintIN   ; 
01F6   01                     DB   01   ;LXI B,....	;LXI over Stop and fall into Main
01F7   C0           STOP:     RNZ      ;Syntax Error if args.
01F8   C1                     POP   B   ;Lose return address.
01F9   21 8D 01     MAIN:     LXI   H,szOK   ; 
01FC   CD 21 0D               CALL   Init   ; 
01FF   21 FF FF     GETNONBLANKLINE:   LXI   H,0xFFFF   ; 
0202   22 61 01               SHLD   CURRENT_LINE   ; 
0205   CD 3C 03               CALL   InputLine   ; 
0208   D7                     RST   02   ;RST NextChar	;
0209   3C                     INR   A   ; 
020A   3D                     DCR   A   ; 
020B   CA FF 01               JZ   GetNonBlankLine   ; 
020E   F5                     PUSH   PSW   
020F   CD 9D 04               CALL   LineNumberFromStr   
0212   D5                     PUSH   D   
0213   CD CC 02               CALL   Tokenize   
0216   47                     MOV   B,A   
0217   D1                     POP   D   
0218   F1                     POP   PSW   
0219   D2 3E 04               JNC   Exec   
021C   D5           STOREPROGRAMLINE:   PUSH   D   ;Push line number
021D   C5                     PUSH   B   ;Push line length
021E   D7                     RST   02   ;RST NextChar	;Get first char of line
021F   B7                     ORA   A   ;Zero set if line is empty (ie removing a line)
0220   F5                     PUSH   PSW   ;Preserve line-empty flag
0221   CD 7D 02               CALL   FindProgramLine   ;Get nearest program line address in BC.
0224   C5                     PUSH   B   ;Push line address.
0225   D2 39 02               JNC   InsertProgramLine   ;If line doesn't exist, jump ahead to insert it.
0228   EB           REMOVEPROGRAMLINE:   XCHG      ;DE=Next line address.
0229   2A 67 01               LHLD   VAR_BASE   ; 
022C   1A           REMOVELINE:   LDAX   D   ;Move byte of program remainder down
022D   02                     STAX   B   ;in memory.
022E   03                     INX   B   ; 
022F   13                     INX   D   ; 
0230   E7                     RST   4   ;Loop until DE==VAR_BASE, ie whole
0231   C2 2C 02               JNZ   RemoveLine   ;program remainder done.
0234   60                     MOV   H,B   ; 
0235   69                     MOV   L,C   ;Update VAR_BASE from BC.
0236   22 67 01               SHLD   VAR_BASE   ; 
0239   D1           INSERTPROGRAMLINE:   POP   D   ;DE=Line address (from 224)
023A   F1                     POP   PSW   ;Restore line-empty flag (see above)
023B   CA 60 02               JZ   UpdateLinkedList   ;If line is empty, then we don't need to insert it so can jump ahead.
023E   2A 67 01               LHLD   VAR_BASE   ; 
0241   E3                     XTHL      ;HL = Line length (see 21D)
0242   C1                     POP   B   ;BC = VAR_BASE
0243   09                     DAD   B   ;HL = VAR_BASE + line length.
0244   E5                     PUSH   H   ; 
0245   CD A7 01               CALL   CopyMemoryUp   ;Move remainder of program so there's enough space for the new line.
0248   E1                     POP   H   ; 
0249   22 67 01               SHLD   VAR_BASE   ;Update VAR_BASE
024C   EB                     XCHG      ;HL=Line address, DE=VAR_BASE
024D   74                     MOV   M,H   ;???
024E   23                     INX   H   ;Skip over next line ptr (updated below)
024F   23                     INX   H   ; 
0250   D1                     POP   D   ;DE = line number (see 21C)
0251   73                     MOV   M,E   ;Write line number to program line memory.
0252   23                     INX   H   ; 
0253   72                     MOV   M,D   ; 
0254   23                     INX   H   ; 
0255   11 13 01     COPYFROMBUFFER:   LXI   D,LINE_BUFFER   ;Copy the line into the program.
0258   1A                     LDAX   D   ; 
0259   77                     MOV   M,A   ; 
025A   23                     INX   H   ; 
025B   13                     INX   D   ; 
025C   B7                     ORA   A   ; 
025D   C2 58 02               JNZ   CopyFromBuffer+3   ; 
0260   CD A2 02     UPDATELINKEDLIST:   CALL   ResetAll   ; 
0263   23                     INX   H   ; 
0264   EB                     XCHG      ; 
0265   62           L0265:    MOV   H,D   ; 
0266   6B                     MOV   L,E   ; 
0267   7E                     MOV   A,M   ;If the pointer to the next line is a null
0268   23                     INX   H   ;word then we've reached the end of the
0269   B6                     ORA   M   ;program, job is done, and we can jump back
026A   CA FF 01               JZ   GetNonBlankLine   ;to let the user type in the next line.
026D   23                     INX   H   ;Skip over line number.
026E   23                     INX   H   ; 
026F   23                     INX   H   ; 
0270   AF                     XRA   A   ; 
0271   BE           L0271:    CMP   M   ; 
0272   23                     INX   H   ; 
0273   C2 71 02               JNZ   L0271   ; 
0276   EB                     XCHG      ; 
0277   73                     MOV   M,E   ; 
0278   23                     INX   H   ; 
0279   72                     MOV   M,D   ; 
027A   C3 65 02               JMP   L0265   ; 
027D   2A 65 01     FINDPROGRAMLINE:   LHLD   PROGRAM_BASE   ; 
0280   44                     MOV   B,H   ;BC=this line
0281   4D                     MOV   C,L   ; 
0282   7E                     MOV   A,M   ;If we've found two consecutive
0283   23                     INX   H   ;null bytes, then we've reached the end
0284   B6                     ORA   M   ;of the program and so return.
0285   2B                     DCX   H   ; 
0286   C8                     RZ      ; 
0287   C5                     PUSH   B   ;Push this line address
0288   F7                     RST   6   ;Push (next line address)
0289   F7                     RST   6   ;Push (this line number)
028A   E1                     POP   H   ;HL = this line number
028B   E7                     RST   4   ;Compare line numbers
028C   E1                     POP   H   ;HL = next line address
028D   C1                     POP   B   ;BC = this line address
028E   3F                     CMC      ; 
028F   C8                     RZ      ;Return carry set if line numbers match.
0290   3F                     CMC      ; 
0291   D0                     RNC      ;Return if we've reached a line number greater than the one required.
0292   C3 80 02               JMP   FindProgramLine+3   
0295   C0           NEW:      RNZ      
0296   2A 65 01               LHLD   PROGRAM_BASE   
0299   AF                     XRA   A   
029A   77                     MOV   M,A   
029B   23                     INX   H   
029C   77                     MOV   M,A   
029D   23                     INX   H   
029E   22 67 01               SHLD   VAR_BASE   
02A1   C0           RUN:      RNZ      
02A2   2A 65 01     RESETALL:   LHLD   PROGRAM_BASE   
02A5   2B                     DCX   H   
02A6   22 5D 01     CLEAR:    SHLD   PROG_PTR_TEMP   
02A9   CD 69 04               CALL   Restore   
02AC   2A 67 01               LHLD   VAR_BASE   
02AF   22 69 01               SHLD   VAR_ARRAY_BASE   
02B2   22 6B 01               SHLD   VAR_TOP   
02B5   C1           RESETSTACK:   POP   B   
02B6   2A 63 01               LHLD   STACK_TOP   
02B9   F9                     SPHL      
02BA   AF                     XRA   A   
02BB   6F                     MOV   L,A   
02BC   E5                     PUSH   H   
02BD   C5                     PUSH   B   
02BE   2A 5D 01               LHLD   PROG_PTR_TEMP   
02C1   C9                     RET      
02C2   3E 3F        INPUTLINEWITH:   MVI   A,"?"   ;Print "?"
02C4   DF                     RST   03   ;RST OutChar	;
02C5   3E 20                  MVI   A," "   ;Print " "
02C7   DF                     RST   03   ;RST OutChar	;
02C8   CD 3C 03               CALL   InputLine   ; 
02CB   23                     INX   H   ; 
02CC   0E 05        TOKENIZE:   MVI   C,05   ;Initialise line length to 5.
02CE   11 13 01               LXI   D,LINE_BUFFER   ;ie, output ptr is same as input ptr at start.
02D1   7E                     MOV   A,M   ; 
02D2   FE 20                  CPI   " "   ; 
02D4   CA 02 03               JZ   WriteChar   ; 
02D7   47                     MOV   B,A   ; 
02D8   FE 22                  CPI   0x22   ;"""	;
02DA   CA 15 03               JZ   FreeCopy   ; 
02DD   B7                     ORA   A   ; 
02DE   CA 29 03               JZ   Exit   ; 
02E1   D5                     PUSH   D   ;Preserve output ptr.
02E2   06 00                  MVI   B,00   ;Initialise Keyword ID to 0.
02E4   11 56 00               LXI   D,KEYWORDS-1   ; 
02E7   E5                     PUSH   H   ;Preserve input ptr.
02E8   3E                     DB   3Eh   ;LXI over get-next-char
02E9   D7           KWCOMPARE:   RST   02   ; RST 01	; SyntaxCheck0	;Get next input char
02EA   13                     INX   D   ; 
02EB   1A                     LDAX   D   ;Get keyword char to compare with.
02EC   E6 7F                  ANI   7Fh   ;Ignore bit 7 of keyword char.
02EE   CA FF 02               JZ   NotAKeyword   ;If keyword char==0, then end of keywords reached.
02F1   BE                     CMP   M   ;Keyword char matches input char?
02F2   C2 1C 03               JNZ   NextKeyword   ;If not, jump to get next keyword.
02F5   1A                     LDAX   D   ; 
02F6   B7                     ORA   A   ; 
02F7   F2 E9 02               JP   KwCompare   ; 
02FA   F1                     POP   PSW   ;Remove input ptr from stack. We don't need it.
02FB   78                     MOV   A,B   ;A=Keyword ID
02FC   F6 80                  ORI   0x80   ;Set bit 7 (indicates a keyword)
02FE   F2                     DB   0xF2   ;JP ....	;LXI trick again.
02FF   E1           NOTAKEYWORD:   POP   H   ;Restore input ptr
0300   7E                     MOV   A,M   ;and get input char
0301   D1                     POP   D   ;Restore output ptr
0302   23           WRITECHAR:   INX   H   ;Advance input ptr
0303   12                     STAX   D   ;Store output char
0304   13                     INX   D   ;Advance output ptr
0305   0C                     INR   C   ;C++ (arf!).
0306   D6 8E                  SUI   8Eh   ;If it's not the
0308   C2 D1 02               JNZ   Tokenize+5   ; 
030B   47                     MOV   B,A   ;B=0
030C   7E           FREECOPYLOOP:   MOV   A,M   ;A=Input char
030D   B7                     ORA   A   ;If char is null then exit
030E   CA 29 03               JZ   Exit   ; 
0311   B8                     CMP   B   ;If input char is term char then
0312   CA 02 03               JZ   WriteChar   ;we're done free copying.
0315   23           FREECOPY:   INX   H   ; 
0316   12                     STAX   D   ; 
0317   0C                     INR   C   ; 
0318   13                     INX   D   ; 
0319   C3 0C 03               JMP   FreeCopyLoop   ; 
031C   E1           NEXTKEYWORD:   POP   H   ;Restore input ptr
031D   E5                     PUSH   H   ; 
031E   04                     INR   B   ;Keyword ID ++;
031F   EB                     XCHG      ;HL=keyword table ptr
0320   B6           NEXTKWLOOP:   ORA   M   ;Loop until
0321   23                     INX   H   ;bit 7 of previous
0322   F2 20 03               JP   NextKwLoop   ;keyword char is set.
0325   EB                     XCHG      ;DE=keyword ptr, HL=input ptr
0326   C3 EB 02               JMP   KwCompare+2   ; 
0329   21 12 01     EXIT:     LXI   H,LINE_BUFFER-1   ; 
032C   12                     STAX   D   ; 
032D   13                     INX   D   ; 
032E   12                     STAX   D   ; 
032F   13                     INX   D   ; 
0330   12                     STAX   D   ; 
0331   C9                     RET      ; 
0332   05           BACKSPACE:   DCR   B   ;Char count--;
0333   2B                     DCX   H   ;Input ptr--;
0334   DF                     RST   03   ;RST OutChar	;Print backspace char.
0335   C2 41 03               JNZ   InputNext   ; 
0338   DF           RESETINPUT:   RST   03   ;RST OutChar	;
0339   CD 8A 05               CALL   NewLine   ; 
033C   21 13 01     INPUTLINE:   LXI   H,LINE_BUFFER   ; 
033F   06 01                  MVI   B,01   ; 
0341   CD 82 03     INPUTNEXT:   CALL   InputChar   ; 
0344   FE 0D                  CPI   0x0D   ; 
0346   CA 85 05               JZ   TerminateInput   ; 
0349   FE 20                  CPI   " "   ;If < " "
034B   DA 41 03               JC   InputNext   ;or
034E   FE 7D                  CPI   0x7D   ;> "}"
0350   D2 41 03               JNC   InputNext   ;then loop back.
0353   FE 40                  CPI   "@"   ; 
0355   CA 38 03               JZ   ResetInput   ; 
0358   FE 5F                  CPI   "_"   ; 
035A   CA 32 03               JZ   Backspace   ; 
035D   4F                     MOV   C,A   ; 
035E   78                     MOV   A,B   ; 
035F   FE 48                  CPI   0x48   ; 
0361   3E 07                  MVI   A,07   ; 
0363   D2 6A 03               JNC   L036A   ; 
0366   79                     MOV   A,C   ;Write char to LINE_BUFFER.
0367   71                     MOV   M,C   ; 
0368   23                     INX   H   ; 
0369   04                     INR   B   ; 
036A   DF           L036A:    RST   03   ;RST OutChar	;
036B   C3 41 03               JMP   InputNext   ; 
036E   FE 48        OUTCHAR_TAIL:   CPI   0x48   ; 
0370   CC 8A 05               CZ   NewLine   ; 
0373   3C                     INR   A   ; 
0374   32 27 00               STA   TERMINAL_X   ; 
0377   DB 00        WAITTERMREADY:   IN   00   ; 
0379   E6 80                  ANI   80h   ; 
037B   C2 77 03               JNZ   WaitTermReady   ; 
037E   F1                     POP   PSW   ; 
037F   D3 01                  OUT   01   ; 
0381   C9                     RET      ; 
0382   DB 00        INPUTCHAR:   IN   00   ; 
0384   E6 01                  ANI   01   ; 
0386   C2 82 03               JNZ   InputChar   ; 
0389   DB 01                  IN   01   ; 
038B   E6 7F                  ANI   7Fh   ; 
038D   C9                     RET      ; 
038E   CD 9D 04     LIST:     CALL   LineNumberFromStr   
0391   C0                     RNZ      
0392   C1                     POP   B   ;?why get return address?
0393   CD 7D 02               CALL   FindProgramLine   
0396   C5                     PUSH   B   
0397   E1           LISTNEXTLINE:   POP   H   
0398   F7                     RST   6   
0399   C1                     POP   B   
039A   78                     MOV   A,B   
039B   B1                     ORA   C   
039C   CA F9 01               JZ   Main   
039F   CD 73 04               CALL   TestBreakKey   
03A2   C5                     PUSH   B   
03A3   CD 8A 05               CALL   NewLine   
03A6   F7                     RST   6   
03A7   E3                     XTHL      
03A8   CD 37 0B               CALL   PrintInt   
03AB   3E 20                  MVI   A," "   
03AD   E1                     POP   H   
03AE   DF           LISTCHAR:   RST   03   ;RST OutChar	
03AF   7E                     MOV   A,M   
03B0   B7                     ORA   A   
03B1   23                     INX   H   
03B2   CA 97 03               JZ   ListNextLine   
03B5   F2 AE 03               JP   ListChar   
03B8   D6 7F                  SUI   7Fh   ;A is now keyword index + 1.
03BA   4F                     MOV   C,A   
03BB   E5                     PUSH   H   
03BC   11 57 00               LXI   D,KEYWORDS   
03BF   D5                     PUSH   D   
03C0   1A           TONEXTKEYWORD:   LDAX   D   
03C1   13                     INX   D   
03C2   B7                     ORA   A   
03C3   F2 C0 03               JP   ToNextKeyword   
03C6   0D                     DCR   C   
03C7   E1                     POP   H   
03C8   C2 BF 03               JNZ   ToNextKeyword-1   
03CB   7E           PRINTKEYWORD:   MOV   A,M   
03CC   B7                     ORA   A   
03CD   FA AD 03               JM   ListChar-1   
03D0   DF                     RST   03   ;RST OutChar	
03D1   23                     INX   H   
03D2   C3 CB 03               JMP   PrintKeyword   
03D5   CD 02 05     FOR:      CALL   Let   
03D8   E3                     XTHL      
03D9   CD 92 01               CALL   GetFlowPtr   
03DC   D1                     POP   D   
03DD   C2 E2 03               JNZ   L03E2   
03E0   09                     DAD   B   
03E1   F9                     SPHL      
03E2   EB           L03E2:    XCHG      
03E3   0E 08                  MVI   C,08   
03E5   CD B6 01               CALL   CheckEnoughVarSpace   
03E8   E5                     PUSH   H   
03E9   CD F5 04               CALL   FindNextStatement   
03EC   E3                     XTHL      
03ED   E5                     PUSH   H   
03EE   2A 61 01               LHLD   CURRENT_LINE   
03F1   E3                     XTHL      
03F2   CF                     RST   01   ; SyntaxCheck; SyntaxCheck	
03F3   95                     DB   95h   ;KWID_TO	
03F4   CD 8A 06               CALL   EvalExpression   
03F7   E5                     PUSH   H   
03F8   CD 1D 0A               CALL   FCopyToBCDE   
03FB   E1                     POP   H   
03FC   C5                     PUSH   B   
03FD   D5                     PUSH   D   
03FE   01 00 81               LXI   B,8100h   
0401   51                     MOV   D,C   
0402   5A                     MOV   E,D   
0403   7E                     MOV   A,M   
0404   FE 97                  CPI   0x97   ;KWID_STEP	
0406   3E 01                  MVI   A,01h   
0408   C2 14 04               JNZ   PushStepValue   
040B   CD 8B 06               CALL   EvalExpression+1   
040E   E5                     PUSH   H   
040F   CD 1D 0A               CALL   FCopyToBCDE   
0412   EF                     RST   05   ; FTestSign	
0413   E1                     POP   H   
0414   C5           PUSHSTEPVALUE:   PUSH   B   
0415   D5                     PUSH   D   
0416   F5                     PUSH   PSW   
0417   33                     INX   SP   
0418   E5                     PUSH   H   
0419   2A 5D 01               LHLD   PROG_PTR_TEMP   
041C   E3                     XTHL      
041D   06 81        ENDOFFORHANDLER:   MVI   B,0x81   
041F   C5                     PUSH   B   
0420   33                     INX   SP   
0421   CD 73 04     EXECNEXT:   CALL   TestBreakKey   
0424   7E                     MOV   A,M   
0425   FE 3A                  CPI   ":"   
0427   CA 3E 04               JZ   Exec   
042A   B7                     ORA   A   
042B   C2 D0 01               JNZ   SyntaxError   
042E   23                     INX   H   
042F   7E                     MOV   A,M   
0430   23                     INX   H   
0431   B6                     ORA   M   
0432   23                     INX   H   
0433   CA F9 01               JZ   Main   
0436   5E                     MOV   E,M   
0437   23                     INX   H   
0438   56                     MOV   D,M   
0439   EB                     XCHG      
043A   22 61 01               SHLD   CURRENT_LINE   
043D   EB                     XCHG      
043E   D7           EXEC:     RST   02   ;RST NextChar	
043F   11 21 04               LXI   D,ExecNext   
0442   D5                     PUSH   D   
0443   C8                     RZ      
0444   D6 80                  SUI   80h   
0446   DA 02 05               JC   Let   
0449   FE 14                  CPI   0x14   
044B   D2 D0 01               JNC   SyntaxError   
044E   07                     RLC      ;BC = A*2
044F   4F                     MOV   C,A   
0450   06 00                  MVI   B,00h   
0452   EB                     XCHG      
0453   21 D2 00               LXI   H,KW_GENERAL_FNS   
0456   09                     DAD   B   
0457   4E                     MOV   C,M   
0458   23                     INX   H   
0459   46                     MOV   B,M   
045A   C5                     PUSH   B   
045B   EB                     XCHG      
045C   D7                     RST   02   ;RST NextChar	
045D   C9                     RET      
045E   FE 20        NEXTCHAR_TAIL:   CPI   " "   
0460   CA 10 00               JZ   NextChar   
0463   FE 30                  CPI   "0"   
0465   3F                     CMC      
0466   3C                     INR   A   
0467   3D                     DCR   A   
0468   C9                     RET      
0469   EB           RESTORE:   XCHG      
046A   2A 65 01               LHLD   PROGRAM_BASE   
046D   2B                     DCX   H   
046E   22 6D 01     L046E:    SHLD   DATA_PROG_PTR   
0471   EB                     XCHG      
0472   C9                     RET      
0473   DB 00        TESTBREAKKEY:   IN   00   ;Exit if no key pressed.
0475   E6 01                  ANI   01   ; 
0477   C0                     RNZ      ; 
0478   CD 82 03               CALL   InputChar   ; 
047B   FE 03                  CPI   0x03   ;Break key?
047D   C3 F7 01               JMP   Stop   
0480   7E           CHARISALPHA:   MOV   A,M   
0481   FE 41                  CPI   "A"   
0483   D8                     RC      
0484   FE 5B                  CPI   "Z"+1   
0486   3F                     CMC      
0487   C9                     RET      
0488   D7           GETSUBSCRIPT:   RST   02   ;RST NextChar	
0489   CD 8A 06               CALL   EvalExpression   
048C   EF                     RST   05   ; FTestSign	
048D   FA 98 04               JM   FunctionCallError   
0490   3A 72 01               LDA   FACCUM+3   
0493   FE 90                  CPI   0x90   
0495   DA 77 0A               JC   FAsInteger   
0498   1E 08        FUNCTIONCALLERROR:   MVI   E,08h   
049A   C3 D5 01               JMP   Error   
049D   2B           LINENUMBERFROMSTR:   DCX   H   
049E   11 00 00               LXI   D,0000   
04A1   D7           NEXTLINENUMCHAR:   RST   02   ;RST NextChar	
04A2   D0                     RNC      
04A3   E5                     PUSH   H   
04A4   F5                     PUSH   PSW   ;Preserve flags
04A5   21 98 19               LXI   H,1998h   ;Decimal 6552
04A8   E7                     RST   4   
04A9   DA D0 01               JC   SyntaxError   
04AC   62                     MOV   H,D   
04AD   6B                     MOV   L,E   
04AE   19                     DAD   D   
04AF   29                     DAD   H   
04B0   19                     DAD   D   
04B1   29                     DAD   H   
04B2   F1                     POP   PSW   
04B3   D6 30                  SUI   "0"   
04B5   5F                     MOV   E,A   
04B6   16 00                  MVI   D,00h   
04B8   19                     DAD   D   
04B9   EB                     XCHG      
04BA   E1                     POP   H   
04BB   C3 A1 04               JMP   NextLineNumChar   
04BE   0E 03        GOSUB:    MVI   C,03h   
04C0   CD B6 01               CALL   CheckEnoughVarSpace   
04C3   C1                     POP   B   
04C4   E5                     PUSH   H   
04C5   E5                     PUSH   H   
04C6   2A 61 01               LHLD   CURRENT_LINE   
04C9   E3                     XTHL      
04CA   16 8C                  MVI   D,0x8C   
04CC   D5                     PUSH   D   
04CD   33                     INX   SP   
04CE   C5                     PUSH   B   
04CF   CD 9D 04     GOTO:     CALL   LineNumberFromStr   
04D2   C0                     RNZ      
04D3   CD 7D 02               CALL   FindProgramLine   
04D6   60                     MOV   H,B   
04D7   69                     MOV   L,C   
04D8   2B                     DCX   H   
04D9   D8                     RC      
04DA   1E 0E                  MVI   E,0Eh   
04DC   C3 D5 01               JMP   Error   
04DF   C0           RETURN:   RNZ      
04E0   16 FF                  MVI   D,0xFF   
04E2   CD 92 01               CALL   GetFlowPtr   
04E5   F9                     SPHL      
04E6   FE 8C                  CPI   0x8C   
04E8   1E 04                  MVI   E,04h   
04EA   C2 D5 01               JNZ   Error   
04ED   E1                     POP   H   
04EE   22 61 01               SHLD   CURRENT_LINE   
04F1   21 21 04               LXI   H,ExecNext   
04F4   E3                     XTHL      
04F5   01 3A        FINDNEXTSTATEMENT:   DB   01h,3Ah   ;LXI B,..3A	
04F7   10           REM:      DB   10h   
04F8   00                     NOP      
04F9   7E           FINDNEXTSTATEMENTLOOP:   MOV   A,M   
04FA   B7                     ORA   A   
04FB   C8                     RZ      
04FC   B9                     CMP   C   
04FD   C8                     RZ      
04FE   23                     INX   H   
04FF   C3 F9 04               JMP   FindNextStatementLoop   
0502   CD 1B 07     LET:      CALL   GetVar   
0505   CF                     RST   01   ; SyntaxCheck	
0506   9D                     DB   9Dh   
0507   D5           ASSIGNVAR:   PUSH   D   
0508   CD 8A 06               CALL   EvalExpression   
050B   E3                     XTHL      
050C   22 5D 01               SHLD   PROG_PTR_TEMP   
050F   E5                     PUSH   H   
0510   CD 29 0A               CALL   FCopyToMem   
0513   D1                     POP   D   
0514   E1                     POP   H   
0515   C9                     RET      
0516   CD 8A 06     IFL:      CALL   EvalExpression   
0519   7E                     MOV   A,M   
051A   CD 02 0A               CALL   FPush   
051D   16 00                  MVI   D,00   
051F   D6 9C        GETCOMPAREOPLOOP:   SUI   9Ch   ; KWID_>	
0521   DA 32 05               JC   GotCompareOp   
0524   FE 03                  CPI   0x03   
0526   D2 32 05               JNC   GotCompareOp   
0529   FE 01                  CPI   0x01   
052B   17                     RAL      
052C   B2                     ORA   D   
052D   57                     MOV   D,A   
052E   D7                     RST   02   ;RST NextChar	
052F   C3 1F 05               JMP   GetCompareOpLoop   
0532   7A           GOTCOMPAREOP:   MOV   A,D   
0533   B7                     ORA   A   
0534   CA D0 01               JZ   SyntaxError   
0537   F5                     PUSH   PSW   
0538   CD 8A 06               CALL   EvalExpression   
053B   CF                     RST   01   ; SyntaxCheck	
053C   96                     DB   96h   ;KWID_THEN	
053D   2B                     DCX   H   
053E   F1                     POP   PSW   
053F   C1                     POP   B   
0540   D1                     POP   D   
0541   E5                     PUSH   H   
0542   F5                     PUSH   PSW   
0543   CD 4C 0A               CALL   FCompare   
0546   3C                     INR   A   
0547   17                     RAL      
0548   C1                     POP   B   
0549   A0                     ANA   B   
054A   E1                     POP   H   
054B   CA F7 04               JZ   Rem   
054E   D7                     RST   02   ;RST NextChar	
054F   DA CF 04               JC   Goto   
0552   C3 43 04               JMP   Exec+5   
0555   2B                     DCX   H   
0556   D7                     RST   02   ;RST NextChar	
0557   CA 8A 05     PRINT:    JZ   NewLine   
055A   C8                     RZ      
055B   FE 22                  CPI   0x22   ;"""	
055D   CC A2 05               CZ   PrintString-1   
0560   CA 55 05               JZ   Print-2   
0563   FE 94                  CPI   0x94   ;KWID_TAB	
0565   CA C7 05               JZ   Tab   
0568   E5                     PUSH   H   
0569   FE 2C                  CPI   ","   
056B   CA B3 05               JZ   ToNextTabBreak   
056E   FE 3B                  CPI   0x3B   ; ";"	
0570   CA DF 05               JZ   ExitTab   
0573   C1                     POP   B   
0574   CD 8A 06               CALL   EvalExpression   
0577   E5                     PUSH   H   
0578   CD 42 0B               CALL   FOut   
057B   CD A3 05               CALL   PrintString   
057E   3E 20                  MVI   A," "   
0580   DF                     RST   03   ;RST OutChar	
0581   E1                     POP   H   
0582   C3 55 05               JMP   Print-2   
0585   36 00        TERMINATEINPUT:   MVI   M,00h   
0587   21 12 01               LXI   H,LINE_BUFFER-1   
058A   3E 0D        NEWLINE:   MVI   A,0Dh   
058C   32 27 00               STA   TERMINAL_X   
058F   DF                     RST   03   ;RST OutChar	
0590   3E 0A                  MVI   A,0Ah   
0592   DF                     RST   03   ;RST OutChar	
0593   3A 26 00               LDA   TERMINAL_Y   
0596   3D           PRINTNULLLOOP:   DCR   A   
0597   32 27 00               STA   TERMINAL_X   
059A   C8                     RZ      
059B   F5                     PUSH   PSW   
059C   AF                     XRA   A   
059D   DF                     RST   03   ;RST OutChar	
059E   F1                     POP   PSW   
059F   C3 96 05               JMP   PrintNullLoop   
05A2   23                     INX   H   
05A3   7E           PRINTSTRING:   MOV   A,M   
05A4   B7                     ORA   A   
05A5   C8                     RZ      
05A6   23                     INX   H   
05A7   FE 22                  CPI   0x22   ;"""	
05A9   C8                     RZ      
05AA   DF                     RST   03   ;RST OutChar	
05AB   FE 0D                  CPI   0x0D   
05AD   CC 8A 05               CZ   NewLine   
05B0   C3 A3 05               JMP   PrintString   
05B3   3A 27 00     TONEXTTABBREAK:   LDA   TERMINAL_X   
05B6   FE 38                  CPI   0x38   
05B8   D4 8A 05               CNC   NewLine   
05BB   D2 DF 05               JNC   ExitTab   
05BE   D6 0E        CALCSPACECOUNT:   SUI   0Eh   
05C0   D2 BE 05               JNC   CalcSpaceCount   
05C3   2F                     CMA      
05C4   C3 D6 05               JMP   PrintSpaces   
05C7   CD 88 04     TAB:      CALL   GetSubscript   
05CA   CF                     RST   01   ; SyntaxCheck	
05CB   29                     DB   29h   ;")"	
05CC   2B                     DCX   H   
05CD   E5                     PUSH   H   
05CE   3A 27 00               LDA   TERMINAL_X   
05D1   2F                     CMA      
05D2   83                     ADD   E   
05D3   D2 DF 05               JNC   ExitTab   
05D6   3C           PRINTSPACES:   INR   A   
05D7   47                     MOV   B,A   
05D8   3E 20                  MVI   A," "   
05DA   DF           PRINTSPACELOOP:   RST   03   ;RST OutChar	
05DB   05                     DCR   B   
05DC   C2 DA 05               JNZ   PrintSpaceLoop   
05DF   E1           EXITTAB:   POP   H   
05E0   D7                     RST   02   ;RST NextChar	
05E1   C3 5A 05               JMP   Print+3   
05E4   E5           INPUT:    PUSH   H   
05E5   2A 61 01               LHLD   CURRENT_LINE   
05E8   1E 16                  MVI   E,16h   
05EA   23                     INX   H   
05EB   7D                     MOV   A,L   
05EC   B4                     ORA   H   
05ED   CA D5 01               JZ   Error   
05F0   CD C2 02               CALL   InputLineWith   
05F3   C3 FB 05               JMP   L05FA+1   
05F6   E5           READ:     PUSH   H   
05F7   2A 6D 01               LHLD   DATA_PROG_PTR   
05FA   F6 AF        L05FA:    ORI   0xAF   
05FC                             ;XRA A	
05FC   32 5C 01               STA   INPUT_OR_READ   
05FF   E3                     XTHL      
0600   01                     DB   01   ;LXI B,....	
0601   CF           READNEXT:   RST   01   ; SyntaxCheck	
0602   2C                     DB   2Ch   ;","	
0603   CD 1B 07               CALL   GetVar   
0606   E3                     XTHL      
0607   D5                     PUSH   D   
0608   7E                     MOV   A,M   
0609   FE 2C                  CPI   ","   
060B   CA 20 06               JZ   GotDataItem   
060E   B7                     ORA   A   
060F   C2 D0 01               JNZ   SyntaxError   
0612   3A 5C 01               LDA   INPUT_OR_READ   
0615   B7                     ORA   A   
0616   23                     INX   H   
0617   C2 36 06               JNZ   NextDataLine+1   
061A   3E 3F                  MVI   A,"?"   
061C   DF                     RST   03   ;RST OutChar	
061D   CD C2 02               CALL   InputLineWith   
0620   D1           GOTDATAITEM:   POP   D   
0621   23                     INX   H   
0622   CD 07 05               CALL   AssignVar   
0625   E3                     XTHL      
0626   2B                     DCX   H   
0627   D7                     RST   02   ;RST NextChar	
0628   C2 01 06               JNZ   ReadNext   
062B   D1                     POP   D   
062C   3A 5C 01               LDA   INPUT_OR_READ   
062F   B7                     ORA   A   
0630   C8                     RZ      
0631   EB                     XCHG      
0632   C2 6E 04               JNZ   L046E   
0635   E1           NEXTDATALINE:   POP   H   
0636   F7                     RST   6   
0637   79                     MOV   A,C   
0638   B0                     ORA   B   
0639   1E 06                  MVI   E,06h   
063B   CA D5 01               JZ   Error   
063E   23                     INX   H   
063F   D7                     RST   02   ;RST NextChar	
0640   FE 83                  CPI   0x83   ;KWID_DATA	
0642   C2 35 06               JNZ   NextDataLine   
0645   C1                     POP   B   
0646   C3 20 06               JMP   GotDataItem   
0649   CD 1B 07     NEXT:     CALL   GetVar   
064C   22 5D 01               SHLD   PROG_PTR_TEMP   
064F   CD 92 01               CALL   GetFlowPtr   
0652   F9                     SPHL      
0653   D5                     PUSH   D   
0654   7E                     MOV   A,M   
0655   23                     INX   H   
0656   F5                     PUSH   PSW   
0657   D5                     PUSH   D   
0658   1E 00                  MVI   E,00h   
065A   C2 D5 01               JNZ   Error   
065D   CD 0F 0A               CALL   FLoadFromMem   
0660   E3                     XTHL      
0661   E5                     PUSH   H   
0662   CD 04 08               CALL   FAddMem   
0665   E1                     POP   H   
0666   CD 29 0A               CALL   FCopyToMem   
0669   E1                     POP   H   
066A   CD 20 0A               CALL   FLoadBCDEfromMem   
066D   E5                     PUSH   H   
066E   CD 4C 0A               CALL   FCompare   
0671   E1                     POP   H   
0672   C1                     POP   B   
0673   90                     SUB   B   
0674   CD 20 0A               CALL   FLoadBCDEfromMem   
0677   CA 83 06               JZ   ForLoopIsComplete   
067A   EB                     XCHG      
067B   22 61 01               SHLD   CURRENT_LINE   
067E   69                     MOV   L,C   
067F   60                     MOV   H,B   
0680   C3 1D 04               JMP   EndOfForHandler   
0683   F9           FORLOOPISCOMPLETE:   SPHL      
0684   2A 5D 01               LHLD   PROG_PTR_TEMP   
0687   C3 21 04               JMP   ExecNext   
068A   2B           EVALEXPRESSION:   DCX   H   
068B   16 00                  MVI   D,00h   
068D   D5                     PUSH   D   
068E   0E 01                  MVI   C,01h   
0690   CD B6 01               CALL   CheckEnoughVarSpace   
0693   CD C4 06               CALL   EvalTerm   
0696   22 5F 01               SHLD   L015F   
0699   2A 5F 01     ARITHPARSE:   LHLD   L015F   
069C   C1                     POP   B   
069D   7E                     MOV   A,M   
069E   16 00                  MVI   D,00h   
06A0   D6 98                  SUI   0x98   ;KWID_PLUS	
06A2   D8                     RC      
06A3   FE 04                  CPI   0x04   
06A5   D0                     RNC      
06A6   5F                     MOV   E,A   
06A7   07                     RLC      
06A8   83                     ADD   E   
06A9   5F                     MOV   E,A   
06AA   21 4B 00               LXI   H,KW_ARITH_OP_FNS   
06AD   19                     DAD   D   
06AE   78                     MOV   A,B   
06AF   56                     MOV   D,M   
06B0   BA                     CMP   D   
06B1   D0                     RNC      
06B2   23                     INX   H   
06B3   C5                     PUSH   B   
06B4   01 99 06               LXI   B,ArithParse   
06B7   C5                     PUSH   B   
06B8   4A                     MOV   C,D   ;???
06B9   CD 02 0A               CALL   FPush   
06BC   51                     MOV   D,C   
06BD   F7                     RST   6   
06BE   2A 5F 01               LHLD   L015F   
06C1   C3 8D 06               JMP   EvalExpression+3   
06C4   D7           EVALTERM:   RST   02   ;RST NextChar	
06C5   DA B3 0A               JC   FIn   
06C8   CD 80 04               CALL   CharIsAlpha   
06CB   D2 F3 06               JNC   EvalVarTerm   
06CE   FE 98                  CPI   0x98   ;KWID_PLUS	
06D0   CA C4 06               JZ   EvalTerm   
06D3   FE 2E                  CPI   "."   
06D5   CA B3 0A               JZ   FIn   
06D8   FE 99                  CPI   0x99   ;KWID_MINUS	
06DA   CA EA 06               JZ   EvalMinusTerm   
06DD   D6 9F                  SUI   9Fh   
06DF   D2 FD 06               JNC   EvalInlineFn   
06E2   CF           EVALBRACKETED:   RST   01   ; SyntaxCheck	
06E3   28                     DB   28h   ;"("	
06E4   CD 8A 06               CALL   EvalExpression   
06E7   CF                     RST   01   ; SyntaxCheck	
06E8   29                     DB   29h   ;")"	
06E9   C9                     RET      
06EA   CD C4 06     EVALMINUSTERM:   CALL   EvalTerm   
06ED   E5                     PUSH   H   
06EE   CD FA 09               CALL   FNegate   
06F1   E1                     POP   H   
06F2   C9                     RET      
06F3   CD 1B 07     EVALVARTERM:   CALL   GetVar   
06F6   E5                     PUSH   H   
06F7   EB                     XCHG      
06F8   CD 0F 0A               CALL   FLoadFromMem   
06FB   E1                     POP   H   
06FC   C9                     RET      
06FD   06 00        EVALINLINEFN:   MVI   B,00h   
06FF   07                     RLC      
0700   4F                     MOV   C,A   
0701   C5                     PUSH   B   
0702   D7                     RST   02   ;RST NextChar	
0703   CD E2 06               CALL   EvalBracketed   
0706   E3                     XTHL      
0707   11 F1 06               LXI   D,06F1h   
070A   D5                     PUSH   D   
070B   01 3D 00               LXI   B,KW_INLINE_FNS   
070E   09                     DAD   B   
070F   F7                     RST   6   
0710   C9                     RET      
0711   2B           DIMCONTD:   DCX   H   
0712   D7                     RST   02   ;RST NextChar	
0713   C8                     RZ      
0714   CF                     RST   01   ; SyntaxCheck	
0715   2C                     DB   2Ch   ;","	
0716   01 11 07     DIM:      LXI   B,DimContd   
0719   C5                     PUSH   B   
071A   F6                     DB   0xF6   
071B   AF           GETVAR:   XRA   A   
071C   32 5B 01               STA   DIM_OR_EVAL   
071F   46                     MOV   B,M   
0720   CD 80 04               CALL   CharIsAlpha   
0723   DA D0 01               JC   SyntaxError   
0726   AF                     XRA   A   
0727   4F                     MOV   C,A   
0728   D7                     RST   02   ;RST NextChar	
0729   D2 2E 07               JNC   072Eh   
072C   4F                     MOV   C,A   
072D   D7                     RST   02   ;RST NextChar	
072E   D6 28                  SUI   "("   
0730   CA 8A 07               JZ   GetArrayVar   
0733   E5                     PUSH   H   
0734   2A 69 01               LHLD   VAR_ARRAY_BASE   
0737   EB                     XCHG      
0738   2A 67 01               LHLD   VAR_BASE   
073B   E7           FINDVARLOOP:   RST   4   
073C   CA 52 07               JZ   AllocNewVar   
073F   79                     MOV   A,C   
0740   96                     SUB   M   
0741   23                     INX   H   
0742   C2 47 07               JNZ   L0747   
0745   78                     MOV   A,B   
0746   96                     SUB   M   
0747   23           L0747:    INX   H   
0748   CA 82 07               JZ   L0782   
074B   23                     INX   H   
074C   23                     INX   H   
074D   23                     INX   H   
074E   23                     INX   H   
074F   C3 3B 07               JMP   FindVarLoop   
0752   E1           ALLOCNEWVAR:   POP   H   ;HL=prog ptr
0753   E3                     XTHL      ;(SP)=prog ptr, HL=ret.addr.
0754   D5                     PUSH   D   ; 
0755   11 F6 06               LXI   D,06F6h   ;an address inside EvalTerm
0758   E7                     RST   4   ; 
0759   D1                     POP   D   ; 
075A   CA 85 07               JZ   AlreadyAllocd   ; 
075D   E3                     XTHL      ;(SP)=ret.addr, HL=prog ptr.
075E   E5                     PUSH   H   ;Prog ptr back on stack
075F   C5                     PUSH   B   ;Preserve var name on stack
0760   01 06 00               LXI   B,0006h   
0763   2A 6B 01               LHLD   VAR_TOP   
0766   E5                     PUSH   H   
0767   09                     DAD   B   
0768   C1                     POP   B   
0769   E5                     PUSH   H   
076A   CD A7 01               CALL   CopyMemoryUp   
076D   E1                     POP   H   
076E   22 6B 01               SHLD   VAR_TOP   
0771   60                     MOV   H,B   
0772   69                     MOV   L,C   
0773   22 69 01               SHLD   VAR_ARRAY_BASE   
0776   2B           INITVARLOOP:   DCX   H   
0777   36 00                  MVI   M,00h   
0779   E7                     RST   4   
077A   C2 76 07               JNZ   InitVarLoop   
077D   D1                     POP   D   
077E   73                     MOV   M,E   
077F   23                     INX   H   
0780   72                     MOV   M,D   
0781   23                     INX   H   
0782   EB           L0782:    XCHG      
0783   E1                     POP   H   
0784   C9                     RET      
0785   32 72 01     ALREADYALLOCD:   STA   FACCUM+3   ;A was set to zero at 075A.
0788   E1                     POP   H   
0789   C9                     RET      
078A   C5           GETARRAYVAR:   PUSH   B   
078B   3A 5B 01               LDA   DIM_OR_EVAL   
078E   F5                     PUSH   PSW   
078F   CD 88 04               CALL   GetSubscript   
0792   CF                     RST   01   ; SyntaxCheck	
0793   29                     DB   29h   ;")"	
0794   F1                     POP   PSW   
0795   32 5B 01               STA   DIM_OR_EVAL   
0798   E3                     XTHL      
0799   EB                     XCHG      
079A   29                     DAD   H   
079B   29                     DAD   H   
079C   E5                     PUSH   H   
079D   2A 69 01               LHLD   VAR_ARRAY_BASE   
07A0   01                     DB   0x01   ;LXI B,....	
07A1   C1           FINDARRAY:   POP   B   
07A2   09                     DAD   B   
07A3   EB                     XCHG      
07A4   E5                     PUSH   H   
07A5   2A 6B 01               LHLD   VAR_TOP   
07A8   E7                     RST   4   
07A9   EB                     XCHG      
07AA   D1                     POP   D   
07AB   CA CD 07               JZ   AllocArray   
07AE   F7                     RST   6   
07AF   E3                     XTHL      
07B0   E7                     RST   4   
07B1   E1                     POP   H   
07B2   F7                     RST   6   
07B3   C2 A1 07               JNZ   FindArray   
07B6   3A 5B 01               LDA   DIM_OR_EVAL   
07B9   B7                     ORA   A   
07BA   1E 12                  MVI   E,12h   
07BC   C2 D5 01               JNZ   Error   
07BF   D1           L07BF:    POP   D   
07C0   1B                     DCX   D   
07C1   E3                     XTHL      
07C2   E7                     RST   4   
07C3   1E 10                  MVI   E,10h   
07C5   D2 D5 01               JNC   Error   
07C8   D1                     POP   D   
07C9   19                     DAD   D   
07CA   D1                     POP   D   
07CB   EB                     XCHG      
07CC   C9                     RET      
07CD   73           ALLOCARRAY:   MOV   M,E   
07CE   23                     INX   H   
07CF   72                     MOV   M,D   
07D0   23                     INX   H   
07D1   11 2C 00               LXI   D,002Ch   
07D4   3A 5B 01               LDA   DIM_OR_EVAL   
07D7   B7                     ORA   A   
07D8   CA E1 07               JZ   L07E1   
07DB   D1                     POP   D   
07DC   D5                     PUSH   D   
07DD   13                     INX   D   
07DE   13                     INX   D   
07DF   13                     INX   D   
07E0   13                     INX   D   
07E1   D5           L07E1:    PUSH   D   
07E2   73                     MOV   M,E   
07E3   23                     INX   H   
07E4   72                     MOV   M,D   
07E5   23                     INX   H   
07E6   E5                     PUSH   H   
07E7   19                     DAD   D   
07E8   CD C3 01               CALL   CheckEnoughMem   
07EB   22 6B 01               SHLD   VAR_TOP   
07EE   D1                     POP   D   
07EF   2B           INITELEMENTS:   DCX   H   
07F0   36 00                  MVI   M,00h   
07F2   E7                     RST   4   
07F3   C2 EF 07               JNZ   InitElements   
07F6   C3 BF 07               JMP   L07BF   
07F9   50           FWORDTOFLOAT:   MOV   D,B   
07FA   1E 00                  MVI   E,00h   
07FC   06 90                  MVI   B,90h   ;exponent=2^16
07FE   C3 EA 09               JMP   FCharToFloat+5   ; 
0801   21 0B 0C     FADDONEHALF:   LXI   H,ONE_HALF   ;Load BCDE with (float) 0.5.
0804   CD 20 0A     FADDMEM:   CALL   FLoadBCDEfromMem   
0807   C3 12 08               JMP   FAdd+2   
080A   C1           FSUB:     POP   B   ;Get lhs in BCDE.
080B   D1                     POP   D   ; 
080C   CD FA 09               CALL   FNegate   ;Negate rhs and slimily
080F   21                     DB   0x21   ;LXI H,....	;LXI into FAdd + 2.
0810   C1           FADD:     POP   B   ;Get lhs in BCDE.
0811   D1                     POP   D   ; 
0812   78                     MOV   A,B   ;If lhs==0 then we don't need
0813   B7                     ORA   A   ;to do anything and can just
0814   C8                     RZ      ;exit.
0815   3A 72 01               LDA   FACCUM+3   ;If rhs==0 then exit via a copy
0818   B7                     ORA   A   ;of lhs to FACCUM.
0819   CA 12 0A               JZ   FLoadFromBCDE   ; 
081C   90                     SUB   B   ;A=rhs.exponent-lhs.exponent.
081D   D2 2C 08               JNC   L082C   ;If rhs" exponent >= lhs"exponent, jump ahead.
0820   2F                     CMA      ;Two's complement the exponent
0821   3C                     INR   A   ;difference, so it's correct.
0822   EB                     XCHG      ; 
0823   CD 02 0A               CALL   FPush   ;Push old rhs
0826   EB                     XCHG      ; 
0827   CD 12 0A               CALL   FLoadFromBCDE   ;rhs = old lhs
082A   C1                     POP   B   ;lhs = old rhs.
082B   D1                     POP   D   ; 
082C   F5           L082C:    PUSH   PSW   ;Preserve exponent diff
082D   CD 37 0A               CALL   FUnpackMantissas   
0830   67                     MOV   H,A   ;H=sign relationship
0831   F1                     POP   PSW   ;A=exponent diff.
0832   CD C9 08               CALL   FMantissaRtMult   ;Shift lhs mantissa right by (exponent diff) places.
0835   B4                     ORA   H   ;A=0 after last call, so this tests
0836   21 6F 01               LXI   H,FACCUM   ;the sign relationship.
0839   F2 4D 08               JP   FSubMantissas   ;Jump ahead if we need to subtract.
083C   CD A9 08               CALL   FAddMantissas   ; 
083F   D2 7E 08               JNC   FRoundUp   ;Jump ahead if that didn't overflow.
0842   23                     INX   H   ;Flip the sign in FTEMP_SIGN.
0843   34                     INR   M   ; 
0844   CA A4 08               JZ   Overflow   ;Error out if exponent overflowed.
0847   CD D6 08               CALL   FMantissaRtOnce   ;Shift mantissa one place right
084A   C3 7E 08               JMP   FRoundUp   ;Jump ahead.
084D   AF           FSUBMANTISSAS:   XRA   A   ;B=0-B
084E   90                     SUB   B   ; 
084F   47                     MOV   B,A   ; 
0850   7E                     MOV   A,M   ;E=(FACCUM)-E
0851   9B                     SBB   E   ; 
0852   5F                     MOV   E,A   ; 
0853   23                     INX   H   ; 
0854   7E                     MOV   A,M   ;D=(FACCUM+1)-D
0855   9A                     SBB   D   
0856   57                     MOV   D,A   
0857   23                     INX   H   
0858   7E                     MOV   A,M   ;C=(FACCUM+2)-C
0859   99                     SBB   C   ; 
085A   4F                     MOV   C,A   ; 
085B   DC B5 08     FNORMALISE:   CC   FNegateInt   ; 
085E   26 00                  MVI   H,00h   ; 
0860   79                     MOV   A,C   ;Test most-significant bit of mantissa
0861   B7                     ORA   A   ;and jump ahead if it's 1.
0862   FA 7E 08               JM   FRoundUp   ; 
0865   FE E0        NORMLOOP:   CPI   0xE0   ;If we've shifted 32 times,
0867   CA BE 09               JZ   FZero   ;then the number is 0.
086A   25                     DCR   H   ; 
086B   78                     MOV   A,B   ;Left-shift extra mantissa byte
086C   87                     ADD   A   ; 
086D   47                     MOV   B,A   ; 
086E   CD 90 08               CALL   FMantissaLeft   ;Left-shift mantissa.
0871   7C                     MOV   A,H   ; 
0872   F2 65 08               JP   NormLoop   ;Loop
0875   21 72 01               LXI   H,FACCUM+3   ; 
0878   86                     ADD   M   ; 
0879   77                     MOV   M,A   ;Since A was a -ve number, that certainly should
087A   D2 BE 09               JNC   FZero   ;have carried, hence the extra check for zero.
087D   C8                     RZ      ;?why?
087E   78           FROUNDUP:   MOV   A,B   ;A=extra mantissa byte
087F   21 72 01               LXI   H,FACCUM+3   ; 
0882   B7                     ORA   A   ;If bit 7 of the extra mantissa byte
0883   FC 9A 08               CM   FMantissaInc   ;is set, then round up the mantissa.
0886   46                     MOV   B,M   ;B=exponent
0887   23                     INX   H   ; 
0888   7E                     MOV   A,M   ;A=FTEMP_SIGN
0889   E6 80                  ANI   0x80   ; 
088B   A9                     XRA   C   ;Bit 7 of C is always 1. Thi
088C   4F                     MOV   C,A   ; 
088D   C3 12 0A               JMP   FLoadFromBCDE   ;Exit via copying BCDE to FACCUM.
0890   7B           FMANTISSALEFT:   MOV   A,E   
0891   17                     RAL      
0892   5F                     MOV   E,A   
0893   7A                     MOV   A,D   
0894   17                     RAL      
0895   57                     MOV   D,A   
0896   79                     MOV   A,C   
0897   8F                     ADC   A   
0898   4F                     MOV   C,A   
0899   C9                     RET      
089A   1C           FMANTISSAINC:   INR   E   
089B   C0                     RNZ      
089C   14                     INR   D   
089D   C0                     RNZ      
089E   0C                     INR   C   
089F   C0                     RNZ      
08A0   0E 80                  MVI   C,80h   ;Mantissa overflowed to zero, so set it
08A2   34                     INR   M   ;to 1 and increment the exponent.
08A3   C0                     RNZ      ;And if the exponent overflows...
08A4   1E 0A        OVERFLOW:   MVI   E,0Ah   
08A6   C3 D5 01               JMP   Error   
08A9   7E           FADDMANTISSAS:   MOV   A,M   
08AA   83                     ADD   E   
08AB   5F                     MOV   E,A   
08AC   23                     INX   H   
08AD   7E                     MOV   A,M   
08AE   8A                     ADC   D   
08AF   57                     MOV   D,A   
08B0   23                     INX   H   
08B1   7E                     MOV   A,M   
08B2   89                     ADC   C   
08B3   4F                     MOV   C,A   
08B4   C9                     RET      
08B5   21 73 01     FNEGATEINT:   LXI   H,FTEMP   
08B8   7E                     MOV   A,M   
08B9   2F                     CMA      
08BA   77                     MOV   M,A   
08BB   AF                     XRA   A   
08BC   6F                     MOV   L,A   
08BD   90                     SUB   B   
08BE   47                     MOV   B,A   
08BF   7D                     MOV   A,L   
08C0   9B                     SBB   E   
08C1   5F                     MOV   E,A   
08C2   7D                     MOV   A,L   
08C3   9A                     SBB   D   
08C4   57                     MOV   D,A   
08C5   7D                     MOV   A,L   
08C6   99                     SBB   C   
08C7   4F                     MOV   C,A   
08C8   C9                     RET      
08C9   06 00        FMANTISSARTMULT:   MVI   B,00h   ;Initialise extra mantissa byte
08CB   3C                     INR   A   
08CC   6F                     MOV   L,A   
08CD   AF           RTMULTLOOP:   XRA   A   
08CE   2D                     DCR   L   
08CF   C8                     RZ      
08D0   CD D6 08               CALL   FMantissaRtOnce   
08D3   C3 CD 08               JMP   RtMultLoop   
08D6   79           FMANTISSARTONCE:   MOV   A,C   
08D7   1F                     RAR      
08D8   4F                     MOV   C,A   
08D9   7A                     MOV   A,D   
08DA   1F                     RAR      
08DB   57                     MOV   D,A   
08DC   7B                     MOV   A,E   
08DD   1F                     RAR      
08DE   5F                     MOV   E,A   
08DF   78                     MOV   A,B   ;NB: B is the extra
08E0   1F                     RAR      ;mantissa byte.
08E1   47                     MOV   B,A   ; 
08E2   C9                     RET      ; 
08E3   C1           FMUL:     POP   B   ;Get lhs in BCDE
08E4   D1                     POP   D   ; 
08E5   EF                     RST   05   ; FTestSign	;If rhs==0 then exit
08E6   C8                     RZ      ; 
08E7   2E 00                  MVI   L,00h   ;L=0 to signify exponent add
08E9   CD 9B 09               CALL   FExponentAdd   
08EC   79                     MOV   A,C   
08ED   32 17 09               STA   FMulInnerLoop+13   
08F0   EB                     XCHG      
08F1   22 12 09               SHLD   FMulInnerLoop+8   
08F4   01 00 00               LXI   B,0000h   
08F7   50                     MOV   D,B   
08F8   58                     MOV   E,B   
08F9   21 5E 08               LXI   H,FNormalise+3   
08FC   E5                     PUSH   H   
08FD   21 05 09               LXI   H,FMulOuterLoop   
0900   E5                     PUSH   H   
0901   E5                     PUSH   H   
0902   21 6F 01               LXI   H,FACCUM   
0905   7E           FMULOUTERLOOP:   MOV   A,M   ;A=FACCUM mantissa byte
0906   23                     INX   H   ; 
0907   E5                     PUSH   H   ;Preserve FACCUM ptr
0908   2E 08                  MVI   L,08h   ;8 bits to do
090A   1F           FMULINNERLOOP:   RAR      ;Test lowest bit of mantissa byte
090B   67                     MOV   H,A   ;Preserve mantissa byte
090C   79                     MOV   A,C   ;A=result mantissa's high byte
090D   D2 19 09               JNC   L0919   ;If that bit of multiplicand was 0, then skip over adding mantissas.
0910   E5                     PUSH   H   ; 
0911   21 00 00               LXI   H,0000h   ; 
0914   19                     DAD   D   ; 
0915   D1                     POP   D   ; 
0916   CE 00                  ACI   00   ;A=result mantissa high byte. This gets back to C
0918   EB                     XCHG      ;in the call to FMantissaRtOnce+1.
0919   CD D7 08     L0919:    CALL   FMantissaRtOnce+1   
091C   2D                     DCR   L   
091D   7C                     MOV   A,H   ;Restore mantissa byte and
091E   C2 0A 09               JNZ   FMulInnerLoop   ;jump back if L is not yet 0.
0921   E1           POPHLANDRETURN:   POP   H   ;Restore FACCUM ptr
0922   C9                     RET      ;Return to FMulOuterLoop, or if finished that then exit to FNormalise
0923   CD 02 0A     FDIVBYTEN:   CALL   FPush   ; 
0926   01 20 84               LXI   B,8420h   ;BCDE=(float)10;
0929   11 00 00               LXI   D,0000h   
092C   CD 12 0A               CALL   FLoadFromBCDE   
092F   C1           FDIV:     POP   B   
0930   D1                     POP   D   
0931   EF                     RST   05   ; FTestSign	
0932   CA D3 01               JZ   DivideByZero   
0935   2E FF                  MVI   L,0xFF   
0937   CD 9B 09               CALL   FExponentAdd   
093A   34                     INR   M   
093B   34                     INR   M   
093C   2B                     DCX   H   
093D   7E                     MOV   A,M   
093E   32 60 09               STA   L095F+1   
0941   2B                     DCX   H   
0942   7E                     MOV   A,M   
0943   32 5C 09               STA   L095F-3   
0946   2B                     DCX   H   
0947   7E                     MOV   A,M   
0948   32 58 09               STA   L095F-7   
094B   41                     MOV   B,C   
094C   EB                     XCHG      
094D   AF                     XRA   A   
094E   4F                     MOV   C,A   
094F   57                     MOV   D,A   
0950   5F                     MOV   E,A   
0951   32 63 09               STA   L095F+4   
0954   E5           FDIVLOOP:   PUSH   H   
0955   C5                     PUSH   B   
0956   7D                     MOV   A,L   
0957   D6 00                  SUI   00h   
0959   6F                     MOV   L,A   
095A   7C                     MOV   A,H   
095B   DE 00                  SBI   00   
095D   67                     MOV   H,A   
095E   78                     MOV   A,B   
095F   DE 00        L095F:    SBI   00   
0961   47                     MOV   B,A   
0962   3E 00                  MVI   A,00h   
0964   DE 00                  SBI   00   
0966   3F                     CMC      
0967   D2 71 09               JNC   L0971   
096A   32 63 09               STA   L095F+4h   
096D   F1                     POP   PSW   
096E   F1                     POP   PSW   
096F   37                     STC      
0970   D2                     DB   0xD2   ;JNC ....	
0971   C1           L0971:    POP   B   
0972   E1                     POP   H   
0973   79                     MOV   A,C   
0974   3C                     INR   A   
0975   3D                     DCR   A   
0976   1F                     RAR      
0977   FA 7F 08               JM   FRoundUp+1   
097A   17                     RAL      
097B   CD 90 08               CALL   FMantissaLeft   
097E   29                     DAD   H   
097F   78                     MOV   A,B   
0980   17                     RAL      
0981   47                     MOV   B,A   
0982   3A 63 09               LDA   L095F+4h   
0985   17                     RAL      
0986   32 63 09               STA   L095F+4h   
0989   79                     MOV   A,C   
098A   B2                     ORA   D   
098B   B3                     ORA   E   
098C   C2 54 09               JNZ   FDivLoop   
098F   E5                     PUSH   H   
0990   21 72 01               LXI   H,FACCUM+3   
0993   35                     DCR   M   
0994   E1                     POP   H   
0995   C2 54 09               JNZ   FDivLoop   
0998   C3 A4 08               JMP   Overflow   
099B   78           FEXPONENTADD:   MOV   A,B   
099C   B7                     ORA   A   
099D   CA BA 09               JZ   FExponentAdd+31   
09A0   7D                     MOV   A,L   ;A=0 for add, FF for subtract.
09A1   21 72 01               LXI   H,FACCUM+3   ; 
09A4   AE                     XRA   M   ;XOR with FAccum's exponent.
09A5   80                     ADD   B   ;Add exponents
09A6   47                     MOV   B,A   ; 
09A7   1F                     RAR      ;Carry (after the add) into bit 7.
09A8   A8                     XRA   B   ;XOR with old bit 7.
09A9   78                     MOV   A,B   ; 
09AA   F2 B9 09               JP   FExponentAdd+30   ;If
09AD   C6 80                  ADI   0x80   
09AF   77                     MOV   M,A   
09B0   CA 21 09               JZ   PopHLandReturn   
09B3   CD 37 0A               CALL   FUnpackMantissas   
09B6   77                     MOV   M,A   
09B7   2B                     DCX   H   
09B8   C9                     RET      
09B9   B7                     ORA   A   
09BA   E1                     POP   H   ;Ignore return address so we'll end
09BB   FA A4 08               JM   Overflow   
09BE   AF           FZERO:    XRA   A   
09BF   32 72 01               STA   FACCUM+3   
09C2   C9                     RET      
09C3   CD 1D 0A     FMULBYTEN:   CALL   FCopyToBCDE   
09C6   78                     MOV   A,B   
09C7   B7                     ORA   A   
09C8   C8                     RZ      
09C9   C6 02                  ADI   02   
09CB   DA A4 08               JC   Overflow   
09CE   47                     MOV   B,A   
09CF   CD 12 08               CALL   FAdd+2   
09D2   21 72 01               LXI   H,FACCUM+3   
09D5   34                     INR   M   
09D6   C0                     RNZ      
09D7   C3 A4 08               JMP   Overflow   
09DA   3A 71 01     FTESTSIGN_TAIL:   LDA   FACCUM+2   
09DD   FE                     DB   0xFE   
09DE   2F           INVSIGNTOINT:   CMA      
09DF   17           SIGNTOINT:   RAL      
09E0   9F                     SBB   A   
09E1   C0                     RNZ      
09E2   3C                     INR   A   
09E3   C9                     RET      
09E4   EF           SGN:      RST   05   ; FTestSign	
09E5   06 88        FCHARTOFLOAT:   MVI   B,88h   ;ie 2^8
09E7   11 00 00               LXI   D,0000h   
09EA   21 72 01               LXI   H,FACCUM+3   
09ED   4F                     MOV   C,A   
09EE   70                     MOV   M,B   
09EF   06 00                  MVI   B,00h   
09F1   23                     INX   H   
09F2   36 80                  MVI   M,80h   
09F4   17                     RAL      
09F5   C3 5B 08               JMP   FNormalise   
09F8   EF           ABS:      RST   05   ; FTestSign	
09F9   F0                     RP      
09FA   21 71 01     FNEGATE:   LXI   H,FACCUM+2   
09FD   7E                     MOV   A,M   
09FE   EE 80                  XRI   0x80   
0A00   77                     MOV   M,A   
0A01   C9                     RET      
0A02   EB           FPUSH:    XCHG      
0A03   2A 6F 01               LHLD   FACCUM   
0A06   E3                     XTHL      
0A07   E5                     PUSH   H   
0A08   2A 71 01               LHLD   FACCUM+2   
0A0B   E3                     XTHL      
0A0C   E5                     PUSH   H   
0A0D   EB                     XCHG      
0A0E   C9                     RET      
0A0F   CD 20 0A     FLOADFROMMEM:   CALL   FLoadBCDEfromMem   
0A12   EB           FLOADFROMBCDE:   XCHG      
0A13   22 6F 01               SHLD   FACCUM   
0A16   60                     MOV   H,B   
0A17   69                     MOV   L,C   
0A18   22 71 01               SHLD   FACCUM+2   
0A1B   EB                     XCHG      
0A1C   C9                     RET      
0A1D   21 6F 01     FCOPYTOBCDE:   LXI   H,FACCUM   
0A20   5E           FLOADBCDEFROMMEM:   MOV   E,M   
0A21   23                     INX   H   
0A22   56                     MOV   D,M   
0A23   23                     INX   H   
0A24   4E                     MOV   C,M   
0A25   23                     INX   H   
0A26   46                     MOV   B,M   
0A27   23           INCHLRETURN:   INX   H   
0A28   C9                     RET      
0A29   11 6F 01     FCOPYTOMEM:   LXI   D,FACCUM   
0A2C   06 04                  MVI   B,04h   
0A2E   1A           FCOPYLOOP:   LDAX   D   
0A2F   77                     MOV   M,A   
0A30   13                     INX   D   
0A31   23                     INX   H   
0A32   05                     DCR   B   
0A33   C2 2E 0A               JNZ   FCopyLoop   
0A36   C9                     RET      
0A37   21 71 01     FUNPACKMANTISSAS:   LXI   H,FACCUM+2   
0A3A   7E                     MOV   A,M   ; 
0A3B   07                     RLC      ;Move FACCUM's sign to bit 0.
0A3C   37                     STC      ;Set MSB of FACCUM mantissa,
0A3D   1F                     RAR      ;FACCUM's sign is now in carry.
0A3E   77                     MOV   M,A   ; 
0A3F   3F                     CMC      ;Negate FACCUM's sign.
0A40   1F                     RAR      ;Bit 7 of A is now FACCUM's sign.
0A41   23                     INX   H   ;Store negated FACCUM sign at FTEMP_SIGN.
0A42   23                     INX   H   ; 
0A43   77                     MOV   M,A   ; 
0A44   79                     MOV   A,C   ; 
0A45   07                     RLC      ;Set MSB of BCDE mantissa,
0A46   37                     STC      ;BCDE's sign is now in carry.
0A47   1F                     RAR      ; 
0A48   4F                     MOV   C,A   ; 
0A49   1F                     RAR      ;Bit 7 of A is now BCDE's sign
0A4A   AE                     XRA   M   ;XORed with FTEMP_SIGN.
0A4B   C9                     RET      ; 
0A4C   78           FCOMPARE:   MOV   A,B   
0A4D   B7                     ORA   A   
0A4E   CA 28 00               JZ   FTestSign   
0A51   21 DE 09               LXI   H,InvSignToInt   
0A54   E5                     PUSH   H   
0A55   EF                     RST   05   ; FTestSign	
0A56   79                     MOV   A,C   
0A57   C8                     RZ      
0A58   21 71 01               LXI   H,FACCUM+2   
0A5B   AE                     XRA   M   
0A5C   79                     MOV   A,C   
0A5D   F8                     RM      
0A5E   CD 64 0A               CALL   FIsEqual   
0A61   1F                     RAR      
0A62   A9                     XRA   C   
0A63   C9                     RET      
0A64   23           FISEQUAL:   INX   H   
0A65   78                     MOV   A,B   
0A66   BE                     CMP   M   
0A67   C0                     RNZ      
0A68   2B                     DCX   H   
0A69   79                     MOV   A,C   
0A6A   BE                     CMP   M   
0A6B   C0                     RNZ      
0A6C   2B                     DCX   H   
0A6D   7A                     MOV   A,D   
0A6E   BE                     CMP   M   
0A6F   C0                     RNZ      
0A70   2B                     DCX   H   
0A71   7B                     MOV   A,E   
0A72   96                     SUB   M   
0A73   C0                     RNZ      ; 
0A74   E1                     POP   H   ;Lose 0A5E
0A75   E1                     POP   H   ;Lose 09DE
0A76   C9                     RET      ;Return to caller
0A77   47           FASINTEGER:   MOV   B,A   ; 
0A78   4F                     MOV   C,A   
0A79   57                     MOV   D,A   
0A7A   5F                     MOV   E,A   
0A7B   B7                     ORA   A   
0A7C   C8                     RZ      
0A7D   E5                     PUSH   H   
0A7E   CD 1D 0A               CALL   FCopyToBCDE   
0A81   CD 37 0A               CALL   FUnpackMantissas   
0A84   AE                     XRA   M   ;Get sign back
0A85   67                     MOV   H,A   
0A86   FC 9B 0A               CM   FMantissaDec   
0A89   3E 98                  MVI   A,98h   
0A8B   90                     SUB   B   ;by (24-exponent) places?
0A8C   CD C9 08               CALL   FMantissaRtMult   ;WHY?
0A8F   7C                     MOV   A,H   
0A90   17                     RAL      
0A91   DC 9A 08               CC   FMantissaInc   
0A94   06 00                  MVI   B,00h   ;Needed for FNegateInt.
0A96   DC B5 08               CC   FNegateInt   
0A99   E1                     POP   H   
0A9A   C9                     RET      
0A9B   1B           FMANTISSADEC:   DCX   D   ;DE--
0A9C   7A                     MOV   A,D   ;If DE!=0xFFFF...
0A9D   A3                     ANA   E   ; 
0A9E   3C                     INR   A   ; 
0A9F   C0                     RNZ      ;... then return
0AA0   0D                     DCR   C   ;C--
0AA1   C9                     RET      ; 
0AA2   21 72 01     INT:      LXI   H,FACCUM+3   ; 
0AA5   7E                     MOV   A,M   ; 
0AA6   FE 98                  CPI   0x98   ; 
0AA8   D0                     RNC      ; 
0AA9   CD 77 0A               CALL   FAsInteger   ; 
0AAC   36 98                  MVI   M,98h   ; 
0AAE   79                     MOV   A,C   ; 
0AAF   17                     RAL      ; 
0AB0   C3 5B 08               JMP   FNormalise   ; 
0AB3   2B           FIN:      DCX   H   ; 
0AB4   CD BE 09               CALL   FZero   ; 
0AB7   47                     MOV   B,A   ;B=count of fractional digits
0AB8   57                     MOV   D,A   ;D=exponent sign
0AB9   5F                     MOV   E,A   ;E=exponent
0ABA   2F                     CMA      ;C=decimal_point_done (0xFF for no, 0x00 for yes)
0ABB   4F                     MOV   C,A   ; 
0ABC   D7           FINLOOP:   RST   02   ;RST NextChar	
0ABD   DA 04 0B               JC   ProcessDigit   
0AC0   FE 2E                  CPI   "."   
0AC2   CA E4 0A               JZ   L0AE4   
0AC5   FE 45                  CPI   "E"   
0AC7   C2 E8 0A               JNZ   ScaleResult   
0ACA   D7           GETEXPONENT:   RST   02   ;RST NextChar	
0ACB   15                     DCR   D   
0ACC   FE 99                  CPI   0x99   ;KWID_MINUS	
0ACE   CA D8 0A               JZ   NextExponentDigit   
0AD1   14                     INR   D   
0AD2   FE 98                  CPI   0x98   ;KWID_PLUS	
0AD4   CA D8 0A               JZ   NextExponentDigit   
0AD7   2B                     DCX   H   
0AD8   D7           NEXTEXPONENTDIGIT:   RST   02   ;RST NextChar	
0AD9   DA 23 0B               JC   DoExponentDigit   
0ADC   14                     INR   D   
0ADD   C2 E8 0A               JNZ   ScaleResult   
0AE0   AF                     XRA   A   
0AE1   93                     SUB   E   
0AE2   5F                     MOV   E,A   
0AE3   0C                     INR   C   ;C was 0xFF, so here it
0AE4   0C           L0AE4:    INR   C   ;becomes 0x01.
0AE5   CA BC 0A               JZ   FInLoop   ;If C is now zero
0AE8   E5           SCALERESULT:   PUSH   H   
0AE9   7B                     MOV   A,E   
0AEA   90                     SUB   B   
0AEB   F4 FC 0A     DECIMALLOOP:   CP   DecimalShiftUp   
0AEE   F2 F7 0A               JP   DecimalLoopEnd   
0AF1   F5                     PUSH   PSW   
0AF2   CD 23 09               CALL   FDivByTen   
0AF5   F1                     POP   PSW   
0AF6   3C                     INR   A   
0AF7   C2 EB 0A     DECIMALLOOPEND:   JNZ   DecimalLoop   
0AFA   E1                     POP   H   
0AFB   C9                     RET      
0AFC   C8           DECIMALSHIFTUP:   RZ      
0AFD   F5                     PUSH   PSW   
0AFE   CD C3 09               CALL   FMulByTen   
0B01   F1                     POP   PSW   
0B02   3D                     DCR   A   
0B03   C9                     RET      
0B04   D5           PROCESSDIGIT:   PUSH   D   
0B05   57                     MOV   D,A   
0B06   78                     MOV   A,B   
0B07   89                     ADC   C   
0B08   47                     MOV   B,A   
0B09   C5                     PUSH   B   
0B0A   E5                     PUSH   H   
0B0B   D5                     PUSH   D   
0B0C   CD C3 09               CALL   FMulByTen   
0B0F   F1                     POP   PSW   
0B10   D6 30                  SUI   "0"   
0B12   CD 02 0A               CALL   FPush   
0B15   CD E5 09               CALL   FCharToFloat   
0B18   C1                     POP   B   
0B19   D1                     POP   D   
0B1A   CD 12 08               CALL   FAdd+2   
0B1D   E1                     POP   H   
0B1E   C1                     POP   B   
0B1F   D1                     POP   D   
0B20   C3 BC 0A               JMP   FInLoop   
0B23   7B           DOEXPONENTDIGIT:   MOV   A,E   
0B24   07                     RLC      
0B25   07                     RLC      
0B26   83                     ADD   E   
0B27   07                     RLC      
0B28   86                     ADD   M   
0B29   D6 30                  SUI   "0"   
0B2B   5F                     MOV   E,A   
0B2C   C3 D8 0A               JMP   NextExponentDigit   
0B2F   E5           PRINTIN:   PUSH   H   
0B30   21 88 01               LXI   H,szIn   
0B33   CD A3 05               CALL   PrintString   
0B36   E1                     POP   H   
0B37   EB           PRINTINT:   XCHG      ;DE=integer
0B38   AF                     XRA   A   ;A=0 (ends up in C)
0B39   06 98                  MVI   B,98h   ;B (ie exponent) = 24
0B3B   CD EA 09               CALL   FCharToFloat+5   
0B3E   21 A2 05               LXI   H,PrintString-1   
0B41   E5                     PUSH   H   
0B42   21 74 01     FOUT:     LXI   H,FBUFFER   
0B45   E5                     PUSH   H   
0B46   EF                     RST   05   ; FTestSign	
0B47   36 20                  MVI   M," "   
0B49   F2 4E 0B               JP   DoZero   
0B4C   36 2D                  MVI   M,"-"   
0B4E   23           DOZERO:   INX   H   
0B4F   36 30                  MVI   M,"0"   
0B51   CA F7 0B               JZ   NullTerm-3   
0B54   E5                     PUSH   H   
0B55   FC FA 09               CM   FNegate   
0B58   AF                     XRA   A   
0B59   F5                     PUSH   PSW   
0B5A   CD FD 0B               CALL   ToUnder1000000   
0B5D   01 43 91     TOOVER100000:   LXI   B,9143h   ;BCDE=(float)100,000.
0B60   11 F8 4F               LXI   D,4FF8h   ; 
0B63   CD 4C 0A               CALL   FCompare   ;If FACCUM >= 100,000
0B66   E2 7A 0B               JPO   PrepareToPrint   ;then jump to PrepareToPrint.
0B69   F1                     POP   PSW   ;A=DecExpAdj
0B6A   CD FD 0A               CALL   DecimalShiftUp+1   ;FACCUM*=10; DecExpAdj--;
0B6D   F5                     PUSH   PSW   ; 
0B6E   C3 5D 0B               JMP   ToOver100000   
0B71   CD 23 09     L0B71:    CALL   FDivByTen   
0B74   F1                     POP   PSW   
0B75   3C                     INR   A   ;DecExpAdj++;
0B76   F5                     PUSH   PSW   
0B77   CD FD 0B               CALL   ToUnder1000000   
0B7A   CD 01 08     PREPARETOPRINT:   CALL   FAddOneHalf   
0B7D   3C                     INR   A   
0B7E   CD 77 0A               CALL   FAsInteger   
0B81   CD 12 0A               CALL   FLoadFromBCDE   
0B84   01 06 02               LXI   B,0206h   
0B87   F1                     POP   PSW   ;A=DecExpAdj+6.
0B88   81                     ADD   C   ; 
0B89   FA 95 0B               JM   L0B95   ;If A<1 or A>6 Then goto fixme.
0B8C   FE 07                  CPI   0x07   ; 
0B8E   D2 95 0B               JNC   L0B95   ; 
0B91   3C                     INR   A   ; 
0B92   47                     MOV   B,A   ; 
0B93   3E 01                  MVI   A,01h   ;A=1, indicating scientific notation.
0B95   3D           L0B95:    DCR   A   ; 
0B96   E1                     POP   H   ;HL=output buffer
0B97   F5                     PUSH   PSW   ;Preserve decimal exponent adjustment (and preserve zero flag used to indicate scientific notation wanted).
0B98   11 0F 0C               LXI   D,DECIMAL_POWERS   
0B9B   05           NEXTDIGIT:   DCR   B   
0B9C   36 2E                  MVI   M,"."   
0B9E   CC 27 0A               CZ   IncHLReturn   ;0A27 just happens to inc HL and RET.
0BA1   C5                     PUSH   B   ; 
0BA2   E5                     PUSH   H   ; 
0BA3   D5                     PUSH   D   ;DE=>decimal power
0BA4   CD 1D 0A               CALL   FCopyToBCDE   ;Store BCDE to FACCUM.
0BA7   E1                     POP   H   ;HL=>decimal power.
0BA8   06 2F                  MVI   B,"0"-1   ; 
0BAA   04           DIGITLOOP:   INR   B   ; 
0BAB   7B                     MOV   A,E   ; 
0BAC   96                     SUB   M   ; 
0BAD   5F                     MOV   E,A   ; 
0BAE   23                     INX   H   ; 
0BAF   7A                     MOV   A,D   ; 
0BB0   9E                     SBB   M   ; 
0BB1   57                     MOV   D,A   ; 
0BB2   23                     INX   H   ; 
0BB3   79                     MOV   A,C   ; 
0BB4   9E                     SBB   M   ; 
0BB5   4F                     MOV   C,A   ; 
0BB6   2B                     DCX   H   ; 
0BB7   2B                     DCX   H   ; 
0BB8   D2 AA 0B               JNC   DigitLoop   ; 
0BBB   CD A9 08               CALL   FAddMantissas   ; 
0BBE   23                     INX   H   ;???
0BBF   CD 12 0A               CALL   FLoadFromBCDE   ; 
0BC2   EB                     XCHG      ; 
0BC3   E1                     POP   H   ;HL=output buffer
0BC4   70                     MOV   M,B   ; 
0BC5   23                     INX   H   ; 
0BC6   C1                     POP   B   ;B=decimal point place
0BC7   0D                     DCR   C   ;C=digits remaining, minus one.
0BC8   C2 9B 0B               JNZ   NextDigit   ; 
0BCB   05                     DCR   B   ; 
0BCC   CA DB 0B               JZ   L0BDB   ; 
0BCF   2B           L0BCF:    DCX   H   ; 
0BD0   7E                     MOV   A,M   ; 
0BD1   FE 30                  CPI   "0"   ; 
0BD3   CA CF 0B               JZ   L0BCF   ; 
0BD6   FE 2E                  CPI   "."   ; 
0BD8   C4 27 0A               CNZ   IncHLReturn   ; 
0BDB   F1           L0BDB:    POP   PSW   ; 
0BDC   CA FA 0B               JZ   NullTerm   ; 
0BDF   36 45                  MVI   M,"E"   ;Write "E"
0BE1   23                     INX   H   ; 
0BE2   36 2B                  MVI   M,"+"   ;Write "+" or "-"
0BE4   F2 EB 0B               JP   L0BEB   ; 
0BE7   36 2D                  MVI   M,"-"   ;Write "-" if it's negative, also
0BE9   2F                     CMA      ;two's complement the decimal exponent
0BEA   3C                     INR   A   ;so printing it will work.
0BEB   06 2F        L0BEB:    MVI   B,"0"-1   ; 
0BED   04           EXPDIGITLOOP:   INR   B   ; 
0BEE   D6 0A                  SUI   0Ah   ; 
0BF0   D2 ED 0B               JNC   ExpDigitLoop   ; 
0BF3   C6 3A                  ADI   3Ah   ;Adding "0"+10 gives us the 2nd digit
0BF5   23                     INX   H   ;of the exponent.
0BF6   70                     MOV   M,B   ;Write first digit.
0BF7   23                     INX   H   ; 
0BF8   77                     MOV   M,A   ;Write second digit of exponent.
0BF9   23                     INX   H   ; 
0BFA   71           NULLTERM:   MOV   M,C   ;Null byte terminator.
0BFB   E1                     POP   H   ; 
0BFC   C9                     RET      ; 
0BFD   01 74 94     TOUNDER1000000:   LXI   B,9474h   ; 
0C00   11 F7 23               LXI   D,23F7h   ; 
0C03   CD 4C 0A               CALL   FCompare   ; 
0C06   E1                     POP   H   ; 
0C07   E2 71 0B               JPO   L0B71   ; 
0C0A   E9                     PCHL      ; 
0C0B   00 00 00 80  ONE_HALF:   DB   0x00,0x00,0x00,0x80   ; DD 0.5	
0C0F   A0 86 01     DECIMAL_POWERS:   DB   0xA0,0x86,0x01   ; DT 100000	
0C12   10 27 00               DB   0x10,0x27,0x00   ; DT 10000	
0C15   E8 03 00               DB   0xE8,0x03,0x00   ; DT 1000	
0C18   64 00 00               DB   0x64,0x00,0x00   ; DT 100	
0C1B   0A 00 00               DB   0x0A,0x00,0x00   ; DT 10	
0C1E   01 00 00               DB   0x01,0x00,0x00   ; DT 1	
0C21   EF           SQR:      RST   05   ; FTestSign	;
0C22   FA 98 04               JM   FunctionCallError   ; 
0C25   C8                     RZ      ; 
0C26   21 72 01               LXI   H,FACCUM+3   ; 
0C29   7E                     MOV   A,M   ; 
0C2A   1F                     RAR      ; 
0C2B   F5                     PUSH   PSW   ; 
0C2C   E5                     PUSH   H   ; 
0C2D   3E 40                  MVI   A,40h   ; 
0C2F   17                     RAL      ; 
0C30   77                     MOV   M,A   ; 
0C31   21 74 01               LXI   H,FBUFFER   ; 
0C34   CD 29 0A               CALL   FCopyToMem   ; 
0C37   3E 04                  MVI   A,04h   ; 
0C39   F5           SQRLOOP:   PUSH   PSW   ; 
0C3A   CD 02 0A               CALL   FPush   ; 
0C3D   21 74 01               LXI   H,FBUFFER   ; 
0C40   CD 20 0A               CALL   FLoadBCDEfromMem   
0C43   CD 31 09               CALL   FDiv+2   
0C46   C1                     POP   B   
0C47   D1                     POP   D   
0C48   CD 12 08               CALL   FAdd+2   
0C4B   01 00 80               LXI   B,8000h   
0C4E   51                     MOV   D,C   
0C4F   59                     MOV   E,C   
0C50   CD E5 08               CALL   FMul+2   
0C53   F1                     POP   PSW   
0C54   3D                     DCR   A   
0C55   C2 39 0C               JNZ   SqrLoop   
0C58   E1                     POP   H   
0C59   F1                     POP   PSW   
0C5A   C6 C0                  ADI   0xC0   
0C5C   86                     ADD   M   
0C5D   77                     MOV   M,A   
0C5E   C9                     RET      
0C5F   EF           RND:      RST   05   ; FTestSign	
0C60   FA 7C 0C               JM   L0C7C   
0C63   21 91 0C               LXI   H,RND_SEED   
0C66   CD 0F 0A               CALL   FLoadFromMem   
0C69   C8                     RZ      
0C6A   01 35 98               LXI   B,9835h   
0C6D   11 7A 44               LXI   D,447Ah   
0C70   CD E5 08               CALL   FMul+2   
0C73   01 28 68               LXI   B,0x6828   
0C76   11 46 B1               LXI   D,0xB146   
0C79   CD 12 08               CALL   FAdd+2   
0C7C   CD 1D 0A     L0C7C:    CALL   FCopyToBCDE   
0C7F   7B                     MOV   A,E   
0C80   59                     MOV   E,C   
0C81   4F                     MOV   C,A   
0C82   36 80                  MVI   M,80h   
0C84   2B                     DCX   H   
0C85   46                     MOV   B,M   
0C86   36 80                  MVI   M,80h   
0C88   CD 5E 08               CALL   FNormalise+3   
0C8B   21 91 0C               LXI   H,RND_SEED   
0C8E   C3 29 0A               JMP   FCopyToMem   
0C91   52 C7 4F 80  RND_SEED:   DB   52h,0C7h,4Fh,80h   
0C95   CD 02 0A     SIN:      CALL   FPush   ;ush x
0C98   01 49 83               LXI   B,8349h   ;CDE=2p
0C9B   11 DB 0F               LXI   D,0FDBh   ; 
0C9E   CD 12 0A               CALL   FLoadFromBCDE   ;hs = 2p
0CA1   C1                     POP   B   ;hs = x
0CA2   D1                     POP   D   ; 
0CA3   CD 31 09               CALL   FDiv+2   ;=x/2p
0CA6   CD 02 0A               CALL   FPush   ; 
0CA9   CD A2 0A               CALL   Int   ;hs = INT(u)
0CAC   C1                     POP   B   ;hs = u
0CAD   D1                     POP   D   ; 
0CAE   CD 0C 08               CALL   FSub+2   ;=u-INT(u)
0CB1   01 00 7F               LXI   B,7F00h   ;CDE=0.25
0CB4   51                     MOV   D,C   ; 
0CB5   59                     MOV   E,C   ; 
0CB6   CD 0C 08               CALL   FSub+2   ; 
0CB9   EF                     RST   05   ; FTestSign	;
0CBA   37                     STC      ;set carry (ie no later negate)
0CBB   F2 C3 0C               JP   NegateIfPositive   ; 
0CBE   CD 01 08               CALL   FAddOneHalf   ; 
0CC1   EF                     RST   05   ; 
0CC2   B7                     ORA   A   ;resets carry (ie later negate)
0CC3   F5           NEGATEIFPOSITIVE:   PUSH   PSW   ; 
0CC4   F4 FA 09               CP   FNegate   ; 
0CC7   01 00 7F               LXI   B,7F00h   ;CDE=0.25
0CCA   51                     MOV   D,C   ; 
0CCB   59                     MOV   E,C   ; 
0CCC   CD 12 08               CALL   FAdd+2   ; 
0CCF   F1                     POP   PSW   ; 
0CD0   D4 FA 09               CNC   FNegate   ; 
0CD3   CD 02 0A               CALL   FPush   ; 
0CD6   CD 1D 0A               CALL   FCopyToBCDE   ; 
0CD9   CD E5 08               CALL   FMul+2   ; = x*x
0CDC   CD 02 0A               CALL   FPush   ;ush x*x
0CDF   21 03 0D               LXI   H,TAYLOR_SERIES   ; 
0CE2   CD 0F 0A               CALL   FLoadFromMem   ; 
0CE5   C1                     POP   B   ; 
0CE6   D1                     POP   D   ; 
0CE7   3E 04                  MVI   A,04h   ; 
0CE9   F5           TAYLORLOOP:   PUSH   PSW   ;ush #terms remaining
0CEA   D5                     PUSH   D   ;ush BCDE
0CEB   C5                     PUSH   B   ; 
0CEC   E5                     PUSH   H   ; 
0CED   CD E5 08               CALL   FMul+2   ; 
0CF0   E1                     POP   H   ; 
0CF1   CD 20 0A               CALL   FLoadBCDEfromMem   ; 
0CF4   E5                     PUSH   H   ; 
0CF5   CD 12 08               CALL   FAdd+2   ; 
0CF8   E1                     POP   H   ; 
0CF9   C1                     POP   B   ; 
0CFA   D1                     POP   D   ; 
0CFB   F1                     POP   PSW   ;op #terms remaining into A.
0CFC   3D                     DCR   A   ;ecrement #terms and loop back if not
0CFD   C2 E9 0C               JNZ   TaylorLoop   ;one all 4 of them.
0D00   C3 E3 08               JMP   FMul   ; 
0D03   BA D7 1E 86  TAYLOR_SERIES:   DB   0xBA,0xD7,0x1E,0x86   ;DD 39.710670	
0D07   64 26 99 87            DB   0x64,0x26,0x99,0x87   ;DD -76.574982	
0D0B   58 34 23 87            DB   0x58,0x34,0x23,0x87   ;DD 81.602234	
0D0F   E0 5D A5 86            DB   0xE0,0x5D,0xA5,0x86   ;DD -41.341675	
0D13   DA 0F 49 83            DB   0xDA,0x0F,0x49,0x83   ;DD 6.283185	
0D17   00 00 00 00 00 00 00 00 00 00 L0D17:   DB   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00   ;   DD 6.283185
0D21   21 1A 0F     INIT:     LXI   H,0x0F1A   ; *** STACK_TOP RELOCATE
0D24   F9                     SPHL      ; 
0D25   22 63 01               SHLD   STACK_TOP   ; 
0D28   DB 01                  IN   01   ; 
0D2A   0E FF                  MVI   C,0xFF   ; 
0D2C   11 8E 0D               LXI   D,ConfigIOcode   ; 
0D2F   D5                     PUSH   D   ; 
0D30   3A FF 0F               LDA   0FFFh   ; *** RELOCATE
0D33   47                     MOV   B,A   ; 
0D34   DB FF                  IN   0xFF   ; 
0D36   1F                     RAR      ; 
0D37   DA 41 0D               JC   L0D42-1   ; 
0D3A   E6 0C                  ANI   0Ch   ; 
0D3C   CA 42 0D               JZ   L0D42   ; 
0D3F   06 10                  MVI   B,10h   ; 
0D41   78                     MOV   A,B   ; 
0D42   32 8C 0D     L0D42:    STA   L0D8D-1   ; 
0D45   DB FF                  IN   0xFF   ; 
0D47   17                     RAL      ; 
0D48   17                     RAL      ; 
0D49   06 20                  MVI   B,20h   ; 
0D4B   11 02 CA     L0D4B:    LXI   D,0xCA02   ; 
0D4E   D8                     RC      ; 
0D4F   17                     RAL      ; 
0D50   43                     MOV   B,E   ; 
0D51   1D                     DCR   E   ; 
0D52   D8                     RC      ; 
0D53   17                     RAL      ; 
0D54   DA 6F 0D               JC   L0D6F   ; 
0D57   43                     MOV   B,E   ; 
0D58   11 80 C2               LXI   D,0xC280   ; 
0D5B   17                     RAL      ; 
0D5C   D0                     RNC      ; 
0D5D   17                     RAL      ; 
0D5E   3E 03                  MVI   A,03h   ; 
0D60   CD 8B 0D               CALL   L0D8B   ; 
0D63   3D                     DCR   A   ; 
0D64   8F                     ADC   A   ; 
0D65   87                     ADD   A   ; 
0D66   87                     ADD   A   ; 
0D67   3C                     INR   A   ; 
0D68   CD 8B 0D               CALL   L0D8B   ; 
0D6B   37                     STC      ; 
0D6C   C3 4B 0D               JMP   L0D4B   ; 
0D6F   AF           L0D6F:    XRA   A   ; 
0D70   CD 8B 0D               CALL   L0D8B   ; 
0D73   CD 87 0D               CALL   L0D87   ; 
0D76   CD 87 0D               CALL   L0D87   ; 
0D79   4B                     MOV   C,E   ; 
0D7A   2F                     CMA      ; 
0D7B   CD 87 0D               CALL   L0D87   ; 
0D7E   3E 04                  MVI   A,04h   ; 
0D80   35                     DCR   M   ; 
0D81   CD 8B 0D               CALL   L0D8B   ; 
0D84   35                     DCR   M   ; 
0D85   35                     DCR   M   ; 
0D86   35                     DCR   M   ; 
0D87   21 8C 0D     L0D87:    LXI   H,L0D8D-1   ; 
0D8A   34                     INR   M   ; 
0D8B   D3 00        L0D8B:    OUT   00   ; 
0D8D   C9           L0D8D:    RET      ; 
0D8E   62           CONFIGIOCODE:   MOV   H,D   ; 
0D8F   68                     MOV   L,B   ; 
0D90   22 85 03               SHLD   InputChar+3   ; 
0D93   7C                     MOV   A,H   ; 
0D94   E6 C8                  ANI   0xC8   ; 
0D96   67                     MOV   H,A   ; 
0D97   22 76 04               SHLD   TestBreakKey+3   ; 
0D9A   EB                     XCHG      ; 
0D9B   22 7A 03               SHLD   WaitTermReady+3   ; 
0D9E   3A 8C 0D               LDA   L0D8D-1   ; 
0DA1   32 83 03               STA   InputChar+1   ; 
0DA4   32 74 04               STA   TestBreakKey+1   ; 
0DA7   3C                     INR   A   ; 
0DA8   32 8A 03               STA   InputChar+8   ; 
0DAB   81                     ADD   C   ; 
0DAC   32 78 03               STA   WaitTermReady+1   ; 
0DAF   3C                     INR   A   ; 
0DB0   32 80 03               STA   InputChar-2   ; 
0DB3   21 FF FF               LXI   H,0xFFFF   ; 
0DB6   22 61 01               SHLD   CURRENT_LINE   ; 
0DB9   CD 8A 05               CALL   NewLine   ; 
0DBC   21 F0 0E               LXI   H,szMemorySize   ; 
0DBF   CD A3 05               CALL   PrintString   
0DC2   CD C2 02               CALL   InputLineWith   
0DC5   D7                     RST   02   ;RST NextChar	
0DC6   B7                     ORA   A   
0DC7   C2 DE 0D               JNZ   L0DDE   
0DCA   21 FC 0E               LXI   H,UnusedMemory   
0DCD   23           FINDMEMTOPLOOP:   INX   H   
0DCE   3E 37                  MVI   A,37h   
0DD0   77                     MOV   M,A   
0DD1   BE                     CMP   M   
0DD2   C2 EA 0D               JNZ   DoneMemSize   
0DD5   3D                     DCR   A   
0DD6   77                     MOV   M,A   
0DD7   BE                     CMP   M   
0DD8   CA CD 0D               JZ   FindMemTopLoop   
0DDB   C3 EA 0D               JMP   DoneMemSize   
0DDE   21 13 01     L0DDE:    LXI   H,LINE_BUFFER   
0DE1   CD 9D 04               CALL   LineNumberFromStr   
0DE4   B7                     ORA   A   
0DE5   C2 D0 01               JNZ   SyntaxError   
0DE8   EB                     XCHG      
0DE9   2B                     DCX   H   
0DEA   2B           DONEMEMSIZE:   DCX   H   
0DEB   E5                     PUSH   H   
0DEC   21 B4 0E     GETTERMINALWIDTH:   LXI   H,szTerminalWidth   
0DEF   CD A3 05               CALL   PrintString   
0DF2   CD C2 02               CALL   InputLineWith   
0DF5   D7                     RST   02   ;RST NextChar	
0DF6   B7                     ORA   A   
0DF7   CA 1B 0E               JZ   DoOptionalFns   
0DFA   21 13 01               LXI   H,LINE_BUFFER   
0DFD   CD 9D 04               CALL   LineNumberFromStr   
0E00   7A                     MOV   A,D   
0E01   B7                     ORA   A   
0E02   C2 EC 0D               JNZ   GetTerminalWidth   
0E05   7B                     MOV   A,E   
0E06   FE 10                  CPI   0x10   
0E08   DA EC 0D               JC   GetTerminalWidth   
0E0B   32 6F 03               STA   OutChar_tail+1   
0E0E   D6 0E        CALCTABBRKSIZE:   SUI   0Eh   
0E10   D2 0E 0E               JNC   CalcTabBrkSize   
0E13   C6 1C                  ADI   1Ch   
0E15   2F                     CMA      
0E16   3C                     INR   A   
0E17   83                     ADD   E   
0E18   32 B7 05               STA   ToNextTabBreak+4   
0E1B   21 85 0E     DOOPTIONALFNS:   LXI   H,OPT_FN_DESCS   
0E1E   F7           OPTIONALFNSLOOP:   RST   6   
0E1F   11 99 0E               LXI   D,szWantSin   
0E22   E7                     RST   4   
0E23   CA 32 0E               JZ   L0E32   
0E26   F7                     RST   6   
0E27   E3                     XTHL      
0E28   CD A3 05               CALL   PrintString   
0E2B   CD C2 02               CALL   InputLineWith   
0E2E   D7                     RST   02   ;RST NextChar	
0E2F   E1                     POP   H   
0E30   FE 59                  CPI   "Y"   
0E32   D1           L0E32:    POP   D   
0E33   CA 47 0E               JZ   InitProgramBase   
0E36   FE 4E                  CPI   "N"   
0E38   C2 1B 0E               JNZ   DoOptionalFns   
0E3B   F7                     RST   6   
0E3C   E3                     XTHL      
0E3D   11 98 04               LXI   D,FunctionCallError   
0E40   73                     MOV   M,E   
0E41   23                     INX   H   
0E42   72                     MOV   M,D   
0E43   E1                     POP   H   
0E44   C3 1E 0E               JMP   OptionalFnsLoop   
0E47   EB           INITPROGRAMBASE:   XCHG      
0E48   36 00                  MVI   M,00h   
0E4A   23                     INX   H   
0E4B   22 65 01               SHLD   PROGRAM_BASE   
0E4E   E3                     XTHL      
0E4F   11 1A 0F               LXI   D,STK_TOP   ; *** RELOCATE STACK_TOP	
0E52   E7                     RST   4   
0E53   DA CD 01               JC   OutOfMemory   
0E56   D1                     POP   D   
0E57   F9                     SPHL      
0E58   22 63 01               SHLD   STACK_TOP   
0E5B   EB                     XCHG      
0E5C   CD C3 01               CALL   CheckEnoughMem   
0E5F   7B                     MOV   A,E   
0E60   95                     SUB   L   
0E61   6F                     MOV   L,A   
0E62   7A                     MOV   A,D   
0E63   9C                     SBB   H   
0E64   67                     MOV   H,A   
0E65   01 F0 FF               LXI   B,0xFFF0   
0E68   09                     DAD   B   
0E69   CD 8A 05               CALL   NewLine   
0E6C   CD 37 0B               CALL   PrintInt   
0E6F   21 C3 0E               LXI   H,szVersionInfo   
0E72   CD A3 05               CALL   PrintString   
0E75   21 A3 05               LXI   H,PrintString   
0E78   22 FD 01               SHLD   Main+4   
0E7B   CD 96 02               CALL   New+1   
0E7E   21 F9 01               LXI   H,Main   
0E81   22 02 00               SHLD   Start+2   
0E84   E9                     PCHL      
0E85   17 0D        OPT_FN_DESCS:   DW   L0D17   
0E87   99 0E                  DW   szWantSin   
0E89   49 00                  DW   KW_INLINE_FNS+12   
0E8B   95 0C                  DW   Sin   
0E8D   A2 0E                  DW   szWantRnd   
0E8F   47 00                  DW   KW_INLINE_FNS+10   
0E91   5F 0C                  DW   Rnd   
0E93   AB 0E                  DW   szWantSqr   
0E95   45 00                  DW   KW_INLINE_FNS+8   
0E97   21 0C                  DW   Sqr   
0E99   57 41 4E 54 20 53 49 CE 00 SZWANTSIN:   DB   57h,41h,4Eh,54h,20h,53h,49h,0CEh,00h   ; DS "WANT SIN\0"
0EA2   57 41 4E 54 20 52 4E C4 00 SZWANTRND:   DB   57h,41h,4Eh,54h,20h,52h,4Eh,0C4h,00h   ; DS "WANT RND\0"
0EAB   57 41 4E 54 20 53 51 D2 00 SZWANTSQR:   DB   57h,41h,4Eh,54h,20h,53h,51h,0D2h,00h   ; DS "WANT SQR\0"
0EB4   54 45 52 4D 49 4E 41 4C 20 57 49 44 54 C8 00 SZTERMINALWIDTH:   DB   54h,45h,52h,4Dh,49h,4Eh,41h,4Ch,20h,57h,49h,44h,54h,0C8h,00h   ; DS "TERMINAL WIDTH\0"
0EC3   20 42 59 54 45 53 20 46 52 45 C5 0D 0D SZVERSIONINFO:   DB   0x20,0x42,0x59,0x54,0x45,0x53,0x20,0x46,0x52,0x45,0xC5,0x0D,0x0D   ; DS " BYTES FREE\r\r"
0ED0   42 41 53 49 43 20 56 45 52 53 49 4F 4E 20 33 2E DB   0x42,0x41,0x53,0x49,0x43,0x20,0x56,0x45,0x52,0x53,0x49,0x4F,0x4E,0x20,0x33,0x2E   ; "BASIC VERSION 3."
0EE0   B2 0D 5B 34 4B 20 56 45 52 53 49 4F 4E DD 0D 00 DB   0xB2,0x0D,0x5B,0x34,0x4B,0x20,0x56,0x45,0x52,0x53,0x49,0x4F,0x4E,0xDD,0x0D,0x00   ; "2\r[4K VERSION]\r\0"
0EF0   4D 45 4D 4F 52 59 20 53 49 5A C5 00 SZMEMORYSIZE:   DB   0x4D,0x45,0x4D,0x4F,0x52,0x59,0x20,0x53,0x49,0x5A,0xC5,0x00   ; DS "MEMORY SIZE\0"
0EFC   00           UNUSEDMEMORY:   DB   00   


UART_RX:            0018 DEFINED AT LINE 9
UART_TX:            0018 DEFINED AT LINE 10
UART_RX_STATUS:     0019 DEFINED AT LINE 11
UART_TX_STATUS:     0019 DEFINED AT LINE 12
UART_RX_FULL:       0001 DEFINED AT LINE 13
UART_TX_FULL:       0004 DEFINED AT LINE 14
STK_TOP:            0F1A DEFINED AT LINE 16
                    > USED AT LINE 2119
START:              0000 DEFINED AT LINE 20
                    > USED AT LINE 2143
SYNTAXCHECK:        0008 DEFINED AT LINE 26
NEXTCHAR:           0010 DEFINED AT LINE 32
                    > USED AT LINE 627
OUTCHAR:            0018 DEFINED AT LINE 37
COMPAREHLDE:        0020 DEFINED AT LINE 41
TERMINAL_Y:         0026 DEFINED AT LINE 47
                    > USED AT LINE 803
TERMINAL_X:         0027 DEFINED AT LINE 48
                    > USED AT LINE 38
                    > USED AT LINE 485
                    > USED AT LINE 799
                    > USED AT LINE 805
                    > USED AT LINE 823
                    > USED AT LINE 836
FTESTSIGN:          0028 DEFINED AT LINE 49
                    > USED AT LINE 1562
PUSHNEXTWORD:       0030 DEFINED AT LINE 53
L003A:              003A DEFINED AT LINE 61
                    > USED AT LINE 54
                    > USED AT LINE 61
KW_INLINE_FNS:      003D DEFINED AT LINE 62
                    > USED AT LINE 1014
                    > USED AT LINE 2148
                    > USED AT LINE 2151
                    > USED AT LINE 2154
KW_ARITH_OP_FNS:    004B DEFINED AT LINE 69
                    > USED AT LINE 960
KEYWORDS:           0057 DEFINED AT LINE 77
                    > USED AT LINE 399
                    > USED AT LINE 526
KW_GENERAL_FNS:     00D2 DEFINED AT LINE 121
                    > USED AT LINE 617
ERROR_CODES:        00FA DEFINED AT LINE 142
                    > USED AT LINE 233
LINE_BUFFER:        0113 DEFINED AT LINE 156
                    > USED AT LINE 308
                    > USED AT LINE 388
                    > USED AT LINE 445
                    > USED AT LINE 458
                    > USED AT LINE 797
                    > USED AT LINE 2060
                    > USED AT LINE 2074
DIM_OR_EVAL:        015B DEFINED AT LINE 166
                    > USED AT LINE 1027
                    > USED AT LINE 1096
                    > USED AT LINE 1102
                    > USED AT LINE 1125
                    > USED AT LINE 1145
INPUT_OR_READ:      015C DEFINED AT LINE 167
                    > USED AT LINE 862
                    > USED AT LINE 875
                    > USED AT LINE 890
PROG_PTR_TEMP:      015D DEFINED AT LINE 168
                    > USED AT LINE 367
                    > USED AT LINE 379
                    > USED AT LINE 582
                    > USED AT LINE 730
                    > USED AT LINE 908
                    > USED AT LINE 939
L015F:              015F DEFINED AT LINE 169
                    > USED AT LINE 947
                    > USED AT LINE 948
                    > USED AT LINE 974
CURRENT_LINE:       0161 DEFINED AT LINE 170
                    > USED AT LINE 244
                    > USED AT LINE 255
                    > USED AT LINE 555
                    > USED AT LINE 603
                    > USED AT LINE 688
                    > USED AT LINE 711
                    > USED AT LINE 850
                    > USED AT LINE 934
                    > USED AT LINE 2041
STACK_TOP:          0163 DEFINED AT LINE 171
                    > USED AT LINE 373
                    > USED AT LINE 1963
                    > USED AT LINE 2124
PROGRAM_BASE:       0165 DEFINED AT LINE 172
                    > USED AT LINE 336
                    > USED AT LINE 357
                    > USED AT LINE 365
                    > USED AT LINE 634
                    > USED AT LINE 2117
VAR_BASE:           0167 DEFINED AT LINE 173
                    > USED AT LINE 278
                    > USED AT LINE 287
                    > USED AT LINE 291
                    > USED AT LINE 298
                    > USED AT LINE 363
                    > USED AT LINE 369
                    > USED AT LINE 1042
VAR_ARRAY_BASE:     0169 DEFINED AT LINE 174
                    > USED AT LINE 370
                    > USED AT LINE 1040
                    > USED AT LINE 1079
                    > USED AT LINE 1108
VAR_TOP:            016B DEFINED AT LINE 175
                    > USED AT LINE 211
                    > USED AT LINE 371
                    > USED AT LINE 1069
                    > USED AT LINE 1076
                    > USED AT LINE 1114
                    > USED AT LINE 1162
DATA_PROG_PTR:      016D DEFINED AT LINE 176
                    > USED AT LINE 636
                    > USED AT LINE 859
FACCUM:             016F DEFINED AT LINE 177
                    > USED AT LINE 49
                    > USED AT LINE 655
                    > USED AT LINE 1092
                    > USED AT LINE 1185
                    > USED AT LINE 1204
                    > USED AT LINE 1241
                    > USED AT LINE 1247
                    > USED AT LINE 1347
                    > USED AT LINE 1437
                    > USED AT LINE 1446
                    > USED AT LINE 1465
                    > USED AT LINE 1475
                    > USED AT LINE 1479
                    > USED AT LINE 1490
                    > USED AT LINE 1500
                    > USED AT LINE 1506
                    > USED AT LINE 1509
                    > USED AT LINE 1516
                    > USED AT LINE 1519
                    > USED AT LINE 1522
                    > USED AT LINE 1532
                    > USED AT LINE 1541
                    > USED AT LINE 1568
                    > USED AT LINE 1624
                    > USED AT LINE 1845
FTEMP:              0173 DEFINED AT LINE 178
                    > USED AT LINE 1290
FBUFFER:            0174 DEFINED AT LINE 179
                    > USED AT LINE 1721
                    > USED AT LINE 1853
                    > USED AT LINE 1858
SZERROR:            0181 DEFINED AT LINE 182
                    > USED AT LINE 242
SZIN:               0188 DEFINED AT LINE 183
                    > USED AT LINE 1712
SZOK:               018D DEFINED AT LINE 184
                    > USED AT LINE 252
GETFLOWPTR:         0192 DEFINED AT LINE 185
                    > USED AT LINE 198
                    > USED AT LINE 543
                    > USED AT LINE 705
                    > USED AT LINE 909
COPYMEMORYUP:       01A7 DEFINED AT LINE 199
                    > USED AT LINE 296
                    > USED AT LINE 1074
COPYMEMLOOP:        01AD DEFINED AT LINE 203
                    > USED AT LINE 209
CHECKENOUGHVARSPACE: 01B6 DEFINED AT LINE 210
                    > USED AT LINE 550
                    > USED AT LINE 684
                    > USED AT LINE 945
CHECKENOUGHMEM:     01C3 DEFINED AT LINE 218
                    > USED AT LINE 199
                    > USED AT LINE 215
                    > USED AT LINE 1161
                    > USED AT LINE 2126
OUTOFMEMORY:        01CD DEFINED AT LINE 226
                    > USED AT LINE 2121
SYNTAXERROR:        01D0 DEFINED AT LINE 228
                    > USED AT LINE 31
                    > USED AT LINE 592
                    > USED AT LINE 612
                    > USED AT LINE 668
                    > USED AT LINE 752
                    > USED AT LINE 874
                    > USED AT LINE 1030
                    > USED AT LINE 2063
DIVIDEBYZERO:       01D3 DEFINED AT LINE 230
                    > USED AT LINE 1375
ERROR:              01D5 DEFINED AT LINE 231
                    > USED AT LINE 659
                    > USED AT LINE 702
                    > USED AT LINE 709
                    > USED AT LINE 855
                    > USED AT LINE 900
                    > USED AT LINE 917
                    > USED AT LINE 1128
                    > USED AT LINE 1134
                    > USED AT LINE 1277
STOP:               01F7 DEFINED AT LINE 250
                    > USED AT LINE 121
                    > USED AT LINE 136
                    > USED AT LINE 644
MAIN:               01F9 DEFINED AT LINE 252
                    > USED AT LINE 508
                    > USED AT LINE 598
                    > USED AT LINE 2140
                    > USED AT LINE 2142
GETNONBLANKLINE:    01FF DEFINED AT LINE 254
                    > USED AT LINE 260
                    > USED AT LINE 323
STOREPROGRAMLINE:   021C DEFINED AT LINE 269
REMOVEPROGRAMLINE:  0228 DEFINED AT LINE 277
REMOVELINE:         022C DEFINED AT LINE 279
                    > USED AT LINE 284
INSERTPROGRAMLINE:  0239 DEFINED AT LINE 288
                    > USED AT LINE 276
COPYFROMBUFFER:     0255 DEFINED AT LINE 308
                    > USED AT LINE 314
UPDATELINKEDLIST:   0260 DEFINED AT LINE 315
                    > USED AT LINE 290
L0265:              0265 DEFINED AT LINE 318
                    > USED AT LINE 335
L0271:              0271 DEFINED AT LINE 328
                    > USED AT LINE 330
FINDPROGRAMLINE:    027D DEFINED AT LINE 336
                    > USED AT LINE 274
                    > USED AT LINE 355
                    > USED AT LINE 501
                    > USED AT LINE 696
NEW:                0295 DEFINED AT LINE 356
                    > USED AT LINE 140
                    > USED AT LINE 2141
RUN:                02A1 DEFINED AT LINE 364
                    > USED AT LINE 130
RESETALL:           02A2 DEFINED AT LINE 365
                    > USED AT LINE 315
CLEAR:              02A6 DEFINED AT LINE 367
                    > USED AT LINE 139
RESETSTACK:         02B5 DEFINED AT LINE 372
                    > USED AT LINE 231
INPUTLINEWITH:      02C2 DEFINED AT LINE 381
                    > USED AT LINE 856
                    > USED AT LINE 881
                    > USED AT LINE 2045
                    > USED AT LINE 2070
                    > USED AT LINE 2098
TOKENIZE:           02CC DEFINED AT LINE 387
                    > USED AT LINE 264
                    > USED AT LINE 424
KWCOMPARE:          02E9 DEFINED AT LINE 402
                    > USED AT LINE 411
                    > USED AT LINE 444
NOTAKEYWORD:        02FF DEFINED AT LINE 416
                    > USED AT LINE 406
WRITECHAR:          0302 DEFINED AT LINE 419
                    > USED AT LINE 391
                    > USED AT LINE 430
FREECOPYLOOP:       030C DEFINED AT LINE 426
                    > USED AT LINE 435
FREECOPY:           0315 DEFINED AT LINE 431
                    > USED AT LINE 394
NEXTKEYWORD:        031C DEFINED AT LINE 436
                    > USED AT LINE 408
NEXTKWLOOP:         0320 DEFINED AT LINE 440
                    > USED AT LINE 442
EXIT:               0329 DEFINED AT LINE 445
                    > USED AT LINE 396
                    > USED AT LINE 428
BACKSPACE:          0332 DEFINED AT LINE 452
                    > USED AT LINE 470
RESETINPUT:         0338 DEFINED AT LINE 456
                    > USED AT LINE 468
INPUTLINE:          033C DEFINED AT LINE 458
                    > USED AT LINE 256
                    > USED AT LINE 385
INPUTNEXT:          0341 DEFINED AT LINE 460
                    > USED AT LINE 455
                    > USED AT LINE 464
                    > USED AT LINE 466
                    > USED AT LINE 481
L036A:              036A DEFINED AT LINE 480
                    > USED AT LINE 475
OUTCHAR_TAIL:       036E DEFINED AT LINE 482
                    > USED AT LINE 39
                    > USED AT LINE 2082
WAITTERMREADY:      0377 DEFINED AT LINE 486
                    > USED AT LINE 488
                    > USED AT LINE 2030
                    > USED AT LINE 2037
INPUTCHAR:          0382 DEFINED AT LINE 492
                    > USED AT LINE 460
                    > USED AT LINE 494
                    > USED AT LINE 642
                    > USED AT LINE 2024
                    > USED AT LINE 2032
                    > USED AT LINE 2035
                    > USED AT LINE 2039
LIST:               038E DEFINED AT LINE 498
                    > USED AT LINE 138
LISTNEXTLINE:       0397 DEFINED AT LINE 503
                    > USED AT LINE 521
LISTCHAR:           03AE DEFINED AT LINE 517
                    > USED AT LINE 522
                    > USED AT LINE 537
TONEXTKEYWORD:      03C0 DEFINED AT LINE 528
                    > USED AT LINE 531
                    > USED AT LINE 534
PRINTKEYWORD:       03CB DEFINED AT LINE 535
                    > USED AT LINE 540
FOR:                03D5 DEFINED AT LINE 541
                    > USED AT LINE 122
L03E2:              03E2 DEFINED AT LINE 548
                    > USED AT LINE 545
PUSHSTEPVALUE:      0414 DEFINED AT LINE 577
                    > USED AT LINE 571
ENDOFFORHANDLER:    041D DEFINED AT LINE 584
                    > USED AT LINE 937
EXECNEXT:           0421 DEFINED AT LINE 587
                    > USED AT LINE 606
                    > USED AT LINE 712
                    > USED AT LINE 940
EXEC:               043E DEFINED AT LINE 605
                    > USED AT LINE 268
                    > USED AT LINE 590
                    > USED AT LINE 772
NEXTCHAR_TAIL:      045E DEFINED AT LINE 626
                    > USED AT LINE 36
RESTORE:            0469 DEFINED AT LINE 633
                    > USED AT LINE 132
                    > USED AT LINE 368
L046E:              046E DEFINED AT LINE 636
                    > USED AT LINE 894
TESTBREAKKEY:       0473 DEFINED AT LINE 639
                    > USED AT LINE 509
                    > USED AT LINE 587
                    > USED AT LINE 2028
                    > USED AT LINE 2033
CHARISALPHA:        0480 DEFINED AT LINE 645
                    > USED AT LINE 978
                    > USED AT LINE 1029
GETSUBSCRIPT:       0488 DEFINED AT LINE 651
                    > USED AT LINE 831
                    > USED AT LINE 1098
FUNCTIONCALLERROR:  0498 DEFINED AT LINE 658
                    > USED AT LINE 65
                    > USED AT LINE 654
                    > USED AT LINE 1843
                    > USED AT LINE 2108
LINENUMBERFROMSTR:  049D DEFINED AT LINE 660
                    > USED AT LINE 262
                    > USED AT LINE 498
                    > USED AT LINE 694
                    > USED AT LINE 2061
                    > USED AT LINE 2075
NEXTLINENUMCHAR:    04A1 DEFINED AT LINE 662
                    > USED AT LINE 682
GOSUB:              04BE DEFINED AT LINE 683
                    > USED AT LINE 133
GOTO:               04CF DEFINED AT LINE 694
                    > USED AT LINE 129
                    > USED AT LINE 771
RETURN:             04DF DEFINED AT LINE 703
                    > USED AT LINE 134
FINDNEXTSTATEMENT:  04F5 DEFINED AT LINE 714
                    > USED AT LINE 124
                    > USED AT LINE 552
REM:                04F7 DEFINED AT LINE 715
                    > USED AT LINE 135
                    > USED AT LINE 769
FINDNEXTSTATEMENTLOOP: 04F9 DEFINED AT LINE 717
                    > USED AT LINE 723
LET:                0502 DEFINED AT LINE 724
                    > USED AT LINE 128
                    > USED AT LINE 541
                    > USED AT LINE 610
ASSIGNVAR:          0507 DEFINED AT LINE 727
                    > USED AT LINE 884
IFL:                0516 DEFINED AT LINE 736
                    > USED AT LINE 131
GETCOMPAREOPLOOP:   051F DEFINED AT LINE 740
                    > USED AT LINE 749
GOTCOMPAREOP:       0532 DEFINED AT LINE 750
                    > USED AT LINE 741
                    > USED AT LINE 743
PRINT:              0557 DEFINED AT LINE 775
                    > USED AT LINE 137
                    > USED AT LINE 779
                    > USED AT LINE 795
                    > USED AT LINE 848
TERMINATEINPUT:     0585 DEFINED AT LINE 796
                    > USED AT LINE 462
NEWLINE:            058A DEFINED AT LINE 798
                    > USED AT LINE 232
                    > USED AT LINE 457
                    > USED AT LINE 483
                    > USED AT LINE 511
                    > USED AT LINE 775
                    > USED AT LINE 821
                    > USED AT LINE 825
                    > USED AT LINE 2042
                    > USED AT LINE 2135
PRINTNULLLOOP:      0596 DEFINED AT LINE 804
                    > USED AT LINE 811
PRINTSTRING:        05A3 DEFINED AT LINE 813
                    > USED AT LINE 243
                    > USED AT LINE 778
                    > USED AT LINE 791
                    > USED AT LINE 822
                    > USED AT LINE 1713
                    > USED AT LINE 1719
                    > USED AT LINE 2044
                    > USED AT LINE 2069
                    > USED AT LINE 2097
                    > USED AT LINE 2138
                    > USED AT LINE 2139
TONEXTTABBREAK:     05B3 DEFINED AT LINE 823
                    > USED AT LINE 784
                    > USED AT LINE 2089
CALCSPACECOUNT:     05BE DEFINED AT LINE 827
                    > USED AT LINE 828
TAB:                05C7 DEFINED AT LINE 831
                    > USED AT LINE 781
PRINTSPACES:        05D6 DEFINED AT LINE 840
                    > USED AT LINE 830
PRINTSPACELOOP:     05DA DEFINED AT LINE 843
                    > USED AT LINE 845
EXITTAB:            05DF DEFINED AT LINE 846
                    > USED AT LINE 786
                    > USED AT LINE 826
                    > USED AT LINE 839
INPUT:              05E4 DEFINED AT LINE 849
                    > USED AT LINE 125
READ:               05F6 DEFINED AT LINE 858
                    > USED AT LINE 127
L05FA:              05FA DEFINED AT LINE 860
                    > USED AT LINE 857
READNEXT:           0601 DEFINED AT LINE 865
                    > USED AT LINE 888
GOTDATAITEM:        0620 DEFINED AT LINE 882
                    > USED AT LINE 872
                    > USED AT LINE 906
NEXTDATALINE:       0635 DEFINED AT LINE 895
                    > USED AT LINE 878
                    > USED AT LINE 904
NEXT:               0649 DEFINED AT LINE 907
                    > USED AT LINE 123
FORLOOPISCOMPLETE:  0683 DEFINED AT LINE 938
                    > USED AT LINE 932
EVALEXPRESSION:     068A DEFINED AT LINE 941
                    > USED AT LINE 559
                    > USED AT LINE 572
                    > USED AT LINE 652
                    > USED AT LINE 728
                    > USED AT LINE 736
                    > USED AT LINE 754
                    > USED AT LINE 788
                    > USED AT LINE 975
                    > USED AT LINE 990
ARITHPARSE:         0699 DEFINED AT LINE 948
                    > USED AT LINE 968
EVALTERM:           06C4 DEFINED AT LINE 976
                    > USED AT LINE 946
                    > USED AT LINE 981
                    > USED AT LINE 994
EVALBRACKETED:      06E2 DEFINED AT LINE 988
                    > USED AT LINE 1010
EVALMINUSTERM:      06EA DEFINED AT LINE 994
                    > USED AT LINE 985
EVALVARTERM:        06F3 DEFINED AT LINE 999
                    > USED AT LINE 979
EVALINLINEFN:       06FD DEFINED AT LINE 1005
                    > USED AT LINE 987
DIMCONTD:           0711 DEFINED AT LINE 1018
                    > USED AT LINE 1023
DIM:                0716 DEFINED AT LINE 1023
                    > USED AT LINE 126
GETVAR:             071B DEFINED AT LINE 1026
                    > USED AT LINE 724
                    > USED AT LINE 867
                    > USED AT LINE 907
                    > USED AT LINE 999
FINDVARLOOP:        073B DEFINED AT LINE 1043
                    > USED AT LINE 1057
L0747:              0747 DEFINED AT LINE 1051
                    > USED AT LINE 1048
ALLOCNEWVAR:        0752 DEFINED AT LINE 1058
                    > USED AT LINE 1044
INITVARLOOP:        0776 DEFINED AT LINE 1080
                    > USED AT LINE 1083
L0782:              0782 DEFINED AT LINE 1089
                    > USED AT LINE 1052
ALREADYALLOCD:      0785 DEFINED AT LINE 1092
                    > USED AT LINE 1064
GETARRAYVAR:        078A DEFINED AT LINE 1095
                    > USED AT LINE 1038
FINDARRAY:          07A1 DEFINED AT LINE 1110
                    > USED AT LINE 1124
L07BF:              07BF DEFINED AT LINE 1129
                    > USED AT LINE 1168
ALLOCARRAY:         07CD DEFINED AT LINE 1140
                    > USED AT LINE 1118
L07E1:              07E1 DEFINED AT LINE 1154
                    > USED AT LINE 1147
INITELEMENTS:       07EF DEFINED AT LINE 1164
                    > USED AT LINE 1167
FWORDTOFLOAT:       07F9 DEFINED AT LINE 1169
FADDONEHALF:        0801 DEFINED AT LINE 1173
                    > USED AT LINE 1748
                    > USED AT LINE 1919
FADDMEM:            0804 DEFINED AT LINE 1174
                    > USED AT LINE 921
FSUB:               080A DEFINED AT LINE 1176
                    > USED AT LINE 72
                    > USED AT LINE 1911
                    > USED AT LINE 1915
FADD:               0810 DEFINED AT LINE 1180
                    > USED AT LINE 70
                    > USED AT LINE 1175
                    > USED AT LINE 1474
                    > USED AT LINE 1697
                    > USED AT LINE 1863
                    > USED AT LINE 1887
                    > USED AT LINE 1927
                    > USED AT LINE 1947
L082C:              082C DEFINED AT LINE 1198
                    > USED AT LINE 1189
FSUBMANTISSAS:      084D DEFINED AT LINE 1213
                    > USED AT LINE 1205
FNORMALISE:         085B DEFINED AT LINE 1227
                    > USED AT LINE 1342
                    > USED AT LINE 1497
                    > USED AT LINE 1632
                    > USED AT LINE 1896
NORMLOOP:           0865 DEFINED AT LINE 1232
                    > USED AT LINE 1240
FROUNDUP:           087E DEFINED AT LINE 1246
                    > USED AT LINE 1207
                    > USED AT LINE 1212
                    > USED AT LINE 1231
                    > USED AT LINE 1422
FMANTISSALEFT:      0890 DEFINED AT LINE 1257
                    > USED AT LINE 1238
                    > USED AT LINE 1424
FMANTISSAINC:       089A DEFINED AT LINE 1267
                    > USED AT LINE 1249
                    > USED AT LINE 1612
OVERFLOW:           08A4 DEFINED AT LINE 1276
                    > USED AT LINE 1210
                    > USED AT LINE 1441
                    > USED AT LINE 1463
                    > USED AT LINE 1472
                    > USED AT LINE 1478
FADDMANTISSAS:      08A9 DEFINED AT LINE 1278
                    > USED AT LINE 1206
                    > USED AT LINE 1789
FNEGATEINT:         08B5 DEFINED AT LINE 1290
                    > USED AT LINE 1227
                    > USED AT LINE 1614
FMANTISSARTMULT:    08C9 DEFINED AT LINE 1308
                    > USED AT LINE 1202
                    > USED AT LINE 1609
RTMULTLOOP:         08CD DEFINED AT LINE 1311
                    > USED AT LINE 1315
FMANTISSARTONCE:    08D6 DEFINED AT LINE 1316
                    > USED AT LINE 1211
                    > USED AT LINE 1314
                    > USED AT LINE 1362
FMUL:               08E3 DEFINED AT LINE 1329
                    > USED AT LINE 74
                    > USED AT LINE 1867
                    > USED AT LINE 1884
                    > USED AT LINE 1932
                    > USED AT LINE 1943
                    > USED AT LINE 1954
FMULOUTERLOOP:      0905 DEFINED AT LINE 1348
                    > USED AT LINE 1344
FMULINNERLOOP:      090A DEFINED AT LINE 1352
                    > USED AT LINE 1336
                    > USED AT LINE 1338
                    > USED AT LINE 1365
L0919:              0919 DEFINED AT LINE 1362
                    > USED AT LINE 1355
POPHLANDRETURN:     0921 DEFINED AT LINE 1366
                    > USED AT LINE 1456
FDIVBYTEN:          0923 DEFINED AT LINE 1368
                    > USED AT LINE 1670
                    > USED AT LINE 1743
FDIV:               092F DEFINED AT LINE 1372
                    > USED AT LINE 76
                    > USED AT LINE 1860
                    > USED AT LINE 1906
FDIVLOOP:           0954 DEFINED AT LINE 1396
                    > USED AT LINE 1435
                    > USED AT LINE 1440
L095F:              095F DEFINED AT LINE 1405
                    > USED AT LINE 1382
                    > USED AT LINE 1385
                    > USED AT LINE 1388
                    > USED AT LINE 1395
                    > USED AT LINE 1411
                    > USED AT LINE 1429
                    > USED AT LINE 1431
L0971:              0971 DEFINED AT LINE 1416
                    > USED AT LINE 1410
FEXPONENTADD:       099B DEFINED AT LINE 1442
                    > USED AT LINE 1334
                    > USED AT LINE 1377
                    > USED AT LINE 1444
                    > USED AT LINE 1453
FZERO:              09BE DEFINED AT LINE 1464
                    > USED AT LINE 1233
                    > USED AT LINE 1244
                    > USED AT LINE 1634
FMULBYTEN:          09C3 DEFINED AT LINE 1467
                    > USED AT LINE 1678
                    > USED AT LINE 1690
FTESTSIGN_TAIL:     09DA DEFINED AT LINE 1479
                    > USED AT LINE 51
INVSIGNTOINT:       09DE DEFINED AT LINE 1481
                    > USED AT LINE 1563
SIGNTOINT:          09DF DEFINED AT LINE 1482
SGN:                09E4 DEFINED AT LINE 1487
                    > USED AT LINE 62
FCHARTOFLOAT:       09E5 DEFINED AT LINE 1488
                    > USED AT LINE 1172
                    > USED AT LINE 1694
                    > USED AT LINE 1718
ABS:                09F8 DEFINED AT LINE 1498
                    > USED AT LINE 64
FNEGATE:            09FA DEFINED AT LINE 1500
                    > USED AT LINE 996
                    > USED AT LINE 1178
                    > USED AT LINE 1731
                    > USED AT LINE 1923
                    > USED AT LINE 1929
FPUSH:              0A02 DEFINED AT LINE 1505
                    > USED AT LINE 738
                    > USED AT LINE 971
                    > USED AT LINE 1193
                    > USED AT LINE 1368
                    > USED AT LINE 1693
                    > USED AT LINE 1857
                    > USED AT LINE 1900
                    > USED AT LINE 1907
                    > USED AT LINE 1930
                    > USED AT LINE 1933
FLOADFROMMEM:       0A0F DEFINED AT LINE 1514
                    > USED AT LINE 918
                    > USED AT LINE 1002
                    > USED AT LINE 1880
                    > USED AT LINE 1935
FLOADFROMBCDE:      0A12 DEFINED AT LINE 1515
                    > USED AT LINE 1187
                    > USED AT LINE 1195
                    > USED AT LINE 1256
                    > USED AT LINE 1371
                    > USED AT LINE 1751
                    > USED AT LINE 1791
                    > USED AT LINE 1903
FCOPYTOBCDE:        0A1D DEFINED AT LINE 1522
                    > USED AT LINE 561
                    > USED AT LINE 574
                    > USED AT LINE 1467
                    > USED AT LINE 1602
                    > USED AT LINE 1771
                    > USED AT LINE 1888
                    > USED AT LINE 1931
FLOADBCDEFROMMEM:   0A20 DEFINED AT LINE 1523
                    > USED AT LINE 925
                    > USED AT LINE 931
                    > USED AT LINE 1174
                    > USED AT LINE 1514
                    > USED AT LINE 1859
                    > USED AT LINE 1945
INCHLRETURN:        0A27 DEFINED AT LINE 1530
                    > USED AT LINE 1767
                    > USED AT LINE 1806
FCOPYTOMEM:         0A29 DEFINED AT LINE 1532
                    > USED AT LINE 732
                    > USED AT LINE 923
                    > USED AT LINE 1854
                    > USED AT LINE 1898
FCOPYLOOP:          0A2E DEFINED AT LINE 1534
                    > USED AT LINE 1539
FUNPACKMANTISSAS:   0A37 DEFINED AT LINE 1541
                    > USED AT LINE 1199
                    > USED AT LINE 1457
                    > USED AT LINE 1603
FCOMPARE:           0A4C DEFINED AT LINE 1560
                    > USED AT LINE 763
                    > USED AT LINE 927
                    > USED AT LINE 1737
                    > USED AT LINE 1831
FISEQUAL:           0A64 DEFINED AT LINE 1576
                    > USED AT LINE 1572
FASINTEGER:         0A77 DEFINED AT LINE 1595
                    > USED AT LINE 657
                    > USED AT LINE 1628
                    > USED AT LINE 1750
FMANTISSADEC:       0A9B DEFINED AT LINE 1617
                    > USED AT LINE 1606
INT:                0AA2 DEFINED AT LINE 1624
                    > USED AT LINE 63
                    > USED AT LINE 1908
FIN:                0AB3 DEFINED AT LINE 1633
                    > USED AT LINE 977
                    > USED AT LINE 983
FINLOOP:            0ABC DEFINED AT LINE 1640
                    > USED AT LINE 1663
                    > USED AT LINE 1701
GETEXPONENT:        0ACA DEFINED AT LINE 1646
NEXTEXPONENTDIGIT:  0AD8 DEFINED AT LINE 1654
                    > USED AT LINE 1649
                    > USED AT LINE 1652
                    > USED AT LINE 1710
L0AE4:              0AE4 DEFINED AT LINE 1662
                    > USED AT LINE 1643
SCALERESULT:        0AE8 DEFINED AT LINE 1664
                    > USED AT LINE 1645
                    > USED AT LINE 1657
DECIMALLOOP:        0AEB DEFINED AT LINE 1667
                    > USED AT LINE 1673
DECIMALLOOPEND:     0AF7 DEFINED AT LINE 1673
                    > USED AT LINE 1668
DECIMALSHIFTUP:     0AFC DEFINED AT LINE 1676
                    > USED AT LINE 1667
                    > USED AT LINE 1740
PROCESSDIGIT:       0B04 DEFINED AT LINE 1682
                    > USED AT LINE 1641
DOEXPONENTDIGIT:    0B23 DEFINED AT LINE 1702
                    > USED AT LINE 1655
PRINTIN:            0B2F DEFINED AT LINE 1711
                    > USED AT LINE 248
PRINTINT:           0B37 DEFINED AT LINE 1715
                    > USED AT LINE 514
                    > USED AT LINE 2136
FOUT:               0B42 DEFINED AT LINE 1721
                    > USED AT LINE 790
DOZERO:             0B4E DEFINED AT LINE 1727
                    > USED AT LINE 1725
TOOVER100000:       0B5D DEFINED AT LINE 1735
                    > USED AT LINE 1742
L0B71:              0B71 DEFINED AT LINE 1743
                    > USED AT LINE 1833
PREPARETOPRINT:     0B7A DEFINED AT LINE 1748
                    > USED AT LINE 1738
L0B95:              0B95 DEFINED AT LINE 1761
                    > USED AT LINE 1755
                    > USED AT LINE 1757
NEXTDIGIT:          0B9B DEFINED AT LINE 1765
                    > USED AT LINE 1798
DIGITLOOP:          0BAA DEFINED AT LINE 1774
                    > USED AT LINE 1788
L0BCF:              0BCF DEFINED AT LINE 1801
                    > USED AT LINE 1804
L0BDB:              0BDB DEFINED AT LINE 1807
                    > USED AT LINE 1800
L0BEB:              0BEB DEFINED AT LINE 1816
                    > USED AT LINE 1812
EXPDIGITLOOP:       0BED DEFINED AT LINE 1817
                    > USED AT LINE 1819
NULLTERM:           0BFA DEFINED AT LINE 1826
                    > USED AT LINE 1729
                    > USED AT LINE 1808
TOUNDER1000000:     0BFD DEFINED AT LINE 1829
                    > USED AT LINE 1734
                    > USED AT LINE 1747
ONE_HALF:           0C0B DEFINED AT LINE 1835
                    > USED AT LINE 1173
DECIMAL_POWERS:     0C0F DEFINED AT LINE 1836
                    > USED AT LINE 1764
SQR:                0C21 DEFINED AT LINE 1842
                    > USED AT LINE 66
                    > USED AT LINE 2156
SQRLOOP:            0C39 DEFINED AT LINE 1856
                    > USED AT LINE 1870
RND:                0C5F DEFINED AT LINE 1877
                    > USED AT LINE 67
                    > USED AT LINE 2152
L0C7C:              0C7C DEFINED AT LINE 1888
                    > USED AT LINE 1878
RND_SEED:           0C91 DEFINED AT LINE 1899
                    > USED AT LINE 1879
                    > USED AT LINE 1897
SIN:                0C95 DEFINED AT LINE 1900
                    > USED AT LINE 68
                    > USED AT LINE 2149
NEGATEIFPOSITIVE:   0CC3 DEFINED AT LINE 1922
                    > USED AT LINE 1918
TAYLORLOOP:         0CE9 DEFINED AT LINE 1939
                    > USED AT LINE 1953
TAYLOR_SERIES:      0D03 DEFINED AT LINE 1955
                    > USED AT LINE 1934
L0D17:              0D17 DEFINED AT LINE 1960
                    > USED AT LINE 2146
INIT:               0D21 DEFINED AT LINE 1961
                    > USED AT LINE 21
                    > USED AT LINE 253
L0D42:              0D42 DEFINED AT LINE 1977
                    > USED AT LINE 1972
                    > USED AT LINE 1974
L0D4B:              0D4B DEFINED AT LINE 1982
                    > USED AT LINE 2004
L0D6F:              0D6F DEFINED AT LINE 2005
                    > USED AT LINE 1989
L0D87:              0D87 DEFINED AT LINE 2018
                    > USED AT LINE 2007
                    > USED AT LINE 2008
                    > USED AT LINE 2011
L0D8B:              0D8B DEFINED AT LINE 2020
                    > USED AT LINE 1996
                    > USED AT LINE 2002
                    > USED AT LINE 2006
                    > USED AT LINE 2014
L0D8D:              0D8D DEFINED AT LINE 2021
                    > USED AT LINE 1977
                    > USED AT LINE 2018
                    > USED AT LINE 2031
CONFIGIOCODE:       0D8E DEFINED AT LINE 2022
                    > USED AT LINE 1966
FINDMEMTOPLOOP:     0DCD DEFINED AT LINE 2050
                    > USED AT LINE 2058
L0DDE:              0DDE DEFINED AT LINE 2060
                    > USED AT LINE 2048
DONEMEMSIZE:        0DEA DEFINED AT LINE 2066
                    > USED AT LINE 2054
                    > USED AT LINE 2059
GETTERMINALWIDTH:   0DEC DEFINED AT LINE 2068
                    > USED AT LINE 2078
                    > USED AT LINE 2081
CALCTABBRKSIZE:     0E0E DEFINED AT LINE 2083
                    > USED AT LINE 2084
DOOPTIONALFNS:      0E1B DEFINED AT LINE 2090
                    > USED AT LINE 2073
                    > USED AT LINE 2105
OPTIONALFNSLOOP:    0E1E DEFINED AT LINE 2091
                    > USED AT LINE 2113
L0E32:              0E32 DEFINED AT LINE 2102
                    > USED AT LINE 2094
INITPROGRAMBASE:    0E47 DEFINED AT LINE 2114
                    > USED AT LINE 2103
OPT_FN_DESCS:       0E85 DEFINED AT LINE 2146
                    > USED AT LINE 2090
SZWANTSIN:          0E99 DEFINED AT LINE 2158
                    > USED AT LINE 2092
                    > USED AT LINE 2147
SZWANTRND:          0EA2 DEFINED AT LINE 2159
                    > USED AT LINE 2150
SZWANTSQR:          0EAB DEFINED AT LINE 2160
                    > USED AT LINE 2153
SZTERMINALWIDTH:    0EB4 DEFINED AT LINE 2163
                    > USED AT LINE 2068
SZVERSIONINFO:      0EC3 DEFINED AT LINE 2165
                    > USED AT LINE 2137
SZMEMORYSIZE:       0EF0 DEFINED AT LINE 2168
                    > USED AT LINE 2043
UNUSEDMEMORY:       0EFC DEFINED AT LINE 2172
                    > USED AT LINE 2049