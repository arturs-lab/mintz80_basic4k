0000                             ; ----------------------------------------------------------------------------
0000                             ;Micro-Soft Altair BASIC 3.2 (4K) - Annotated Disassembly
0000                             ;	
0000                             ;Copyright 1975, Bill Gates, Paul Allen, Monte Davidoff
0000                             ;Source: http://altairbasic.org/ compiled by Reuben Harris
0000                             ;Additional cleanup, relocation by Charles Mangin, March, 2019
0000                             ; ----------------------------------------------------------------------------
0000                UART_RX:   EQU   $18   
0000                UART_TX:   EQU   $18   
0000                UART_RX_STATUS:   EQU   $19   
0000                UART_TX_STATUS:   EQU   $19   
0000                UART_RX_FULL:   EQU   $01   
0000                UART_TX_EMPTY:   EQU   $04   
0000                STK_TOP:   EQU   0x0F1A   
0000                MEM_TOP:   EQU   0x2000   
0000                          .ORG   00   
0000   F3           START:    DI      
0001   C3 2F 0D               JMP   Init   
0004   90 04                  DW   0490h   
0006   F9 07                  DW   07F9h   
0008   7E           SYNTAXCHECK:   MOV   A,M   ;A=Byte of BASIC program.
0009   E3                     XTHL      ;HL=return address.
000A   BE                     CMP   M   ;Compare to byte expected.
000B   23                     INX   H   ;Return address++;
000C   E3                     XTHL      ; 
000D   C2 D0 01               JNZ   SyntaxError   ;Error if not what was expected.
0010   23           NEXTCHAR:   INX   H   
0011   7E                     MOV   A,M   
0012   FE 3A                  CPI   0x3A   
0014   D0                     RNC      
0015   C3 68 04               JMP   NextChar_tail   
0018   F5           OUTCHAR:   PUSH   PSW   
0019   3A 27 00               LDA   TERMINAL_X   
001C   C3 6E 03               JMP   OutChar_tail   
001F   00                     NOP      
0020   7C           COMPAREHLDE:   MOV   A,H   
0021   92                     SUB   D   
0022   C0                     RNZ      
0023   7D                     MOV   A,L   
0024   93                     SUB   E   
0025   C9                     RET      
0026   01           TERMINAL_Y:   DB   01   
0027   00           TERMINAL_X:   DB   00   
0028   3A 72 01     FTESTSIGN:   LDA   FACCUM+3   
002B   B7                     ORA   A   
002C   C2 E8 09               JNZ   FTestSign_tail   
002F   C9                     RET      
0030   E3           PUSHNEXTWORD:   XTHL      
0031   22 3B 00               SHLD   L003A+1   
0034   E1                     POP   H   
0035   4E                     MOV   C,M   
0036   23                     INX   H   
0037   46                     MOV   B,M   
0038   23                     INX   H   
0039   C5                     PUSH   B   
003A   C3 3A 00     L003A:    JMP   L003A   
003D   F2 09        KW_INLINE_FNS:   DW   Sgn   
003F   B0 0A                  DW   Int   
0041   06 0A                  DW   Abs   
0043   A6 04                  DW   FunctionCallError   
0045   2F 0C                  DW   Sqr   
0047   6D 0C                  DW   Rnd   
0049   A3 0C                  DW   Sin   
004B   79           KW_ARITH_OP_FNS:   DB   79h   
004C   1E 08                  DW   FAdd   ;+
004E   79                     DB   79h   
004F   18 08                  DW   FSub   ;-
0051   7C                     DB   7Ch   
0052   F1 08                  DW   FMul   ;*
0054   7C                     DB   7Ch   
0055   3D 09                  DW   FDiv   ;/
0057   45 4E C4     KEYWORDS:   DB   45h,4Eh,0C4h   ; "END"	80
005A   46 4F D2               DB   46h,4Fh,0D2h   ; "FOR"
005D   4E 45 58 D4            DB   4Eh,45h,58h,0D4h   ; "NEXT"	82
0061   44 41 54 C1            DB   44h,41h,54h,0C1h   ; "DATA"	83
0065   49 4E 50 55 D4         DB   49h,4Eh,50h,55h,0D4h   ; "INPUT"	84
006A   44 49 CD               DB   44h,49h,0CDh   ; "DIM"	85
006D   52 45 41 C4            DB   52h,45h,41h,0C4h   ; "READ"	86
0071   4C 45 D4               DB   4Ch,45h,0D4h   ; "LET"	87
0074   47 4F 54 CF            DB   47h,4Fh,54h,0CFh   ; "GOTO"	88
0078   52 55 CE               DB   52h,55h,0CEh   ; "RUN"	89
007B   49 C6                  DB   49h,0C6h   ; "IF"	8A	; Ifl
007D   52 45 53 54 4F 52 C5   DB   52h,45h,53h,54h,4Fh,52h,0C5h   ; "RESTORE"	8B
0084   47 4F 53 55 C2         DB   47h,4Fh,53h,55h,0C2h   ; "GOSUB"	8C
0089   52 45 54 55 52 CE      DB   52h,45h,54h,55h,52h,0CEh   ; "RETURN"	8D
008F   52 45 CD               DB   52h,45h,0CDh   ; "REM"	8E
0092   53 54 4F D0            DB   53h,54h,4Fh,0D0h   ; "STOP"	8F
0096   50 52 49 4E D4         DB   50h,52h,49h,4Eh,0D4h   ; "PRINT"	90
009B   4C 49 53 D4            DB   4Ch,49h,53h,0D4h   ; "LIST"	91
009F   43 4C 45 41 D2         DB   43h,4Ch,45h,41h,0D2h   ; "CLEAR"	92
00A4   4E 45 D7               DB   4Eh,45h,0D7h   ; "NEW"	93
00A7                             ; 
00A7   54 41 42 A8            DB   54h,41h,42h,0A8h   ; "TAB("	94
00AB   54 CF                  DB   54h,0CFh   ; "TO"	95
00AD   54 48 45 CE            DB   54h,48h,45h,0CEh   ; "THEN"	96
00B1   53 54 45 D0            DB   53h,54h,45h,0D0h   ; "STEP"	97
00B5                             ; 
00B5   AB                     DB   0xAB   ; 	"+"	98
00B6   AD                     DB   0xAD   ; 	"-"	99
00B7   AA                     DB   0xAA   ; 	"*"	9A
00B8   AF                     DB   0xAF   ; 	"/"	9B
00B9   BE                     DB   0xBE   ; 	">"	9C
00BA   BD                     DB   0xBD   ; 	"="	9D
00BB   BC                     DB   0xBC   ; 	"<"	9E
00BC                             ; 
00BC   53 47 CE               DB   53h,47h,0CEh   ; 	"SGN"	9F
00BF   49 4E D4               DB   49h,4Eh,0D4h   ; 	"INT"	A0
00C2   41 42 D3               DB   41h,42h,0D3h   ; 	"ABS"	A1
00C5   55 53 D2               DB   55h,53h,0D2h   ; 	"USR"	A2
00C8   53 51 D2               DB   53h,51h,0D2h   ; 	"SQR"	A3
00CB   52 4E C4               DB   52h,4Eh,0C4h   ; 	"RND"	A4
00CE   53 49 CE               DB   53h,49h,0CEh   ; 	"SIN"	A5
00D1                             ; 
00D1   00                     DB   0x00   ; 	 	
00D2                             ; 
00D2   F7 01        KW_GENERAL_FNS:   DW   Stop   ;END
00D4   DF 03                  DW   For   ;FOR
00D6   57 06                  DW   Next   ;NEXT
00D8   03 05                  DW   FindNextStatement   ;DATA
00DA   F2 05                  DW   Input   ;INPUT
00DC   24 07                  DW   Dim   ;DIM
00DE   04 06                  DW   Read   ;READ
00E0   10 05                  DW   Let   ;LET
00E2   DD 04                  DW   Goto   ;GOTO
00E4   A1 02                  DW   Run   ;RUN
00E6   24 05                  DW   Ifl   ;IF
00E8   73 04                  DW   Restore   ;RESTORE
00EA   CC 04                  DW   Gosub   ;GOSUB
00EC   ED 04                  DW   Return   ;RETURN
00EE   05 05                  DW   Rem   ;REM
00F0   F7 01                  DW   Stop   ;STOP
00F2   65 05                  DW   Print   ;PRINT
00F4   98 03                  DW   List   ;LIST
00F6   A6 02                  DW   Clear   ;CLEAR
00F8   95 02                  DW   New   ;NEW
00FA   4E C6        ERROR_CODES:   DB   4Eh,0C6h   ;"NF"	NEXT without FOR.
00FC   53 CE                  DB   53h,0CEh   ;"SN"	Syntax Error
00FE   52 C7                  DB   52h,0C7h   ;"RG"	RETURN without GOSUB.
0100   4F C4                  DB   4Fh,0C4h   ;"OD"	Out of Data
0102   46 C3                  DB   46h,0C3h   ;"FC"	Illegal Function Call
0104   4F D6                  DB   4Fh,0D6h   ;"OV"	Overflow.
0106   4F CD                  DB   4Fh,0CDh   ;"OM"	Out of memory.
0108   55 D3                  DB   55h,0D3h   ;"US"	Undefined Subroutine
010A   42 D3                  DB   42h,0D3h   ;"BS"	Bad Subscript
010C   44 C4                  DB   44h,0C4h   ;"DD"	Duplicate Definition
010E   2F B0                  DB   2Fh,0B0h   ;"\0"	Division by zero.
0110   49 C4                  DB   49h,0C4h   ;"ID"	Invalid in Direct mode.
0112   2C                     DB   ","   ; 
0113   00 00 00 00 00 00 00 00 LINE_BUFFER:   DW   0000,0000,0000,0000h   ;72 chars
011B   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
0123   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
012B   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
0133   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
013B   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
0143   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
014B   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ; 
0153   00 00 00 00 00 00 00 00 DW   0000,0000,0000,0000h   ;		
015B   00           DIM_OR_EVAL:   DB   00h   ; 
015C   00           INPUT_OR_READ:   DB   00h   ; 
015D   00 00        PROG_PTR_TEMP:   DW   0000h   ; 
015F   00 00        L015F:    DW   0000h   ; 
0161   00 00        CURRENT_LINE:   DW   0000h   ; 
0163   1A 0F        STACK_TOP:   DW   STK_TOP   ; RELOCATE***
0165   00 00        PROGRAM_BASE:   DW   0000h   ; 
0167   00 00        VAR_BASE:   DW   0000h   ; 
0169   00 00        VAR_ARRAY_BASE:   DW   0000h   ; 
016B   00 00        VAR_TOP:   DW   0000h   ; 
016D   00 00        DATA_PROG_PTR:   DW   0000h   ; 
016F   00 00 00 00  FACCUM:   DB   00,00,00,00h   ; 
0173   00           FTEMP:    DB   00h   ; 
0174   00 00 00 00 00 00 FBUFFER:   DW   0000,0000,0000   
017A   00 00 00 00 00 00      DW   0000,0000,0000   
0180   00                     DB   00   ; 
0181   20 45 52 52 4F D2 00 SZERROR:   DB   0x20,0x45,0x52,0x52,0x4F,0xD2,0x00   ;" ERROR\0"	
0188   20 49 4E A0 00 SZIN:   DB   0x20,0x49,0x4E,0xA0,0x00   ;" IN \0"
018D   0D 4F CB 0D 00 SZOK:   DB   0x0D,0x4F,0xCB,0x0D,0x00   ;"\rOK\r\0"	
0192   21 04 00     GETFLOWPTR:   LXI   H,0004h   ;HL=SP+4 (ie get word
0195   39                     DAD   SP   ;just past return addr)
0196   7E                     MOV   A,M   ; 
0197   23                     INX   H   ; 
0198   FE 81                  CPI   0x81   ;"FOR"?
019A   C0                     RNZ      ;Return if not "FOR"
019B   F7                     RST   6   ; RST PushNextWord	;PUSH (HL)
019C   E3                     XTHL      ;POP HL (ie HL=(HL))
019D   E7                     RST   4   ; RST CompareHLDE	;HL==DE?
019E   01 0D 00               LXI   B,000Dh   ; 
01A1   E1                     POP   H   ;Restore HL
01A2   C8                     RZ      ;Return if var ptrs match.
01A3   09                     DAD   B   ;HL+=000D
01A4   C3 96 01               JMP   GetFlowPtr+4   ;Loop
01A7   CD C3 01     COPYMEMORYUP:   CALL   CheckEnoughMem   ; 
01AA   C5                     PUSH   B   ;Exchange BC with HL.
01AB   E3                     XTHL      ; 
01AC   C1                     POP   B   ; 
01AD   E7           COPYMEMLOOP:   RST   4   ;HL==DE?
01AE   7E                     MOV   A,M   ; 
01AF   02                     STAX   B   ; 
01B0   C8                     RZ      ;Exit if DE reached.
01B1   0B                     DCX   B   ; 
01B2   2B                     DCX   H   ; 
01B3   C3 AD 01               JMP   CopyMemLoop   ; 
01B6   E5           CHECKENOUGHVARSPACE:   PUSH   H   ; 
01B7   2A 6B 01               LHLD   VAR_TOP   ; 
01BA   06 00                  MVI   B,00h   ;BC=C*4
01BC   09                     DAD   B   ; 
01BD   09                     DAD   B   ; 
01BE   CD C3 01               CALL   CheckEnoughMem   ; 
01C1   E1                     POP   H   ; 
01C2   C9                     RET      ; 
01C3   D5           CHECKENOUGHMEM:   PUSH   D   ; 
01C4   EB                     XCHG      ; 
01C5   21 DE FF               LXI   H,0xFFDE   ;HL=-34 (extra 2 bytes for return address)
01C8   39                     DAD   SP   ; 
01C9   E7                     RST   4   ; 
01CA   EB                     XCHG      ; 
01CB   D1                     POP   D   ; 
01CC   D0                     RNC      ; 
01CD   1E 0C        OUTOFMEMORY:   MVI   E,0Ch   ; 
01CF   01                     DB   01   ;LXI B,....	;
01D0   1E 02        SYNTAXERROR:   MVI   E,02h   ; 
01D2   01                     DB   01   ;LXI B,....	;
01D3   1E 14        DIVIDEBYZERO:   MVI   E,14h   ; 
01D5   CD B5 02     ERROR:    CALL   ResetStack   ; 
01D8   CD 98 05               CALL   NewLine   ; 
01DB   21 FA 00               LXI   H,ERROR_CODES   ; 
01DE   57                     MOV   D,A   ; 
01DF   3E 3F                  MVI   A,"?"   ;Print "?"
01E1   DF                     RST   03   ;RST OutChar	;
01E2   19                     DAD   D   ;HL points to error code.
01E3   7E                     MOV   A,M   ; 
01E4   DF                     RST   03   ;RST OutChar 11 011 111	;Print first char of code.
01E5   D7                     RST   02   ;RST NextChar 11 010 111	;
01E6   DF                     RST   03   ;RST OutChar	;Print second char of code.
01E7   21 81 01               LXI   H,szError   ;Print " ERROR".
01EA   CD B1 05               CALL   PrintString   ; 
01ED   2A 61 01               LHLD   CURRENT_LINE   ; 
01F0   7C                     MOV   A,H   ; 
01F1   A5                     ANA   L   ; 
01F2   3C                     INR   A   ; 
01F3   C4 3D 0B               CNZ   PrintIN   ; 
01F6   01                     DB   01   ;LXI B,....	;LXI over Stop and fall into Main
01F7   C0           STOP:     RNZ      ;Syntax Error if args.
01F8   C1                     POP   B   ;Lose return address.
01F9   21 8D 01     MAIN:     LXI   H,szOK   ; 
01FC   CD 2F 0D               CALL   Init   ; 
01FF   21 FF FF     GETNONBLANKLINE:   LXI   H,0xFFFF   ; 
0202   22 61 01               SHLD   CURRENT_LINE   ; 
0205   CD 3C 03               CALL   InputLine   ; 
0208   D7                     RST   02   ;RST NextChar	;
0209   3C                     INR   A   ; 
020A   3D                     DCR   A   ; 
020B   CA FF 01               JZ   GetNonBlankLine   ; 
020E   F5                     PUSH   PSW   
020F   CD AB 04               CALL   LineNumberFromStr   
0212   D5                     PUSH   D   
0213   CD CC 02               CALL   Tokenize   
0216   47                     MOV   B,A   
0217   D1                     POP   D   
0218   F1                     POP   PSW   
0219   D2 48 04               JNC   Exec   
021C   D5           STOREPROGRAMLINE:   PUSH   D   ;Push line number
021D   C5                     PUSH   B   ;Push line length
021E   D7                     RST   02   ;RST NextChar	;Get first char of line
021F   B7                     ORA   A   ;Zero set if line is empty (ie removing a line)
0220   F5                     PUSH   PSW   ;Preserve line-empty flag
0221   CD 7D 02               CALL   FindProgramLine   ;Get nearest program line address in BC.
0224   C5                     PUSH   B   ;Push line address.
0225   D2 39 02               JNC   InsertProgramLine   ;If line doesn't exist, jump ahead to insert it.
0228   EB           REMOVEPROGRAMLINE:   XCHG      ;DE=Next line address.
0229   2A 67 01               LHLD   VAR_BASE   ; 
022C   1A           REMOVELINE:   LDAX   D   ;Move byte of program remainder down
022D   02                     STAX   B   ;in memory.
022E   03                     INX   B   ; 
022F   13                     INX   D   ; 
0230   E7                     RST   4   ;Loop until DE==VAR_BASE, ie whole
0231   C2 2C 02               JNZ   RemoveLine   ;program remainder done.
0234   60                     MOV   H,B   ; 
0235   69                     MOV   L,C   ;Update VAR_BASE from BC.
0236   22 67 01               SHLD   VAR_BASE   ; 
0239   D1           INSERTPROGRAMLINE:   POP   D   ;DE=Line address (from 224)
023A   F1                     POP   PSW   ;Restore line-empty flag (see above)
023B   CA 60 02               JZ   UpdateLinkedList   ;If line is empty, then we don't need to insert it so can jump ahead.
023E   2A 67 01               LHLD   VAR_BASE   ; 
0241   E3                     XTHL      ;HL = Line length (see 21D)
0242   C1                     POP   B   ;BC = VAR_BASE
0243   09                     DAD   B   ;HL = VAR_BASE + line length.
0244   E5                     PUSH   H   ; 
0245   CD A7 01               CALL   CopyMemoryUp   ;Move remainder of program so there's enough space for the new line.
0248   E1                     POP   H   ; 
0249   22 67 01               SHLD   VAR_BASE   ;Update VAR_BASE
024C   EB                     XCHG      ;HL=Line address, DE=VAR_BASE
024D   74                     MOV   M,H   ;???
024E   23                     INX   H   ;Skip over next line ptr (updated below)
024F   23                     INX   H   ; 
0250   D1                     POP   D   ;DE = line number (see 21C)
0251   73                     MOV   M,E   ;Write line number to program line memory.
0252   23                     INX   H   ; 
0253   72                     MOV   M,D   ; 
0254   23                     INX   H   ; 
0255   11 13 01     COPYFROMBUFFER:   LXI   D,LINE_BUFFER   ;Copy the line into the program.
0258   1A                     LDAX   D   ; 
0259   77                     MOV   M,A   ; 
025A   23                     INX   H   ; 
025B   13                     INX   D   ; 
025C   B7                     ORA   A   ; 
025D   C2 58 02               JNZ   CopyFromBuffer+3   ; 
0260   CD A2 02     UPDATELINKEDLIST:   CALL   ResetAll   ; 
0263   23                     INX   H   ; 
0264   EB                     XCHG      ; 
0265   62           L0265:    MOV   H,D   ; 
0266   6B                     MOV   L,E   ; 
0267   7E                     MOV   A,M   ;If the pointer to the next line is a null
0268   23                     INX   H   ;word then we've reached the end of the
0269   B6                     ORA   M   ;program, job is done, and we can jump back
026A   CA FF 01               JZ   GetNonBlankLine   ;to let the user type in the next line.
026D   23                     INX   H   ;Skip over line number.
026E   23                     INX   H   ; 
026F   23                     INX   H   ; 
0270   AF                     XRA   A   ; 
0271   BE           L0271:    CMP   M   ; 
0272   23                     INX   H   ; 
0273   C2 71 02               JNZ   L0271   ; 
0276   EB                     XCHG      ; 
0277   73                     MOV   M,E   ; 
0278   23                     INX   H   ; 
0279   72                     MOV   M,D   ; 
027A   C3 65 02               JMP   L0265   ; 
027D   2A 65 01     FINDPROGRAMLINE:   LHLD   PROGRAM_BASE   ; 
0280   44                     MOV   B,H   ;BC=this line
0281   4D                     MOV   C,L   ; 
0282   7E                     MOV   A,M   ;If we've found two consecutive
0283   23                     INX   H   ;null bytes, then we've reached the end
0284   B6                     ORA   M   ;of the program and so return.
0285   2B                     DCX   H   ; 
0286   C8                     RZ      ; 
0287   C5                     PUSH   B   ;Push this line address
0288   F7                     RST   6   ;Push (next line address)
0289   F7                     RST   6   ;Push (this line number)
028A   E1                     POP   H   ;HL = this line number
028B   E7                     RST   4   ;Compare line numbers
028C   E1                     POP   H   ;HL = next line address
028D   C1                     POP   B   ;BC = this line address
028E   3F                     CMC      ; 
028F   C8                     RZ      ;Return carry set if line numbers match.
0290   3F                     CMC      ; 
0291   D0                     RNC      ;Return if we've reached a line number greater than the one required.
0292   C3 80 02               JMP   FindProgramLine+3   
0295   C0           NEW:      RNZ      
0296   2A 65 01               LHLD   PROGRAM_BASE   
0299   AF                     XRA   A   
029A   77                     MOV   M,A   
029B   23                     INX   H   
029C   77                     MOV   M,A   
029D   23                     INX   H   
029E   22 67 01               SHLD   VAR_BASE   
02A1   C0           RUN:      RNZ      
02A2   2A 65 01     RESETALL:   LHLD   PROGRAM_BASE   
02A5   2B                     DCX   H   
02A6   22 5D 01     CLEAR:    SHLD   PROG_PTR_TEMP   
02A9   CD 73 04               CALL   Restore   
02AC   2A 67 01               LHLD   VAR_BASE   
02AF   22 69 01               SHLD   VAR_ARRAY_BASE   
02B2   22 6B 01               SHLD   VAR_TOP   
02B5   C1           RESETSTACK:   POP   B   
02B6   2A 63 01               LHLD   STACK_TOP   
02B9   F9                     SPHL      
02BA   AF                     XRA   A   
02BB   6F                     MOV   L,A   
02BC   E5                     PUSH   H   
02BD   C5                     PUSH   B   
02BE   2A 5D 01               LHLD   PROG_PTR_TEMP   
02C1   C9                     RET      
02C2   3E 3F        INPUTLINEWITH:   MVI   A,"?"   ;Print "?"
02C4   DF                     RST   03   ;RST OutChar	;
02C5   3E 20                  MVI   A," "   ;Print " "
02C7   DF                     RST   03   ;RST OutChar	;
02C8   CD 3C 03               CALL   InputLine   ; 
02CB   23                     INX   H   ; 
02CC   0E 05        TOKENIZE:   MVI   C,05   ;Initialise line length to 5.
02CE   11 13 01               LXI   D,LINE_BUFFER   ;ie, output ptr is same as input ptr at start.
02D1   7E                     MOV   A,M   ; 
02D2   FE 20                  CPI   " "   ; 
02D4   CA 02 03               JZ   WriteChar   ; 
02D7   47                     MOV   B,A   ; 
02D8   FE 22                  CPI   0x22   ;"""	;
02DA   CA 15 03               JZ   FreeCopy   ; 
02DD   B7                     ORA   A   ; 
02DE   CA 29 03               JZ   Exit   ; 
02E1   D5                     PUSH   D   ;Preserve output ptr.
02E2   06 00                  MVI   B,00   ;Initialise Keyword ID to 0.
02E4   11 56 00               LXI   D,KEYWORDS-1   ; 
02E7   E5                     PUSH   H   ;Preserve input ptr.
02E8   3E                     DB   3Eh   ;LXI over get-next-char
02E9   D7           KWCOMPARE:   RST   02   ; RST 01	; SyntaxCheck0	;Get next input char
02EA   13                     INX   D   ; 
02EB   1A                     LDAX   D   ;Get keyword char to compare with.
02EC   E6 7F                  ANI   7Fh   ;Ignore bit 7 of keyword char.
02EE   CA FF 02               JZ   NotAKeyword   ;If keyword char==0, then end of keywords reached.
02F1   BE                     CMP   M   ;Keyword char matches input char?
02F2   C2 1C 03               JNZ   NextKeyword   ;If not, jump to get next keyword.
02F5   1A                     LDAX   D   ; 
02F6   B7                     ORA   A   ; 
02F7   F2 E9 02               JP   KwCompare   ; 
02FA   F1                     POP   PSW   ;Remove input ptr from stack. We don't need it.
02FB   78                     MOV   A,B   ;A=Keyword ID
02FC   F6 80                  ORI   0x80   ;Set bit 7 (indicates a keyword)
02FE   F2                     DB   0xF2   ;JP ....	;LXI trick again.
02FF   E1           NOTAKEYWORD:   POP   H   ;Restore input ptr
0300   7E                     MOV   A,M   ;and get input char
0301   D1                     POP   D   ;Restore output ptr
0302   23           WRITECHAR:   INX   H   ;Advance input ptr
0303   12                     STAX   D   ;Store output char
0304   13                     INX   D   ;Advance output ptr
0305   0C                     INR   C   ;C++ (arf!).
0306   D6 8E                  SUI   8Eh   ;If it's not the
0308   C2 D1 02               JNZ   Tokenize+5   ; 
030B   47                     MOV   B,A   ;B=0
030C   7E           FREECOPYLOOP:   MOV   A,M   ;A=Input char
030D   B7                     ORA   A   ;If char is null then exit
030E   CA 29 03               JZ   Exit   ; 
0311   B8                     CMP   B   ;If input char is term char then
0312   CA 02 03               JZ   WriteChar   ;we're done free copying.
0315   23           FREECOPY:   INX   H   ; 
0316   12                     STAX   D   ; 
0317   0C                     INR   C   ; 
0318   13                     INX   D   ; 
0319   C3 0C 03               JMP   FreeCopyLoop   ; 
031C   E1           NEXTKEYWORD:   POP   H   ;Restore input ptr
031D   E5                     PUSH   H   ; 
031E   04                     INR   B   ;Keyword ID ++;
031F   EB                     XCHG      ;HL=keyword table ptr
0320   B6           NEXTKWLOOP:   ORA   M   ;Loop until
0321   23                     INX   H   ;bit 7 of previous
0322   F2 20 03               JP   NextKwLoop   ;keyword char is set.
0325   EB                     XCHG      ;DE=keyword ptr, HL=input ptr
0326   C3 EB 02               JMP   KwCompare+2   ; 
0329   21 12 01     EXIT:     LXI   H,LINE_BUFFER-1   ; 
032C   12                     STAX   D   ; 
032D   13                     INX   D   ; 
032E   12                     STAX   D   ; 
032F   13                     INX   D   ; 
0330   12                     STAX   D   ; 
0331   C9                     RET      ; 
0332   05           BACKSPACE:   DCR   B   ;Char count--;
0333   2B                     DCX   H   ;Input ptr--;
0334   DF                     RST   03   ;RST OutChar	;Print backspace char.
0335   C2 41 03               JNZ   InputNext   ; 
0338   DF           RESETINPUT:   RST   03   ;RST OutChar	;
0339   CD 98 05               CALL   NewLine   ; 
033C   21 13 01     INPUTLINE:   LXI   H,LINE_BUFFER   ; 
033F   06 01                  MVI   B,01   ; 
0341   CD 88 03     INPUTNEXT:   CALL   InputChar   ; 
0344   FE 0D                  CPI   0x0D   ; 
0346   CA 93 05               JZ   TerminateInput   ; 
0349   FE 20                  CPI   " "   ;If < " "
034B   DA 41 03               JC   InputNext   ;or
034E   FE 7D                  CPI   0x7D   ;> "}"
0350   D2 41 03               JNC   InputNext   ;then loop back.
0353   FE 40                  CPI   "@"   ; 
0355   CA 38 03               JZ   ResetInput   ; 
0358   FE 5F                  CPI   "_"   ; 
035A   CA 32 03               JZ   Backspace   ; 
035D   4F                     MOV   C,A   ; 
035E   78                     MOV   A,B   ; 
035F   FE 48                  CPI   0x48   ; 
0361   3E 07                  MVI   A,07   ; 
0363   D2 6A 03               JNC   L036A   ; 
0366   79                     MOV   A,C   ;Write char to LINE_BUFFER.
0367   71                     MOV   M,C   ; 
0368   23                     INX   H   ; 
0369   04                     INR   B   ; 
036A   DF           L036A:    RST   03   ;RST OutChar	;
036B   C3 41 03               JMP   InputNext   ; 
036E   FE 48        OUTCHAR_TAIL:   CPI   0x48   ; 
0370   CC 98 05               CZ   NewLine   ; 
0373   3C                     INR   A   ; 
0374   32 27 00               STA   TERMINAL_X   ; 
0377   3E 00        WAITTERMREADY:   MVI   A,0   
0379   D3 19                  OUT   UART_TX_STATUS   ; select RR0
037B   DB 19                  IN   UART_TX_STATUS   ; in a,(UART_TX_STATUS)	; status register of serial port
037D   E6 04                  ANI   UART_TX_EMPTY   ; and UART_TX_EMPTY		; wait for tx buffer empty
037F   CA 77 03               JZ   WaitTermReady   ; 
0382   F1                     POP   PSW   ; pop AF			; get byte to be sent
0383   E6 7F                  ANI   7Fh   ; and 7fh			; strip MSB
0385   D3 18                  OUT   UART_TX   ; out (UART_TX),a		; serial port TX buffer
0387   C9                     RET      ; 
0388   3E 00        INPUTCHAR:   MVI   A,0   
038A   D3 19                  OUT   UART_RX_STATUS   ; select RR0
038C   DB 19                  IN   UART_RX_STATUS   ; in a,(UART_RX_STATUS)	; status register of serial port
038E   E6 01                  ANI   UART_RX_FULL   ; and UART_RX_FULL	; wait for RX buffer full
0390   CA 88 03               JZ   InputChar   ; 
0393   DB 18                  IN   UART_RX   ; in a,(UART_RX)	; fetch received char
0395   E6 7F                  ANI   7Fh   ; and 7fh			; strip MSB
0397   C9                     RET      ; 
0398   CD AB 04     LIST:     CALL   LineNumberFromStr   
039B   C0                     RNZ      
039C   C1                     POP   B   ;?why get return address?
039D   CD 7D 02               CALL   FindProgramLine   
03A0   C5                     PUSH   B   
03A1   E1           LISTNEXTLINE:   POP   H   
03A2   F7                     RST   6   
03A3   C1                     POP   B   
03A4   78                     MOV   A,B   
03A5   B1                     ORA   C   
03A6   CA F9 01               JZ   Main   
03A9   CD 7D 04               CALL   TestBreakKey   
03AC   C5                     PUSH   B   
03AD   CD 98 05               CALL   NewLine   
03B0   F7                     RST   6   
03B1   E3                     XTHL      
03B2   CD 45 0B               CALL   PrintInt   
03B5   3E 20                  MVI   A," "   
03B7   E1                     POP   H   
03B8   DF           LISTCHAR:   RST   03   ;RST OutChar	
03B9   7E                     MOV   A,M   
03BA   B7                     ORA   A   
03BB   23                     INX   H   
03BC   CA A1 03               JZ   ListNextLine   
03BF   F2 B8 03               JP   ListChar   
03C2   D6 7F                  SUI   7Fh   ;A is now keyword index + 1.
03C4   4F                     MOV   C,A   
03C5   E5                     PUSH   H   
03C6   11 57 00               LXI   D,KEYWORDS   
03C9   D5                     PUSH   D   
03CA   1A           TONEXTKEYWORD:   LDAX   D   
03CB   13                     INX   D   
03CC   B7                     ORA   A   
03CD   F2 CA 03               JP   ToNextKeyword   
03D0   0D                     DCR   C   
03D1   E1                     POP   H   
03D2   C2 C9 03               JNZ   ToNextKeyword-1   
03D5   7E           PRINTKEYWORD:   MOV   A,M   
03D6   B7                     ORA   A   
03D7   FA B7 03               JM   ListChar-1   
03DA   DF                     RST   03   ;RST OutChar	
03DB   23                     INX   H   
03DC   C3 D5 03               JMP   PrintKeyword   
03DF   CD 10 05     FOR:      CALL   Let   
03E2   E3                     XTHL      
03E3   CD 92 01               CALL   GetFlowPtr   
03E6   D1                     POP   D   
03E7   C2 EC 03               JNZ   L03E2   
03EA   09                     DAD   B   
03EB   F9                     SPHL      
03EC   EB           L03E2:    XCHG      
03ED   0E 08                  MVI   C,08   
03EF   CD B6 01               CALL   CheckEnoughVarSpace   
03F2   E5                     PUSH   H   
03F3   CD 03 05               CALL   FindNextStatement   
03F6   E3                     XTHL      
03F7   E5                     PUSH   H   
03F8   2A 61 01               LHLD   CURRENT_LINE   
03FB   E3                     XTHL      
03FC   CF                     RST   01   ; SyntaxCheck; SyntaxCheck	
03FD   95                     DB   95h   ;KWID_TO	
03FE   CD 98 06               CALL   EvalExpression   
0401   E5                     PUSH   H   
0402   CD 2B 0A               CALL   FCopyToBCDE   
0405   E1                     POP   H   
0406   C5                     PUSH   B   
0407   D5                     PUSH   D   
0408   01 00 81               LXI   B,8100h   
040B   51                     MOV   D,C   
040C   5A                     MOV   E,D   
040D   7E                     MOV   A,M   
040E   FE 97                  CPI   0x97   ;KWID_STEP	
0410   3E 01                  MVI   A,01h   
0412   C2 1E 04               JNZ   PushStepValue   
0415   CD 99 06               CALL   EvalExpression+1   
0418   E5                     PUSH   H   
0419   CD 2B 0A               CALL   FCopyToBCDE   
041C   EF                     RST   05   ; FTestSign	
041D   E1                     POP   H   
041E   C5           PUSHSTEPVALUE:   PUSH   B   
041F   D5                     PUSH   D   
0420   F5                     PUSH   PSW   
0421   33                     INX   SP   
0422   E5                     PUSH   H   
0423   2A 5D 01               LHLD   PROG_PTR_TEMP   
0426   E3                     XTHL      
0427   06 81        ENDOFFORHANDLER:   MVI   B,0x81   
0429   C5                     PUSH   B   
042A   33                     INX   SP   
042B   CD 7D 04     EXECNEXT:   CALL   TestBreakKey   
042E   7E                     MOV   A,M   
042F   FE 3A                  CPI   ":"   
0431   CA 48 04               JZ   Exec   
0434   B7                     ORA   A   
0435   C2 D0 01               JNZ   SyntaxError   
0438   23                     INX   H   
0439   7E                     MOV   A,M   
043A   23                     INX   H   
043B   B6                     ORA   M   
043C   23                     INX   H   
043D   CA F9 01               JZ   Main   
0440   5E                     MOV   E,M   
0441   23                     INX   H   
0442   56                     MOV   D,M   
0443   EB                     XCHG      
0444   22 61 01               SHLD   CURRENT_LINE   
0447   EB                     XCHG      
0448   D7           EXEC:     RST   02   ;RST NextChar	
0449   11 2B 04               LXI   D,ExecNext   
044C   D5                     PUSH   D   
044D   C8                     RZ      
044E   D6 80                  SUI   80h   
0450   DA 10 05               JC   Let   
0453   FE 14                  CPI   0x14   
0455   D2 D0 01               JNC   SyntaxError   
0458   07                     RLC      ;BC = A*2
0459   4F                     MOV   C,A   
045A   06 00                  MVI   B,00h   
045C   EB                     XCHG      
045D   21 D2 00               LXI   H,KW_GENERAL_FNS   
0460   09                     DAD   B   
0461   4E                     MOV   C,M   
0462   23                     INX   H   
0463   46                     MOV   B,M   
0464   C5                     PUSH   B   
0465   EB                     XCHG      
0466   D7                     RST   02   ;RST NextChar	
0467   C9                     RET      
0468   FE 20        NEXTCHAR_TAIL:   CPI   " "   
046A   CA 10 00               JZ   NextChar   
046D   FE 30                  CPI   "0"   
046F   3F                     CMC      
0470   3C                     INR   A   
0471   3D                     DCR   A   
0472   C9                     RET      
0473   EB           RESTORE:   XCHG      
0474   2A 65 01               LHLD   PROGRAM_BASE   
0477   2B                     DCX   H   
0478   22 6D 01     L046E:    SHLD   DATA_PROG_PTR   
047B   EB                     XCHG      
047C   C9                     RET      
047D   3E 00        TESTBREAKKEY:   MVI   A,0   
047F   D3 19                  OUT   UART_RX_STATUS   ; select RR0
0481   DB 19                  IN   UART_RX_STATUS   ; in a,(00)		; status register of serial port
0483   E6 01                  ANI   UART_RX_FULL   ; and 1			; wait for RX buffer full
0485   C8                     RZ      ;Exit if no key pressed.
0486   CD 88 03               CALL   InputChar   ; 
0489   FE 03                  CPI   0x03   ;Break key?
048B   C3 F7 01               JMP   Stop   
048E   7E           CHARISALPHA:   MOV   A,M   
048F   FE 41                  CPI   "A"   
0491   D8                     RC      
0492   FE 5B                  CPI   "Z"+1   
0494   3F                     CMC      
0495   C9                     RET      
0496   D7           GETSUBSCRIPT:   RST   02   ;RST NextChar	
0497   CD 98 06               CALL   EvalExpression   
049A   EF                     RST   05   ; FTestSign	
049B   FA A6 04               JM   FunctionCallError   
049E   3A 72 01               LDA   FACCUM+3   
04A1   FE 90                  CPI   0x90   
04A3   DA 85 0A               JC   FAsInteger   
04A6   1E 08        FUNCTIONCALLERROR:   MVI   E,08h   
04A8   C3 D5 01               JMP   Error   
04AB   2B           LINENUMBERFROMSTR:   DCX   H   
04AC   11 00 00               LXI   D,0000   
04AF   D7           NEXTLINENUMCHAR:   RST   02   ;RST NextChar	
04B0   D0                     RNC      
04B1   E5                     PUSH   H   
04B2   F5                     PUSH   PSW   ;Preserve flags
04B3   21 98 19               LXI   H,1998h   ;Decimal 6552
04B6   E7                     RST   4   
04B7   DA D0 01               JC   SyntaxError   
04BA   62                     MOV   H,D   
04BB   6B                     MOV   L,E   
04BC   19                     DAD   D   
04BD   29                     DAD   H   
04BE   19                     DAD   D   
04BF   29                     DAD   H   
04C0   F1                     POP   PSW   
04C1   D6 30                  SUI   "0"   
04C3   5F                     MOV   E,A   
04C4   16 00                  MVI   D,00h   
04C6   19                     DAD   D   
04C7   EB                     XCHG      
04C8   E1                     POP   H   
04C9   C3 AF 04               JMP   NextLineNumChar   
04CC   0E 03        GOSUB:    MVI   C,03h   
04CE   CD B6 01               CALL   CheckEnoughVarSpace   
04D1   C1                     POP   B   
04D2   E5                     PUSH   H   
04D3   E5                     PUSH   H   
04D4   2A 61 01               LHLD   CURRENT_LINE   
04D7   E3                     XTHL      
04D8   16 8C                  MVI   D,0x8C   
04DA   D5                     PUSH   D   
04DB   33                     INX   SP   
04DC   C5                     PUSH   B   
04DD   CD AB 04     GOTO:     CALL   LineNumberFromStr   
04E0   C0                     RNZ      
04E1   CD 7D 02               CALL   FindProgramLine   
04E4   60                     MOV   H,B   
04E5   69                     MOV   L,C   
04E6   2B                     DCX   H   
04E7   D8                     RC      
04E8   1E 0E                  MVI   E,0Eh   
04EA   C3 D5 01               JMP   Error   
04ED   C0           RETURN:   RNZ      
04EE   16 FF                  MVI   D,0xFF   
04F0   CD 92 01               CALL   GetFlowPtr   
04F3   F9                     SPHL      
04F4   FE 8C                  CPI   0x8C   
04F6   1E 04                  MVI   E,04h   
04F8   C2 D5 01               JNZ   Error   
04FB   E1                     POP   H   
04FC   22 61 01               SHLD   CURRENT_LINE   
04FF   21 2B 04               LXI   H,ExecNext   
0502   E3                     XTHL      
0503   01 3A        FINDNEXTSTATEMENT:   DB   01h,3Ah   ;LXI B,..3A	
0505   10           REM:      DB   10h   
0506   00                     NOP      
0507   7E           FINDNEXTSTATEMENTLOOP:   MOV   A,M   
0508   B7                     ORA   A   
0509   C8                     RZ      
050A   B9                     CMP   C   
050B   C8                     RZ      
050C   23                     INX   H   
050D   C3 07 05               JMP   FindNextStatementLoop   
0510   CD 29 07     LET:      CALL   GetVar   
0513   CF                     RST   01   ; SyntaxCheck	
0514   9D                     DB   9Dh   
0515   D5           ASSIGNVAR:   PUSH   D   
0516   CD 98 06               CALL   EvalExpression   
0519   E3                     XTHL      
051A   22 5D 01               SHLD   PROG_PTR_TEMP   
051D   E5                     PUSH   H   
051E   CD 37 0A               CALL   FCopyToMem   
0521   D1                     POP   D   
0522   E1                     POP   H   
0523   C9                     RET      
0524   CD 98 06     IFL:      CALL   EvalExpression   
0527   7E                     MOV   A,M   
0528   CD 10 0A               CALL   FPush   
052B   16 00                  MVI   D,00   
052D   D6 9C        GETCOMPAREOPLOOP:   SUI   9Ch   ; KWID_>	
052F   DA 40 05               JC   GotCompareOp   
0532   FE 03                  CPI   0x03   
0534   D2 40 05               JNC   GotCompareOp   
0537   FE 01                  CPI   0x01   
0539   17                     RAL      
053A   B2                     ORA   D   
053B   57                     MOV   D,A   
053C   D7                     RST   02   ;RST NextChar	
053D   C3 2D 05               JMP   GetCompareOpLoop   
0540   7A           GOTCOMPAREOP:   MOV   A,D   
0541   B7                     ORA   A   
0542   CA D0 01               JZ   SyntaxError   
0545   F5                     PUSH   PSW   
0546   CD 98 06               CALL   EvalExpression   
0549   CF                     RST   01   ; SyntaxCheck	
054A   96                     DB   96h   ;KWID_THEN	
054B   2B                     DCX   H   
054C   F1                     POP   PSW   
054D   C1                     POP   B   
054E   D1                     POP   D   
054F   E5                     PUSH   H   
0550   F5                     PUSH   PSW   
0551   CD 5A 0A               CALL   FCompare   
0554   3C                     INR   A   
0555   17                     RAL      
0556   C1                     POP   B   
0557   A0                     ANA   B   
0558   E1                     POP   H   
0559   CA 05 05               JZ   Rem   
055C   D7                     RST   02   ;RST NextChar	
055D   DA DD 04               JC   Goto   
0560   C3 4D 04               JMP   Exec+5   
0563   2B                     DCX   H   
0564   D7                     RST   02   ;RST NextChar	
0565   CA 98 05     PRINT:    JZ   NewLine   
0568   C8                     RZ      
0569   FE 22                  CPI   0x22   ;"""	
056B   CC B0 05               CZ   PrintString-1   
056E   CA 63 05               JZ   Print-2   
0571   FE 94                  CPI   0x94   ;KWID_TAB	
0573   CA D5 05               JZ   Tab   
0576   E5                     PUSH   H   
0577   FE 2C                  CPI   ","   
0579   CA C1 05               JZ   ToNextTabBreak   
057C   FE 3B                  CPI   0x3B   ; ";"	
057E   CA ED 05               JZ   ExitTab   
0581   C1                     POP   B   
0582   CD 98 06               CALL   EvalExpression   
0585   E5                     PUSH   H   
0586   CD 50 0B               CALL   FOut   
0589   CD B1 05               CALL   PrintString   
058C   3E 20                  MVI   A," "   
058E   DF                     RST   03   ;RST OutChar	
058F   E1                     POP   H   
0590   C3 63 05               JMP   Print-2   
0593   36 00        TERMINATEINPUT:   MVI   M,00h   
0595   21 12 01               LXI   H,LINE_BUFFER-1   
0598   3E 0D        NEWLINE:   MVI   A,0Dh   
059A   32 27 00               STA   TERMINAL_X   
059D   DF                     RST   03   ;RST OutChar	
059E   3E 0A                  MVI   A,0Ah   
05A0   DF                     RST   03   ;RST OutChar	
05A1   3A 26 00               LDA   TERMINAL_Y   
05A4   3D           PRINTNULLLOOP:   DCR   A   
05A5   32 27 00               STA   TERMINAL_X   
05A8   C8                     RZ      
05A9   F5                     PUSH   PSW   
05AA   AF                     XRA   A   
05AB   DF                     RST   03   ;RST OutChar	
05AC   F1                     POP   PSW   
05AD   C3 A4 05               JMP   PrintNullLoop   
05B0   23                     INX   H   
05B1   7E           PRINTSTRING:   MOV   A,M   
05B2   B7                     ORA   A   
05B3   C8                     RZ      
05B4   23                     INX   H   
05B5   FE 22                  CPI   0x22   ;"""	
05B7   C8                     RZ      
05B8   DF                     RST   03   ;RST OutChar	
05B9   FE 0D                  CPI   0x0D   
05BB   CC 98 05               CZ   NewLine   
05BE   C3 B1 05               JMP   PrintString   
05C1   3A 27 00     TONEXTTABBREAK:   LDA   TERMINAL_X   
05C4   FE 38                  CPI   0x38   
05C6   D4 98 05               CNC   NewLine   
05C9   D2 ED 05               JNC   ExitTab   
05CC   D6 0E        CALCSPACECOUNT:   SUI   0Eh   
05CE   D2 CC 05               JNC   CalcSpaceCount   
05D1   2F                     CMA      
05D2   C3 E4 05               JMP   PrintSpaces   
05D5   CD 96 04     TAB:      CALL   GetSubscript   
05D8   CF                     RST   01   ; SyntaxCheck	
05D9   29                     DB   29h   ;")"	
05DA   2B                     DCX   H   
05DB   E5                     PUSH   H   
05DC   3A 27 00               LDA   TERMINAL_X   
05DF   2F                     CMA      
05E0   83                     ADD   E   
05E1   D2 ED 05               JNC   ExitTab   
05E4   3C           PRINTSPACES:   INR   A   
05E5   47                     MOV   B,A   
05E6   3E 20                  MVI   A," "   
05E8   DF           PRINTSPACELOOP:   RST   03   ;RST OutChar	
05E9   05                     DCR   B   
05EA   C2 E8 05               JNZ   PrintSpaceLoop   
05ED   E1           EXITTAB:   POP   H   
05EE   D7                     RST   02   ;RST NextChar	
05EF   C3 68 05               JMP   Print+3   
05F2   E5           INPUT:    PUSH   H   
05F3   2A 61 01               LHLD   CURRENT_LINE   
05F6   1E 16                  MVI   E,16h   
05F8   23                     INX   H   
05F9   7D                     MOV   A,L   
05FA   B4                     ORA   H   
05FB   CA D5 01               JZ   Error   
05FE   CD C2 02               CALL   InputLineWith   
0601   C3 09 06               JMP   L05FA+1   
0604   E5           READ:     PUSH   H   
0605   2A 6D 01               LHLD   DATA_PROG_PTR   
0608   F6 AF        L05FA:    ORI   0xAF   
060A                             ;XRA A	
060A   32 5C 01               STA   INPUT_OR_READ   
060D   E3                     XTHL      
060E   01                     DB   01   ;LXI B,....	
060F   CF           READNEXT:   RST   01   ; SyntaxCheck	
0610   2C                     DB   2Ch   ;","	
0611   CD 29 07               CALL   GetVar   
0614   E3                     XTHL      
0615   D5                     PUSH   D   
0616   7E                     MOV   A,M   
0617   FE 2C                  CPI   ","   
0619   CA 2E 06               JZ   GotDataItem   
061C   B7                     ORA   A   
061D   C2 D0 01               JNZ   SyntaxError   
0620   3A 5C 01               LDA   INPUT_OR_READ   
0623   B7                     ORA   A   
0624   23                     INX   H   
0625   C2 44 06               JNZ   NextDataLine+1   
0628   3E 3F                  MVI   A,"?"   
062A   DF                     RST   03   ;RST OutChar	
062B   CD C2 02               CALL   InputLineWith   
062E   D1           GOTDATAITEM:   POP   D   
062F   23                     INX   H   
0630   CD 15 05               CALL   AssignVar   
0633   E3                     XTHL      
0634   2B                     DCX   H   
0635   D7                     RST   02   ;RST NextChar	
0636   C2 0F 06               JNZ   ReadNext   
0639   D1                     POP   D   
063A   3A 5C 01               LDA   INPUT_OR_READ   
063D   B7                     ORA   A   
063E   C8                     RZ      
063F   EB                     XCHG      
0640   C2 78 04               JNZ   L046E   
0643   E1           NEXTDATALINE:   POP   H   
0644   F7                     RST   6   
0645   79                     MOV   A,C   
0646   B0                     ORA   B   
0647   1E 06                  MVI   E,06h   
0649   CA D5 01               JZ   Error   
064C   23                     INX   H   
064D   D7                     RST   02   ;RST NextChar	
064E   FE 83                  CPI   0x83   ;KWID_DATA	
0650   C2 43 06               JNZ   NextDataLine   
0653   C1                     POP   B   
0654   C3 2E 06               JMP   GotDataItem   
0657   CD 29 07     NEXT:     CALL   GetVar   
065A   22 5D 01               SHLD   PROG_PTR_TEMP   
065D   CD 92 01               CALL   GetFlowPtr   
0660   F9                     SPHL      
0661   D5                     PUSH   D   
0662   7E                     MOV   A,M   
0663   23                     INX   H   
0664   F5                     PUSH   PSW   
0665   D5                     PUSH   D   
0666   1E 00                  MVI   E,00h   
0668   C2 D5 01               JNZ   Error   
066B   CD 1D 0A               CALL   FLoadFromMem   
066E   E3                     XTHL      
066F   E5                     PUSH   H   
0670   CD 12 08               CALL   FAddMem   
0673   E1                     POP   H   
0674   CD 37 0A               CALL   FCopyToMem   
0677   E1                     POP   H   
0678   CD 2E 0A               CALL   FLoadBCDEfromMem   
067B   E5                     PUSH   H   
067C   CD 5A 0A               CALL   FCompare   
067F   E1                     POP   H   
0680   C1                     POP   B   
0681   90                     SUB   B   
0682   CD 2E 0A               CALL   FLoadBCDEfromMem   
0685   CA 91 06               JZ   ForLoopIsComplete   
0688   EB                     XCHG      
0689   22 61 01               SHLD   CURRENT_LINE   
068C   69                     MOV   L,C   
068D   60                     MOV   H,B   
068E   C3 27 04               JMP   EndOfForHandler   
0691   F9           FORLOOPISCOMPLETE:   SPHL      
0692   2A 5D 01               LHLD   PROG_PTR_TEMP   
0695   C3 2B 04               JMP   ExecNext   
0698   2B           EVALEXPRESSION:   DCX   H   
0699   16 00                  MVI   D,00h   
069B   D5                     PUSH   D   
069C   0E 01                  MVI   C,01h   
069E   CD B6 01               CALL   CheckEnoughVarSpace   
06A1   CD D2 06               CALL   EvalTerm   
06A4   22 5F 01               SHLD   L015F   
06A7   2A 5F 01     ARITHPARSE:   LHLD   L015F   
06AA   C1                     POP   B   
06AB   7E                     MOV   A,M   
06AC   16 00                  MVI   D,00h   
06AE   D6 98                  SUI   0x98   ;KWID_PLUS	
06B0   D8                     RC      
06B1   FE 04                  CPI   0x04   
06B3   D0                     RNC      
06B4   5F                     MOV   E,A   
06B5   07                     RLC      
06B6   83                     ADD   E   
06B7   5F                     MOV   E,A   
06B8   21 4B 00               LXI   H,KW_ARITH_OP_FNS   
06BB   19                     DAD   D   
06BC   78                     MOV   A,B   
06BD   56                     MOV   D,M   
06BE   BA                     CMP   D   
06BF   D0                     RNC      
06C0   23                     INX   H   
06C1   C5                     PUSH   B   
06C2   01 A7 06               LXI   B,ArithParse   
06C5   C5                     PUSH   B   
06C6   4A                     MOV   C,D   ;???
06C7   CD 10 0A               CALL   FPush   
06CA   51                     MOV   D,C   
06CB   F7                     RST   6   
06CC   2A 5F 01               LHLD   L015F   
06CF   C3 9B 06               JMP   EvalExpression+3   
06D2   D7           EVALTERM:   RST   02   ;RST NextChar	
06D3   DA C1 0A               JC   FIn   
06D6   CD 8E 04               CALL   CharIsAlpha   
06D9   D2 01 07               JNC   EvalVarTerm   
06DC   FE 98                  CPI   0x98   ;KWID_PLUS	
06DE   CA D2 06               JZ   EvalTerm   
06E1   FE 2E                  CPI   "."   
06E3   CA C1 0A               JZ   FIn   
06E6   FE 99                  CPI   0x99   ;KWID_MINUS	
06E8   CA F8 06               JZ   EvalMinusTerm   
06EB   D6 9F                  SUI   9Fh   
06ED   D2 0B 07               JNC   EvalInlineFn   
06F0   CF           EVALBRACKETED:   RST   01   ; SyntaxCheck	
06F1   28                     DB   28h   ;"("	
06F2   CD 98 06               CALL   EvalExpression   
06F5   CF                     RST   01   ; SyntaxCheck	
06F6   29                     DB   29h   ;")"	
06F7   C9                     RET      
06F8   CD D2 06     EVALMINUSTERM:   CALL   EvalTerm   
06FB   E5                     PUSH   H   
06FC   CD 08 0A               CALL   FNegate   
06FF   E1                     POP   H   
0700   C9                     RET      
0701   CD 29 07     EVALVARTERM:   CALL   GetVar   
0704   E5                     PUSH   H   
0705   EB                     XCHG      
0706   CD 1D 0A               CALL   FLoadFromMem   
0709   E1                     POP   H   
070A   C9                     RET      
070B   06 00        EVALINLINEFN:   MVI   B,00h   
070D   07                     RLC      
070E   4F                     MOV   C,A   
070F   C5                     PUSH   B   
0710   D7                     RST   02   ;RST NextChar	
0711   CD F0 06               CALL   EvalBracketed   
0714   E3                     XTHL      
0715   11 F1 06               LXI   D,06F1h   
0718   D5                     PUSH   D   
0719   01 3D 00               LXI   B,KW_INLINE_FNS   
071C   09                     DAD   B   
071D   F7                     RST   6   
071E   C9                     RET      
071F   2B           DIMCONTD:   DCX   H   
0720   D7                     RST   02   ;RST NextChar	
0721   C8                     RZ      
0722   CF                     RST   01   ; SyntaxCheck	
0723   2C                     DB   2Ch   ;","	
0724   01 1F 07     DIM:      LXI   B,DimContd   
0727   C5                     PUSH   B   
0728   F6                     DB   0xF6   
0729   AF           GETVAR:   XRA   A   
072A   32 5B 01               STA   DIM_OR_EVAL   
072D   46                     MOV   B,M   
072E   CD 8E 04               CALL   CharIsAlpha   
0731   DA D0 01               JC   SyntaxError   
0734   AF                     XRA   A   
0735   4F                     MOV   C,A   
0736   D7                     RST   02   ;RST NextChar	
0737   D2 2E 07               JNC   072Eh   
073A   4F                     MOV   C,A   
073B   D7                     RST   02   ;RST NextChar	
073C   D6 28                  SUI   "("   
073E   CA 98 07               JZ   GetArrayVar   
0741   E5                     PUSH   H   
0742   2A 69 01               LHLD   VAR_ARRAY_BASE   
0745   EB                     XCHG      
0746   2A 67 01               LHLD   VAR_BASE   
0749   E7           FINDVARLOOP:   RST   4   
074A   CA 60 07               JZ   AllocNewVar   
074D   79                     MOV   A,C   
074E   96                     SUB   M   
074F   23                     INX   H   
0750   C2 55 07               JNZ   L0747   
0753   78                     MOV   A,B   
0754   96                     SUB   M   
0755   23           L0747:    INX   H   
0756   CA 90 07               JZ   L0782   
0759   23                     INX   H   
075A   23                     INX   H   
075B   23                     INX   H   
075C   23                     INX   H   
075D   C3 49 07               JMP   FindVarLoop   
0760   E1           ALLOCNEWVAR:   POP   H   ;HL=prog ptr
0761   E3                     XTHL      ;(SP)=prog ptr, HL=ret.addr.
0762   D5                     PUSH   D   ; 
0763   11 F6 06               LXI   D,06F6h   ;an address inside EvalTerm
0766   E7                     RST   4   ; 
0767   D1                     POP   D   ; 
0768   CA 93 07               JZ   AlreadyAllocd   ; 
076B   E3                     XTHL      ;(SP)=ret.addr, HL=prog ptr.
076C   E5                     PUSH   H   ;Prog ptr back on stack
076D   C5                     PUSH   B   ;Preserve var name on stack
076E   01 06 00               LXI   B,0006h   
0771   2A 6B 01               LHLD   VAR_TOP   
0774   E5                     PUSH   H   
0775   09                     DAD   B   
0776   C1                     POP   B   
0777   E5                     PUSH   H   
0778   CD A7 01               CALL   CopyMemoryUp   
077B   E1                     POP   H   
077C   22 6B 01               SHLD   VAR_TOP   
077F   60                     MOV   H,B   
0780   69                     MOV   L,C   
0781   22 69 01               SHLD   VAR_ARRAY_BASE   
0784   2B           INITVARLOOP:   DCX   H   
0785   36 00                  MVI   M,00h   
0787   E7                     RST   4   
0788   C2 84 07               JNZ   InitVarLoop   
078B   D1                     POP   D   
078C   73                     MOV   M,E   
078D   23                     INX   H   
078E   72                     MOV   M,D   
078F   23                     INX   H   
0790   EB           L0782:    XCHG      
0791   E1                     POP   H   
0792   C9                     RET      
0793   32 72 01     ALREADYALLOCD:   STA   FACCUM+3   ;A was set to zero at 075A.
0796   E1                     POP   H   
0797   C9                     RET      
0798   C5           GETARRAYVAR:   PUSH   B   
0799   3A 5B 01               LDA   DIM_OR_EVAL   
079C   F5                     PUSH   PSW   
079D   CD 96 04               CALL   GetSubscript   
07A0   CF                     RST   01   ; SyntaxCheck	
07A1   29                     DB   29h   ;")"	
07A2   F1                     POP   PSW   
07A3   32 5B 01               STA   DIM_OR_EVAL   
07A6   E3                     XTHL      
07A7   EB                     XCHG      
07A8   29                     DAD   H   
07A9   29                     DAD   H   
07AA   E5                     PUSH   H   
07AB   2A 69 01               LHLD   VAR_ARRAY_BASE   
07AE   01                     DB   0x01   ;LXI B,....	
07AF   C1           FINDARRAY:   POP   B   
07B0   09                     DAD   B   
07B1   EB                     XCHG      
07B2   E5                     PUSH   H   
07B3   2A 6B 01               LHLD   VAR_TOP   
07B6   E7                     RST   4   
07B7   EB                     XCHG      
07B8   D1                     POP   D   
07B9   CA DB 07               JZ   AllocArray   
07BC   F7                     RST   6   
07BD   E3                     XTHL      
07BE   E7                     RST   4   
07BF   E1                     POP   H   
07C0   F7                     RST   6   
07C1   C2 AF 07               JNZ   FindArray   
07C4   3A 5B 01               LDA   DIM_OR_EVAL   
07C7   B7                     ORA   A   
07C8   1E 12                  MVI   E,12h   
07CA   C2 D5 01               JNZ   Error   
07CD   D1           L07BF:    POP   D   
07CE   1B                     DCX   D   
07CF   E3                     XTHL      
07D0   E7                     RST   4   
07D1   1E 10                  MVI   E,10h   
07D3   D2 D5 01               JNC   Error   
07D6   D1                     POP   D   
07D7   19                     DAD   D   
07D8   D1                     POP   D   
07D9   EB                     XCHG      
07DA   C9                     RET      
07DB   73           ALLOCARRAY:   MOV   M,E   
07DC   23                     INX   H   
07DD   72                     MOV   M,D   
07DE   23                     INX   H   
07DF   11 2C 00               LXI   D,002Ch   
07E2   3A 5B 01               LDA   DIM_OR_EVAL   
07E5   B7                     ORA   A   
07E6   CA EF 07               JZ   L07E1   
07E9   D1                     POP   D   
07EA   D5                     PUSH   D   
07EB   13                     INX   D   
07EC   13                     INX   D   
07ED   13                     INX   D   
07EE   13                     INX   D   
07EF   D5           L07E1:    PUSH   D   
07F0   73                     MOV   M,E   
07F1   23                     INX   H   
07F2   72                     MOV   M,D   
07F3   23                     INX   H   
07F4   E5                     PUSH   H   
07F5   19                     DAD   D   
07F6   CD C3 01               CALL   CheckEnoughMem   
07F9   22 6B 01               SHLD   VAR_TOP   
07FC   D1                     POP   D   
07FD   2B           INITELEMENTS:   DCX   H   
07FE   36 00                  MVI   M,00h   
0800   E7                     RST   4   
0801   C2 FD 07               JNZ   InitElements   
0804   C3 CD 07               JMP   L07BF   
0807   50           FWORDTOFLOAT:   MOV   D,B   
0808   1E 00                  MVI   E,00h   
080A   06 90                  MVI   B,90h   ;exponent=2^16
080C   C3 F8 09               JMP   FCharToFloat+5   ; 
080F   21 19 0C     FADDONEHALF:   LXI   H,ONE_HALF   ;Load BCDE with (float) 0.5.
0812   CD 2E 0A     FADDMEM:   CALL   FLoadBCDEfromMem   
0815   C3 20 08               JMP   FAdd+2   
0818   C1           FSUB:     POP   B   ;Get lhs in BCDE.
0819   D1                     POP   D   ; 
081A   CD 08 0A               CALL   FNegate   ;Negate rhs and slimily
081D   21                     DB   0x21   ;LXI H,....	;LXI into FAdd + 2.
081E   C1           FADD:     POP   B   ;Get lhs in BCDE.
081F   D1                     POP   D   ; 
0820   78                     MOV   A,B   ;If lhs==0 then we don't need
0821   B7                     ORA   A   ;to do anything and can just
0822   C8                     RZ      ;exit.
0823   3A 72 01               LDA   FACCUM+3   ;If rhs==0 then exit via a copy
0826   B7                     ORA   A   ;of lhs to FACCUM.
0827   CA 20 0A               JZ   FLoadFromBCDE   ; 
082A   90                     SUB   B   ;A=rhs.exponent-lhs.exponent.
082B   D2 3A 08               JNC   L082C   ;If rhs" exponent >= lhs"exponent, jump ahead.
082E   2F                     CMA      ;Two's complement the exponent
082F   3C                     INR   A   ;difference, so it's correct.
0830   EB                     XCHG      ; 
0831   CD 10 0A               CALL   FPush   ;Push old rhs
0834   EB                     XCHG      ; 
0835   CD 20 0A               CALL   FLoadFromBCDE   ;rhs = old lhs
0838   C1                     POP   B   ;lhs = old rhs.
0839   D1                     POP   D   ; 
083A   F5           L082C:    PUSH   PSW   ;Preserve exponent diff
083B   CD 45 0A               CALL   FUnpackMantissas   
083E   67                     MOV   H,A   ;H=sign relationship
083F   F1                     POP   PSW   ;A=exponent diff.
0840   CD D7 08               CALL   FMantissaRtMult   ;Shift lhs mantissa right by (exponent diff) places.
0843   B4                     ORA   H   ;A=0 after last call, so this tests
0844   21 6F 01               LXI   H,FACCUM   ;the sign relationship.
0847   F2 5B 08               JP   FSubMantissas   ;Jump ahead if we need to subtract.
084A   CD B7 08               CALL   FAddMantissas   ; 
084D   D2 8C 08               JNC   FRoundUp   ;Jump ahead if that didn't overflow.
0850   23                     INX   H   ;Flip the sign in FTEMP_SIGN.
0851   34                     INR   M   ; 
0852   CA B2 08               JZ   Overflow   ;Error out if exponent overflowed.
0855   CD E4 08               CALL   FMantissaRtOnce   ;Shift mantissa one place right
0858   C3 8C 08               JMP   FRoundUp   ;Jump ahead.
085B   AF           FSUBMANTISSAS:   XRA   A   ;B=0-B
085C   90                     SUB   B   ; 
085D   47                     MOV   B,A   ; 
085E   7E                     MOV   A,M   ;E=(FACCUM)-E
085F   9B                     SBB   E   ; 
0860   5F                     MOV   E,A   ; 
0861   23                     INX   H   ; 
0862   7E                     MOV   A,M   ;D=(FACCUM+1)-D
0863   9A                     SBB   D   
0864   57                     MOV   D,A   
0865   23                     INX   H   
0866   7E                     MOV   A,M   ;C=(FACCUM+2)-C
0867   99                     SBB   C   ; 
0868   4F                     MOV   C,A   ; 
0869   DC C3 08     FNORMALISE:   CC   FNegateInt   ; 
086C   26 00                  MVI   H,00h   ; 
086E   79                     MOV   A,C   ;Test most-significant bit of mantissa
086F   B7                     ORA   A   ;and jump ahead if it's 1.
0870   FA 8C 08               JM   FRoundUp   ; 
0873   FE E0        NORMLOOP:   CPI   0xE0   ;If we've shifted 32 times,
0875   CA CC 09               JZ   FZero   ;then the number is 0.
0878   25                     DCR   H   ; 
0879   78                     MOV   A,B   ;Left-shift extra mantissa byte
087A   87                     ADD   A   ; 
087B   47                     MOV   B,A   ; 
087C   CD 9E 08               CALL   FMantissaLeft   ;Left-shift mantissa.
087F   7C                     MOV   A,H   ; 
0880   F2 73 08               JP   NormLoop   ;Loop
0883   21 72 01               LXI   H,FACCUM+3   ; 
0886   86                     ADD   M   ; 
0887   77                     MOV   M,A   ;Since A was a -ve number, that certainly should
0888   D2 CC 09               JNC   FZero   ;have carried, hence the extra check for zero.
088B   C8                     RZ      ;?why?
088C   78           FROUNDUP:   MOV   A,B   ;A=extra mantissa byte
088D   21 72 01               LXI   H,FACCUM+3   ; 
0890   B7                     ORA   A   ;If bit 7 of the extra mantissa byte
0891   FC A8 08               CM   FMantissaInc   ;is set, then round up the mantissa.
0894   46                     MOV   B,M   ;B=exponent
0895   23                     INX   H   ; 
0896   7E                     MOV   A,M   ;A=FTEMP_SIGN
0897   E6 80                  ANI   0x80   ; 
0899   A9                     XRA   C   ;Bit 7 of C is always 1. Thi
089A   4F                     MOV   C,A   ; 
089B   C3 20 0A               JMP   FLoadFromBCDE   ;Exit via copying BCDE to FACCUM.
089E   7B           FMANTISSALEFT:   MOV   A,E   
089F   17                     RAL      
08A0   5F                     MOV   E,A   
08A1   7A                     MOV   A,D   
08A2   17                     RAL      
08A3   57                     MOV   D,A   
08A4   79                     MOV   A,C   
08A5   8F                     ADC   A   
08A6   4F                     MOV   C,A   
08A7   C9                     RET      
08A8   1C           FMANTISSAINC:   INR   E   
08A9   C0                     RNZ      
08AA   14                     INR   D   
08AB   C0                     RNZ      
08AC   0C                     INR   C   
08AD   C0                     RNZ      
08AE   0E 80                  MVI   C,80h   ;Mantissa overflowed to zero, so set it
08B0   34                     INR   M   ;to 1 and increment the exponent.
08B1   C0                     RNZ      ;And if the exponent overflows...
08B2   1E 0A        OVERFLOW:   MVI   E,0Ah   
08B4   C3 D5 01               JMP   Error   
08B7   7E           FADDMANTISSAS:   MOV   A,M   
08B8   83                     ADD   E   
08B9   5F                     MOV   E,A   
08BA   23                     INX   H   
08BB   7E                     MOV   A,M   
08BC   8A                     ADC   D   
08BD   57                     MOV   D,A   
08BE   23                     INX   H   
08BF   7E                     MOV   A,M   
08C0   89                     ADC   C   
08C1   4F                     MOV   C,A   
08C2   C9                     RET      
08C3   21 73 01     FNEGATEINT:   LXI   H,FTEMP   
08C6   7E                     MOV   A,M   
08C7   2F                     CMA      
08C8   77                     MOV   M,A   
08C9   AF                     XRA   A   
08CA   6F                     MOV   L,A   
08CB   90                     SUB   B   
08CC   47                     MOV   B,A   
08CD   7D                     MOV   A,L   
08CE   9B                     SBB   E   
08CF   5F                     MOV   E,A   
08D0   7D                     MOV   A,L   
08D1   9A                     SBB   D   
08D2   57                     MOV   D,A   
08D3   7D                     MOV   A,L   
08D4   99                     SBB   C   
08D5   4F                     MOV   C,A   
08D6   C9                     RET      
08D7   06 00        FMANTISSARTMULT:   MVI   B,00h   ;Initialise extra mantissa byte
08D9   3C                     INR   A   
08DA   6F                     MOV   L,A   
08DB   AF           RTMULTLOOP:   XRA   A   
08DC   2D                     DCR   L   
08DD   C8                     RZ      
08DE   CD E4 08               CALL   FMantissaRtOnce   
08E1   C3 DB 08               JMP   RtMultLoop   
08E4   79           FMANTISSARTONCE:   MOV   A,C   
08E5   1F                     RAR      
08E6   4F                     MOV   C,A   
08E7   7A                     MOV   A,D   
08E8   1F                     RAR      
08E9   57                     MOV   D,A   
08EA   7B                     MOV   A,E   
08EB   1F                     RAR      
08EC   5F                     MOV   E,A   
08ED   78                     MOV   A,B   ;NB: B is the extra
08EE   1F                     RAR      ;mantissa byte.
08EF   47                     MOV   B,A   ; 
08F0   C9                     RET      ; 
08F1   C1           FMUL:     POP   B   ;Get lhs in BCDE
08F2   D1                     POP   D   ; 
08F3   EF                     RST   05   ; FTestSign	;If rhs==0 then exit
08F4   C8                     RZ      ; 
08F5   2E 00                  MVI   L,00h   ;L=0 to signify exponent add
08F7   CD A9 09               CALL   FExponentAdd   
08FA   79                     MOV   A,C   
08FB   32 25 09               STA   FMulInnerLoop+13   
08FE   EB                     XCHG      
08FF   22 20 09               SHLD   FMulInnerLoop+8   
0902   01 00 00               LXI   B,0000h   
0905   50                     MOV   D,B   
0906   58                     MOV   E,B   
0907   21 6C 08               LXI   H,FNormalise+3   
090A   E5                     PUSH   H   
090B   21 13 09               LXI   H,FMulOuterLoop   
090E   E5                     PUSH   H   
090F   E5                     PUSH   H   
0910   21 6F 01               LXI   H,FACCUM   
0913   7E           FMULOUTERLOOP:   MOV   A,M   ;A=FACCUM mantissa byte
0914   23                     INX   H   ; 
0915   E5                     PUSH   H   ;Preserve FACCUM ptr
0916   2E 08                  MVI   L,08h   ;8 bits to do
0918   1F           FMULINNERLOOP:   RAR      ;Test lowest bit of mantissa byte
0919   67                     MOV   H,A   ;Preserve mantissa byte
091A   79                     MOV   A,C   ;A=result mantissa's high byte
091B   D2 27 09               JNC   L0919   ;If that bit of multiplicand was 0, then skip over adding mantissas.
091E   E5                     PUSH   H   ; 
091F   21 00 00               LXI   H,0000h   ; 
0922   19                     DAD   D   ; 
0923   D1                     POP   D   ; 
0924   CE 00                  ACI   00   ;A=result mantissa high byte. This gets back to C
0926   EB                     XCHG      ;in the call to FMantissaRtOnce+1.
0927   CD E5 08     L0919:    CALL   FMantissaRtOnce+1   
092A   2D                     DCR   L   
092B   7C                     MOV   A,H   ;Restore mantissa byte and
092C   C2 18 09               JNZ   FMulInnerLoop   ;jump back if L is not yet 0.
092F   E1           POPHLANDRETURN:   POP   H   ;Restore FACCUM ptr
0930   C9                     RET      ;Return to FMulOuterLoop, or if finished that then exit to FNormalise
0931   CD 10 0A     FDIVBYTEN:   CALL   FPush   ; 
0934   01 20 84               LXI   B,8420h   ;BCDE=(float)10;
0937   11 00 00               LXI   D,0000h   
093A   CD 20 0A               CALL   FLoadFromBCDE   
093D   C1           FDIV:     POP   B   
093E   D1                     POP   D   
093F   EF                     RST   05   ; FTestSign	
0940   CA D3 01               JZ   DivideByZero   
0943   2E FF                  MVI   L,0xFF   
0945   CD A9 09               CALL   FExponentAdd   
0948   34                     INR   M   
0949   34                     INR   M   
094A   2B                     DCX   H   
094B   7E                     MOV   A,M   
094C   32 6E 09               STA   L095F+1   
094F   2B                     DCX   H   
0950   7E                     MOV   A,M   
0951   32 6A 09               STA   L095F-3   
0954   2B                     DCX   H   
0955   7E                     MOV   A,M   
0956   32 66 09               STA   L095F-7   
0959   41                     MOV   B,C   
095A   EB                     XCHG      
095B   AF                     XRA   A   
095C   4F                     MOV   C,A   
095D   57                     MOV   D,A   
095E   5F                     MOV   E,A   
095F   32 71 09               STA   L095F+4   
0962   E5           FDIVLOOP:   PUSH   H   
0963   C5                     PUSH   B   
0964   7D                     MOV   A,L   
0965   D6 00                  SUI   00h   
0967   6F                     MOV   L,A   
0968   7C                     MOV   A,H   
0969   DE 00                  SBI   00   
096B   67                     MOV   H,A   
096C   78                     MOV   A,B   
096D   DE 00        L095F:    SBI   00   
096F   47                     MOV   B,A   
0970   3E 00                  MVI   A,00h   
0972   DE 00                  SBI   00   
0974   3F                     CMC      
0975   D2 7F 09               JNC   L0971   
0978   32 71 09               STA   L095F+4h   
097B   F1                     POP   PSW   
097C   F1                     POP   PSW   
097D   37                     STC      
097E   D2                     DB   0xD2   ;JNC ....	
097F   C1           L0971:    POP   B   
0980   E1                     POP   H   
0981   79                     MOV   A,C   
0982   3C                     INR   A   
0983   3D                     DCR   A   
0984   1F                     RAR      
0985   FA 8D 08               JM   FRoundUp+1   
0988   17                     RAL      
0989   CD 9E 08               CALL   FMantissaLeft   
098C   29                     DAD   H   
098D   78                     MOV   A,B   
098E   17                     RAL      
098F   47                     MOV   B,A   
0990   3A 71 09               LDA   L095F+4h   
0993   17                     RAL      
0994   32 71 09               STA   L095F+4h   
0997   79                     MOV   A,C   
0998   B2                     ORA   D   
0999   B3                     ORA   E   
099A   C2 62 09               JNZ   FDivLoop   
099D   E5                     PUSH   H   
099E   21 72 01               LXI   H,FACCUM+3   
09A1   35                     DCR   M   
09A2   E1                     POP   H   
09A3   C2 62 09               JNZ   FDivLoop   
09A6   C3 B2 08               JMP   Overflow   
09A9   78           FEXPONENTADD:   MOV   A,B   
09AA   B7                     ORA   A   
09AB   CA C8 09               JZ   FExponentAdd+31   
09AE   7D                     MOV   A,L   ;A=0 for add, FF for subtract.
09AF   21 72 01               LXI   H,FACCUM+3   ; 
09B2   AE                     XRA   M   ;XOR with FAccum's exponent.
09B3   80                     ADD   B   ;Add exponents
09B4   47                     MOV   B,A   ; 
09B5   1F                     RAR      ;Carry (after the add) into bit 7.
09B6   A8                     XRA   B   ;XOR with old bit 7.
09B7   78                     MOV   A,B   ; 
09B8   F2 C7 09               JP   FExponentAdd+30   ;If
09BB   C6 80                  ADI   0x80   
09BD   77                     MOV   M,A   
09BE   CA 2F 09               JZ   PopHLandReturn   
09C1   CD 45 0A               CALL   FUnpackMantissas   
09C4   77                     MOV   M,A   
09C5   2B                     DCX   H   
09C6   C9                     RET      
09C7   B7                     ORA   A   
09C8   E1                     POP   H   ;Ignore return address so we'll end
09C9   FA B2 08               JM   Overflow   
09CC   AF           FZERO:    XRA   A   
09CD   32 72 01               STA   FACCUM+3   
09D0   C9                     RET      
09D1   CD 2B 0A     FMULBYTEN:   CALL   FCopyToBCDE   
09D4   78                     MOV   A,B   
09D5   B7                     ORA   A   
09D6   C8                     RZ      
09D7   C6 02                  ADI   02   
09D9   DA B2 08               JC   Overflow   
09DC   47                     MOV   B,A   
09DD   CD 20 08               CALL   FAdd+2   
09E0   21 72 01               LXI   H,FACCUM+3   
09E3   34                     INR   M   
09E4   C0                     RNZ      
09E5   C3 B2 08               JMP   Overflow   
09E8   3A 71 01     FTESTSIGN_TAIL:   LDA   FACCUM+2   
09EB   FE                     DB   0xFE   
09EC   2F           INVSIGNTOINT:   CMA      
09ED   17           SIGNTOINT:   RAL      
09EE   9F                     SBB   A   
09EF   C0                     RNZ      
09F0   3C                     INR   A   
09F1   C9                     RET      
09F2   EF           SGN:      RST   05   ; FTestSign	
09F3   06 88        FCHARTOFLOAT:   MVI   B,88h   ;ie 2^8
09F5   11 00 00               LXI   D,0000h   
09F8   21 72 01               LXI   H,FACCUM+3   
09FB   4F                     MOV   C,A   
09FC   70                     MOV   M,B   
09FD   06 00                  MVI   B,00h   
09FF   23                     INX   H   
0A00   36 80                  MVI   M,80h   
0A02   17                     RAL      
0A03   C3 69 08               JMP   FNormalise   
0A06   EF           ABS:      RST   05   ; FTestSign	
0A07   F0                     RP      
0A08   21 71 01     FNEGATE:   LXI   H,FACCUM+2   
0A0B   7E                     MOV   A,M   
0A0C   EE 80                  XRI   0x80   
0A0E   77                     MOV   M,A   
0A0F   C9                     RET      
0A10   EB           FPUSH:    XCHG      
0A11   2A 6F 01               LHLD   FACCUM   
0A14   E3                     XTHL      
0A15   E5                     PUSH   H   
0A16   2A 71 01               LHLD   FACCUM+2   
0A19   E3                     XTHL      
0A1A   E5                     PUSH   H   
0A1B   EB                     XCHG      
0A1C   C9                     RET      
0A1D   CD 2E 0A     FLOADFROMMEM:   CALL   FLoadBCDEfromMem   
0A20   EB           FLOADFROMBCDE:   XCHG      
0A21   22 6F 01               SHLD   FACCUM   
0A24   60                     MOV   H,B   
0A25   69                     MOV   L,C   
0A26   22 71 01               SHLD   FACCUM+2   
0A29   EB                     XCHG      
0A2A   C9                     RET      
0A2B   21 6F 01     FCOPYTOBCDE:   LXI   H,FACCUM   
0A2E   5E           FLOADBCDEFROMMEM:   MOV   E,M   
0A2F   23                     INX   H   
0A30   56                     MOV   D,M   
0A31   23                     INX   H   
0A32   4E                     MOV   C,M   
0A33   23                     INX   H   
0A34   46                     MOV   B,M   
0A35   23           INCHLRETURN:   INX   H   
0A36   C9                     RET      
0A37   11 6F 01     FCOPYTOMEM:   LXI   D,FACCUM   
0A3A   06 04                  MVI   B,04h   
0A3C   1A           FCOPYLOOP:   LDAX   D   
0A3D   77                     MOV   M,A   
0A3E   13                     INX   D   
0A3F   23                     INX   H   
0A40   05                     DCR   B   
0A41   C2 3C 0A               JNZ   FCopyLoop   
0A44   C9                     RET      
0A45   21 71 01     FUNPACKMANTISSAS:   LXI   H,FACCUM+2   
0A48   7E                     MOV   A,M   ; 
0A49   07                     RLC      ;Move FACCUM's sign to bit 0.
0A4A   37                     STC      ;Set MSB of FACCUM mantissa,
0A4B   1F                     RAR      ;FACCUM's sign is now in carry.
0A4C   77                     MOV   M,A   ; 
0A4D   3F                     CMC      ;Negate FACCUM's sign.
0A4E   1F                     RAR      ;Bit 7 of A is now FACCUM's sign.
0A4F   23                     INX   H   ;Store negated FACCUM sign at FTEMP_SIGN.
0A50   23                     INX   H   ; 
0A51   77                     MOV   M,A   ; 
0A52   79                     MOV   A,C   ; 
0A53   07                     RLC      ;Set MSB of BCDE mantissa,
0A54   37                     STC      ;BCDE's sign is now in carry.
0A55   1F                     RAR      ; 
0A56   4F                     MOV   C,A   ; 
0A57   1F                     RAR      ;Bit 7 of A is now BCDE's sign
0A58   AE                     XRA   M   ;XORed with FTEMP_SIGN.
0A59   C9                     RET      ; 
0A5A   78           FCOMPARE:   MOV   A,B   
0A5B   B7                     ORA   A   
0A5C   CA 28 00               JZ   FTestSign   
0A5F   21 EC 09               LXI   H,InvSignToInt   
0A62   E5                     PUSH   H   
0A63   EF                     RST   05   ; FTestSign	
0A64   79                     MOV   A,C   
0A65   C8                     RZ      
0A66   21 71 01               LXI   H,FACCUM+2   
0A69   AE                     XRA   M   
0A6A   79                     MOV   A,C   
0A6B   F8                     RM      
0A6C   CD 72 0A               CALL   FIsEqual   
0A6F   1F                     RAR      
0A70   A9                     XRA   C   
0A71   C9                     RET      
0A72   23           FISEQUAL:   INX   H   
0A73   78                     MOV   A,B   
0A74   BE                     CMP   M   
0A75   C0                     RNZ      
0A76   2B                     DCX   H   
0A77   79                     MOV   A,C   
0A78   BE                     CMP   M   
0A79   C0                     RNZ      
0A7A   2B                     DCX   H   
0A7B   7A                     MOV   A,D   
0A7C   BE                     CMP   M   
0A7D   C0                     RNZ      
0A7E   2B                     DCX   H   
0A7F   7B                     MOV   A,E   
0A80   96                     SUB   M   
0A81   C0                     RNZ      ; 
0A82   E1                     POP   H   ;Lose 0A5E
0A83   E1                     POP   H   ;Lose 09DE
0A84   C9                     RET      ;Return to caller
0A85   47           FASINTEGER:   MOV   B,A   ; 
0A86   4F                     MOV   C,A   
0A87   57                     MOV   D,A   
0A88   5F                     MOV   E,A   
0A89   B7                     ORA   A   
0A8A   C8                     RZ      
0A8B   E5                     PUSH   H   
0A8C   CD 2B 0A               CALL   FCopyToBCDE   
0A8F   CD 45 0A               CALL   FUnpackMantissas   
0A92   AE                     XRA   M   ;Get sign back
0A93   67                     MOV   H,A   
0A94   FC A9 0A               CM   FMantissaDec   
0A97   3E 98                  MVI   A,98h   
0A99   90                     SUB   B   ;by (24-exponent) places?
0A9A   CD D7 08               CALL   FMantissaRtMult   ;WHY?
0A9D   7C                     MOV   A,H   
0A9E   17                     RAL      
0A9F   DC A8 08               CC   FMantissaInc   
0AA2   06 00                  MVI   B,00h   ;Needed for FNegateInt.
0AA4   DC C3 08               CC   FNegateInt   
0AA7   E1                     POP   H   
0AA8   C9                     RET      
0AA9   1B           FMANTISSADEC:   DCX   D   ;DE--
0AAA   7A                     MOV   A,D   ;If DE!=0xFFFF...
0AAB   A3                     ANA   E   ; 
0AAC   3C                     INR   A   ; 
0AAD   C0                     RNZ      ;... then return
0AAE   0D                     DCR   C   ;C--
0AAF   C9                     RET      ; 
0AB0   21 72 01     INT:      LXI   H,FACCUM+3   ; 
0AB3   7E                     MOV   A,M   ; 
0AB4   FE 98                  CPI   0x98   ; 
0AB6   D0                     RNC      ; 
0AB7   CD 85 0A               CALL   FAsInteger   ; 
0ABA   36 98                  MVI   M,98h   ; 
0ABC   79                     MOV   A,C   ; 
0ABD   17                     RAL      ; 
0ABE   C3 69 08               JMP   FNormalise   ; 
0AC1   2B           FIN:      DCX   H   ; 
0AC2   CD CC 09               CALL   FZero   ; 
0AC5   47                     MOV   B,A   ;B=count of fractional digits
0AC6   57                     MOV   D,A   ;D=exponent sign
0AC7   5F                     MOV   E,A   ;E=exponent
0AC8   2F                     CMA      ;C=decimal_point_done (0xFF for no, 0x00 for yes)
0AC9   4F                     MOV   C,A   ; 
0ACA   D7           FINLOOP:   RST   02   ;RST NextChar	
0ACB   DA 12 0B               JC   ProcessDigit   
0ACE   FE 2E                  CPI   "."   
0AD0   CA F2 0A               JZ   L0AE4   
0AD3   FE 45                  CPI   "E"   
0AD5   C2 F6 0A               JNZ   ScaleResult   
0AD8   D7           GETEXPONENT:   RST   02   ;RST NextChar	
0AD9   15                     DCR   D   
0ADA   FE 99                  CPI   0x99   ;KWID_MINUS	
0ADC   CA E6 0A               JZ   NextExponentDigit   
0ADF   14                     INR   D   
0AE0   FE 98                  CPI   0x98   ;KWID_PLUS	
0AE2   CA E6 0A               JZ   NextExponentDigit   
0AE5   2B                     DCX   H   
0AE6   D7           NEXTEXPONENTDIGIT:   RST   02   ;RST NextChar	
0AE7   DA 31 0B               JC   DoExponentDigit   
0AEA   14                     INR   D   
0AEB   C2 F6 0A               JNZ   ScaleResult   
0AEE   AF                     XRA   A   
0AEF   93                     SUB   E   
0AF0   5F                     MOV   E,A   
0AF1   0C                     INR   C   ;C was 0xFF, so here it
0AF2   0C           L0AE4:    INR   C   ;becomes 0x01.
0AF3   CA CA 0A               JZ   FInLoop   ;If C is now zero
0AF6   E5           SCALERESULT:   PUSH   H   
0AF7   7B                     MOV   A,E   
0AF8   90                     SUB   B   
0AF9   F4 0A 0B     DECIMALLOOP:   CP   DecimalShiftUp   
0AFC   F2 05 0B               JP   DecimalLoopEnd   
0AFF   F5                     PUSH   PSW   
0B00   CD 31 09               CALL   FDivByTen   
0B03   F1                     POP   PSW   
0B04   3C                     INR   A   
0B05   C2 F9 0A     DECIMALLOOPEND:   JNZ   DecimalLoop   
0B08   E1                     POP   H   
0B09   C9                     RET      
0B0A   C8           DECIMALSHIFTUP:   RZ      
0B0B   F5                     PUSH   PSW   
0B0C   CD D1 09               CALL   FMulByTen   
0B0F   F1                     POP   PSW   
0B10   3D                     DCR   A   
0B11   C9                     RET      
0B12   D5           PROCESSDIGIT:   PUSH   D   
0B13   57                     MOV   D,A   
0B14   78                     MOV   A,B   
0B15   89                     ADC   C   
0B16   47                     MOV   B,A   
0B17   C5                     PUSH   B   
0B18   E5                     PUSH   H   
0B19   D5                     PUSH   D   
0B1A   CD D1 09               CALL   FMulByTen   
0B1D   F1                     POP   PSW   
0B1E   D6 30                  SUI   "0"   
0B20   CD 10 0A               CALL   FPush   
0B23   CD F3 09               CALL   FCharToFloat   
0B26   C1                     POP   B   
0B27   D1                     POP   D   
0B28   CD 20 08               CALL   FAdd+2   
0B2B   E1                     POP   H   
0B2C   C1                     POP   B   
0B2D   D1                     POP   D   
0B2E   C3 CA 0A               JMP   FInLoop   
0B31   7B           DOEXPONENTDIGIT:   MOV   A,E   
0B32   07                     RLC      
0B33   07                     RLC      
0B34   83                     ADD   E   
0B35   07                     RLC      
0B36   86                     ADD   M   
0B37   D6 30                  SUI   "0"   
0B39   5F                     MOV   E,A   
0B3A   C3 E6 0A               JMP   NextExponentDigit   
0B3D   E5           PRINTIN:   PUSH   H   
0B3E   21 88 01               LXI   H,szIn   
0B41   CD B1 05               CALL   PrintString   
0B44   E1                     POP   H   
0B45   EB           PRINTINT:   XCHG      ;DE=integer
0B46   AF                     XRA   A   ;A=0 (ends up in C)
0B47   06 98                  MVI   B,98h   ;B (ie exponent) = 24
0B49   CD F8 09               CALL   FCharToFloat+5   
0B4C   21 B0 05               LXI   H,PrintString-1   
0B4F   E5                     PUSH   H   
0B50   21 74 01     FOUT:     LXI   H,FBUFFER   
0B53   E5                     PUSH   H   
0B54   EF                     RST   05   ; FTestSign	
0B55   36 20                  MVI   M," "   
0B57   F2 5C 0B               JP   DoZero   
0B5A   36 2D                  MVI   M,"-"   
0B5C   23           DOZERO:   INX   H   
0B5D   36 30                  MVI   M,"0"   
0B5F   CA 05 0C               JZ   NullTerm-3   
0B62   E5                     PUSH   H   
0B63   FC 08 0A               CM   FNegate   
0B66   AF                     XRA   A   
0B67   F5                     PUSH   PSW   
0B68   CD 0B 0C               CALL   ToUnder1000000   
0B6B   01 43 91     TOOVER100000:   LXI   B,9143h   ;BCDE=(float)100,000.
0B6E   11 F8 4F               LXI   D,4FF8h   ; 
0B71   CD 5A 0A               CALL   FCompare   ;If FACCUM >= 100,000
0B74   E2 88 0B               JPO   PrepareToPrint   ;then jump to PrepareToPrint.
0B77   F1                     POP   PSW   ;A=DecExpAdj
0B78   CD 0B 0B               CALL   DecimalShiftUp+1   ;FACCUM*=10; DecExpAdj--;
0B7B   F5                     PUSH   PSW   ; 
0B7C   C3 6B 0B               JMP   ToOver100000   
0B7F   CD 31 09     L0B71:    CALL   FDivByTen   
0B82   F1                     POP   PSW   
0B83   3C                     INR   A   ;DecExpAdj++;
0B84   F5                     PUSH   PSW   
0B85   CD 0B 0C               CALL   ToUnder1000000   
0B88   CD 0F 08     PREPARETOPRINT:   CALL   FAddOneHalf   
0B8B   3C                     INR   A   
0B8C   CD 85 0A               CALL   FAsInteger   
0B8F   CD 20 0A               CALL   FLoadFromBCDE   
0B92   01 06 02               LXI   B,0206h   
0B95   F1                     POP   PSW   ;A=DecExpAdj+6.
0B96   81                     ADD   C   ; 
0B97   FA A3 0B               JM   L0B95   ;If A<1 or A>6 Then goto fixme.
0B9A   FE 07                  CPI   0x07   ; 
0B9C   D2 A3 0B               JNC   L0B95   ; 
0B9F   3C                     INR   A   ; 
0BA0   47                     MOV   B,A   ; 
0BA1   3E 01                  MVI   A,01h   ;A=1, indicating scientific notation.
0BA3   3D           L0B95:    DCR   A   ; 
0BA4   E1                     POP   H   ;HL=output buffer
0BA5   F5                     PUSH   PSW   ;Preserve decimal exponent adjustment (and preserve zero flag used to indicate scientific notation wanted).
0BA6   11 1D 0C               LXI   D,DECIMAL_POWERS   
0BA9   05           NEXTDIGIT:   DCR   B   
0BAA   36 2E                  MVI   M,"."   
0BAC   CC 35 0A               CZ   IncHLReturn   ;0A27 just happens to inc HL and RET.
0BAF   C5                     PUSH   B   ; 
0BB0   E5                     PUSH   H   ; 
0BB1   D5                     PUSH   D   ;DE=>decimal power
0BB2   CD 2B 0A               CALL   FCopyToBCDE   ;Store BCDE to FACCUM.
0BB5   E1                     POP   H   ;HL=>decimal power.
0BB6   06 2F                  MVI   B,"0"-1   ; 
0BB8   04           DIGITLOOP:   INR   B   ; 
0BB9   7B                     MOV   A,E   ; 
0BBA   96                     SUB   M   ; 
0BBB   5F                     MOV   E,A   ; 
0BBC   23                     INX   H   ; 
0BBD   7A                     MOV   A,D   ; 
0BBE   9E                     SBB   M   ; 
0BBF   57                     MOV   D,A   ; 
0BC0   23                     INX   H   ; 
0BC1   79                     MOV   A,C   ; 
0BC2   9E                     SBB   M   ; 
0BC3   4F                     MOV   C,A   ; 
0BC4   2B                     DCX   H   ; 
0BC5   2B                     DCX   H   ; 
0BC6   D2 B8 0B               JNC   DigitLoop   ; 
0BC9   CD B7 08               CALL   FAddMantissas   ; 
0BCC   23                     INX   H   ;???
0BCD   CD 20 0A               CALL   FLoadFromBCDE   ; 
0BD0   EB                     XCHG      ; 
0BD1   E1                     POP   H   ;HL=output buffer
0BD2   70                     MOV   M,B   ; 
0BD3   23                     INX   H   ; 
0BD4   C1                     POP   B   ;B=decimal point place
0BD5   0D                     DCR   C   ;C=digits remaining, minus one.
0BD6   C2 A9 0B               JNZ   NextDigit   ; 
0BD9   05                     DCR   B   ; 
0BDA   CA E9 0B               JZ   L0BDB   ; 
0BDD   2B           L0BCF:    DCX   H   ; 
0BDE   7E                     MOV   A,M   ; 
0BDF   FE 30                  CPI   "0"   ; 
0BE1   CA DD 0B               JZ   L0BCF   ; 
0BE4   FE 2E                  CPI   "."   ; 
0BE6   C4 35 0A               CNZ   IncHLReturn   ; 
0BE9   F1           L0BDB:    POP   PSW   ; 
0BEA   CA 08 0C               JZ   NullTerm   ; 
0BED   36 45                  MVI   M,"E"   ;Write "E"
0BEF   23                     INX   H   ; 
0BF0   36 2B                  MVI   M,"+"   ;Write "+" or "-"
0BF2   F2 F9 0B               JP   L0BEB   ; 
0BF5   36 2D                  MVI   M,"-"   ;Write "-" if it's negative, also
0BF7   2F                     CMA      ;two's complement the decimal exponent
0BF8   3C                     INR   A   ;so printing it will work.
0BF9   06 2F        L0BEB:    MVI   B,"0"-1   ; 
0BFB   04           EXPDIGITLOOP:   INR   B   ; 
0BFC   D6 0A                  SUI   0Ah   ; 
0BFE   D2 FB 0B               JNC   ExpDigitLoop   ; 
0C01   C6 3A                  ADI   3Ah   ;Adding "0"+10 gives us the 2nd digit
0C03   23                     INX   H   ;of the exponent.
0C04   70                     MOV   M,B   ;Write first digit.
0C05   23                     INX   H   ; 
0C06   77                     MOV   M,A   ;Write second digit of exponent.
0C07   23                     INX   H   ; 
0C08   71           NULLTERM:   MOV   M,C   ;Null byte terminator.
0C09   E1                     POP   H   ; 
0C0A   C9                     RET      ; 
0C0B   01 74 94     TOUNDER1000000:   LXI   B,9474h   ; 
0C0E   11 F7 23               LXI   D,23F7h   ; 
0C11   CD 5A 0A               CALL   FCompare   ; 
0C14   E1                     POP   H   ; 
0C15   E2 7F 0B               JPO   L0B71   ; 
0C18   E9                     PCHL      ; 
0C19   00 00 00 80  ONE_HALF:   DB   0x00,0x00,0x00,0x80   ; DD 0.5	
0C1D   A0 86 01     DECIMAL_POWERS:   DB   0xA0,0x86,0x01   ; DT 100000	
0C20   10 27 00               DB   0x10,0x27,0x00   ; DT 10000	
0C23   E8 03 00               DB   0xE8,0x03,0x00   ; DT 1000	
0C26   64 00 00               DB   0x64,0x00,0x00   ; DT 100	
0C29   0A 00 00               DB   0x0A,0x00,0x00   ; DT 10	
0C2C   01 00 00               DB   0x01,0x00,0x00   ; DT 1	
0C2F   EF           SQR:      RST   05   ; FTestSign	;
0C30   FA A6 04               JM   FunctionCallError   ; 
0C33   C8                     RZ      ; 
0C34   21 72 01               LXI   H,FACCUM+3   ; 
0C37   7E                     MOV   A,M   ; 
0C38   1F                     RAR      ; 
0C39   F5                     PUSH   PSW   ; 
0C3A   E5                     PUSH   H   ; 
0C3B   3E 40                  MVI   A,40h   ; 
0C3D   17                     RAL      ; 
0C3E   77                     MOV   M,A   ; 
0C3F   21 74 01               LXI   H,FBUFFER   ; 
0C42   CD 37 0A               CALL   FCopyToMem   ; 
0C45   3E 04                  MVI   A,04h   ; 
0C47   F5           SQRLOOP:   PUSH   PSW   ; 
0C48   CD 10 0A               CALL   FPush   ; 
0C4B   21 74 01               LXI   H,FBUFFER   ; 
0C4E   CD 2E 0A               CALL   FLoadBCDEfromMem   
0C51   CD 3F 09               CALL   FDiv+2   
0C54   C1                     POP   B   
0C55   D1                     POP   D   
0C56   CD 20 08               CALL   FAdd+2   
0C59   01 00 80               LXI   B,8000h   
0C5C   51                     MOV   D,C   
0C5D   59                     MOV   E,C   
0C5E   CD F3 08               CALL   FMul+2   
0C61   F1                     POP   PSW   
0C62   3D                     DCR   A   
0C63   C2 47 0C               JNZ   SqrLoop   
0C66   E1                     POP   H   
0C67   F1                     POP   PSW   
0C68   C6 C0                  ADI   0xC0   
0C6A   86                     ADD   M   
0C6B   77                     MOV   M,A   
0C6C   C9                     RET      
0C6D   EF           RND:      RST   05   ; FTestSign	
0C6E   FA 8A 0C               JM   L0C7C   
0C71   21 9F 0C               LXI   H,RND_SEED   
0C74   CD 1D 0A               CALL   FLoadFromMem   
0C77   C8                     RZ      
0C78   01 35 98               LXI   B,9835h   
0C7B   11 7A 44               LXI   D,447Ah   
0C7E   CD F3 08               CALL   FMul+2   
0C81   01 28 68               LXI   B,0x6828   
0C84   11 46 B1               LXI   D,0xB146   
0C87   CD 20 08               CALL   FAdd+2   
0C8A   CD 2B 0A     L0C7C:    CALL   FCopyToBCDE   
0C8D   7B                     MOV   A,E   
0C8E   59                     MOV   E,C   
0C8F   4F                     MOV   C,A   
0C90   36 80                  MVI   M,80h   
0C92   2B                     DCX   H   
0C93   46                     MOV   B,M   
0C94   36 80                  MVI   M,80h   
0C96   CD 6C 08               CALL   FNormalise+3   
0C99   21 9F 0C               LXI   H,RND_SEED   
0C9C   C3 37 0A               JMP   FCopyToMem   
0C9F   52 C7 4F 80  RND_SEED:   DB   52h,0C7h,4Fh,80h   
0CA3   CD 10 0A     SIN:      CALL   FPush   ;ush x
0CA6   01 49 83               LXI   B,8349h   ;CDE=2p
0CA9   11 DB 0F               LXI   D,0FDBh   ; 
0CAC   CD 20 0A               CALL   FLoadFromBCDE   ;hs = 2p
0CAF   C1                     POP   B   ;hs = x
0CB0   D1                     POP   D   ; 
0CB1   CD 3F 09               CALL   FDiv+2   ;=x/2p
0CB4   CD 10 0A               CALL   FPush   ; 
0CB7   CD B0 0A               CALL   Int   ;hs = INT(u)
0CBA   C1                     POP   B   ;hs = u
0CBB   D1                     POP   D   ; 
0CBC   CD 1A 08               CALL   FSub+2   ;=u-INT(u)
0CBF   01 00 7F               LXI   B,7F00h   ;CDE=0.25
0CC2   51                     MOV   D,C   ; 
0CC3   59                     MOV   E,C   ; 
0CC4   CD 1A 08               CALL   FSub+2   ; 
0CC7   EF                     RST   05   ; FTestSign	;
0CC8   37                     STC      ;set carry (ie no later negate)
0CC9   F2 D1 0C               JP   NegateIfPositive   ; 
0CCC   CD 0F 08               CALL   FAddOneHalf   ; 
0CCF   EF                     RST   05   ; 
0CD0   B7                     ORA   A   ;resets carry (ie later negate)
0CD1   F5           NEGATEIFPOSITIVE:   PUSH   PSW   ; 
0CD2   F4 08 0A               CP   FNegate   ; 
0CD5   01 00 7F               LXI   B,7F00h   ;CDE=0.25
0CD8   51                     MOV   D,C   ; 
0CD9   59                     MOV   E,C   ; 
0CDA   CD 20 08               CALL   FAdd+2   ; 
0CDD   F1                     POP   PSW   ; 
0CDE   D4 08 0A               CNC   FNegate   ; 
0CE1   CD 10 0A               CALL   FPush   ; 
0CE4   CD 2B 0A               CALL   FCopyToBCDE   ; 
0CE7   CD F3 08               CALL   FMul+2   ; = x*x
0CEA   CD 10 0A               CALL   FPush   ;ush x*x
0CED   21 11 0D               LXI   H,TAYLOR_SERIES   ; 
0CF0   CD 1D 0A               CALL   FLoadFromMem   ; 
0CF3   C1                     POP   B   ; 
0CF4   D1                     POP   D   ; 
0CF5   3E 04                  MVI   A,04h   ; 
0CF7   F5           TAYLORLOOP:   PUSH   PSW   ;ush #terms remaining
0CF8   D5                     PUSH   D   ;ush BCDE
0CF9   C5                     PUSH   B   ; 
0CFA   E5                     PUSH   H   ; 
0CFB   CD F3 08               CALL   FMul+2   ; 
0CFE   E1                     POP   H   ; 
0CFF   CD 2E 0A               CALL   FLoadBCDEfromMem   ; 
0D02   E5                     PUSH   H   ; 
0D03   CD 20 08               CALL   FAdd+2   ; 
0D06   E1                     POP   H   ; 
0D07   C1                     POP   B   ; 
0D08   D1                     POP   D   ; 
0D09   F1                     POP   PSW   ;op #terms remaining into A.
0D0A   3D                     DCR   A   ;ecrement #terms and loop back if not
0D0B   C2 F7 0C               JNZ   TaylorLoop   ;one all 4 of them.
0D0E   C3 F1 08               JMP   FMul   ; 
0D11   BA D7 1E 86  TAYLOR_SERIES:   DB   0xBA,0xD7,0x1E,0x86   ;DD 39.710670	
0D15   64 26 99 87            DB   0x64,0x26,0x99,0x87   ;DD -76.574982	
0D19   58 34 23 87            DB   0x58,0x34,0x23,0x87   ;DD 81.602234	
0D1D   E0 5D A5 86            DB   0xE0,0x5D,0xA5,0x86   ;DD -41.341675	
0D21   DA 0F 49 83            DB   0xDA,0x0F,0x49,0x83   ;DD 6.283185	
0D25   00 00 00 00 00 00 00 00 00 00 L0D17:   DB   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00   ;   DD 6.283185
0D2F   21 1A 0F     INIT:     LXI   H,STK_TOP   ; *** STACK_TOP RELOCATE
0D32   F9                     SPHL      ; 
0D33   22 63 01               SHLD   STACK_TOP   ; ld (STACK_TOP),hl
0D36   DB 18                  IN   UART_RX   ; flush RX buffer
0D38   0E FF                  MVI   C,0xFF   ; ld c,$ff
0D3A   C3 3D 0D               JMP   ConfigIOcode   
0D3D   21 FF FF     CONFIGIOCODE:   LXI   H,0xFFFF   ; 
0D40   22 61 01               SHLD   CURRENT_LINE   ; ld (CURRENT_LINE),hl
0D43   CD 98 05               CALL   NewLine   ; 
0D46   21 6C 0E               LXI   H,szMemorySize   ; 
0D49   CD B1 05               CALL   PrintString   
0D4C   CD C2 02               CALL   InputLineWith   
0D4F   D7                     RST   02   ;RST NextChar	
0D50   B7                     ORA   A   
0D51   C2 5A 0D               JNZ   L0DDE   
0D54   21 00 20               LXI   H,MEM_TOP   ;UnusedMemory	
0D57   C3 66 0D               JMP   DoneMemSize   
0D5A   21 13 01     L0DDE:    LXI   H,LINE_BUFFER   
0D5D   CD AB 04               CALL   LineNumberFromStr   
0D60   B7                     ORA   A   
0D61   C2 D0 01               JNZ   SyntaxError   
0D64   EB                     XCHG      
0D65   2B                     DCX   H   
0D66   2B           DONEMEMSIZE:   DCX   H   
0D67   E5                     PUSH   H   
0D68   21 30 0E     GETTERMINALWIDTH:   LXI   H,szTerminalWidth   
0D6B   CD B1 05               CALL   PrintString   
0D6E   CD C2 02               CALL   InputLineWith   
0D71   D7                     RST   02   ;RST NextChar	
0D72   B7                     ORA   A   
0D73   CA 97 0D               JZ   DoOptionalFns   
0D76   21 13 01               LXI   H,LINE_BUFFER   
0D79   CD AB 04               CALL   LineNumberFromStr   
0D7C   7A                     MOV   A,D   
0D7D   B7                     ORA   A   
0D7E   C2 68 0D               JNZ   GetTerminalWidth   
0D81   7B                     MOV   A,E   
0D82   FE 10                  CPI   0x10   
0D84   DA 68 0D               JC   GetTerminalWidth   
0D87   32 6F 03               STA   OutChar_tail+1   
0D8A   D6 0E        CALCTABBRKSIZE:   SUI   0Eh   
0D8C   D2 8A 0D               JNC   CalcTabBrkSize   
0D8F   C6 1C                  ADI   1Ch   
0D91   2F                     CMA      
0D92   3C                     INR   A   
0D93   83                     ADD   E   
0D94   32 C5 05               STA   ToNextTabBreak+4   
0D97   21 01 0E     DOOPTIONALFNS:   LXI   H,OPT_FN_DESCS   
0D9A   F7           OPTIONALFNSLOOP:   RST   6   
0D9B   11 15 0E               LXI   D,szWantSin   
0D9E   E7                     RST   4   
0D9F   CA AE 0D               JZ   L0E32   
0DA2   F7                     RST   6   
0DA3   E3                     XTHL      
0DA4   CD B1 05               CALL   PrintString   
0DA7   CD C2 02               CALL   InputLineWith   
0DAA   D7                     RST   02   ;RST NextChar	
0DAB   E1                     POP   H   
0DAC   FE 59                  CPI   "Y"   
0DAE   D1           L0E32:    POP   D   
0DAF   CA C3 0D               JZ   InitProgramBase   
0DB2   FE 4E                  CPI   "N"   
0DB4   C2 97 0D               JNZ   DoOptionalFns   
0DB7   F7                     RST   6   
0DB8   E3                     XTHL      
0DB9   11 A6 04               LXI   D,FunctionCallError   
0DBC   73                     MOV   M,E   
0DBD   23                     INX   H   
0DBE   72                     MOV   M,D   
0DBF   E1                     POP   H   
0DC0   C3 9A 0D               JMP   OptionalFnsLoop   
0DC3   EB           INITPROGRAMBASE:   XCHG      
0DC4   36 00                  MVI   M,00h   
0DC6   23                     INX   H   
0DC7   22 65 01               SHLD   PROGRAM_BASE   
0DCA   E3                     XTHL      
0DCB   11 1A 0F               LXI   D,STK_TOP   ; *** RELOCATE STACK_TOP	
0DCE   E7                     RST   4   
0DCF   DA CD 01               JC   OutOfMemory   
0DD2   D1                     POP   D   
0DD3   F9                     SPHL      
0DD4   22 63 01               SHLD   STACK_TOP   
0DD7   EB                     XCHG      
0DD8   CD C3 01               CALL   CheckEnoughMem   
0DDB   7B                     MOV   A,E   
0DDC   95                     SUB   L   
0DDD   6F                     MOV   L,A   
0DDE   7A                     MOV   A,D   
0DDF   9C                     SBB   H   
0DE0   67                     MOV   H,A   
0DE1   01 F0 FF               LXI   B,0xFFF0   
0DE4   09                     DAD   B   
0DE5   CD 98 05               CALL   NewLine   
0DE8   CD 45 0B               CALL   PrintInt   
0DEB   21 3F 0E               LXI   H,szVersionInfo   
0DEE   CD B1 05               CALL   PrintString   
0DF1   21 B1 05               LXI   H,PrintString   
0DF4   22 FD 01               SHLD   Main+4   
0DF7   CD 96 02               CALL   New+1   
0DFA   21 F9 01               LXI   H,Main   
0DFD   22 02 00               SHLD   Start+2   
0E00   E9                     PCHL      
0E01   25 0D        OPT_FN_DESCS:   DW   L0D17   
0E03   15 0E                  DW   szWantSin   
0E05   49 00                  DW   KW_INLINE_FNS+12   
0E07   A3 0C                  DW   Sin   
0E09   1E 0E                  DW   szWantRnd   
0E0B   47 00                  DW   KW_INLINE_FNS+10   
0E0D   6D 0C                  DW   Rnd   
0E0F   27 0E                  DW   szWantSqr   
0E11   45 00                  DW   KW_INLINE_FNS+8   
0E13   2F 0C                  DW   Sqr   
0E15   57 41 4E 54 20 53 49 CE 00 SZWANTSIN:   DB   57h,41h,4Eh,54h,20h,53h,49h,0CEh,00h   ; DS "WANT SIN\0"
0E1E   57 41 4E 54 20 52 4E C4 00 SZWANTRND:   DB   57h,41h,4Eh,54h,20h,52h,4Eh,0C4h,00h   ; DS "WANT RND\0"
0E27   57 41 4E 54 20 53 51 D2 00 SZWANTSQR:   DB   57h,41h,4Eh,54h,20h,53h,51h,0D2h,00h   ; DS "WANT SQR\0"
0E30   54 45 52 4D 49 4E 41 4C 20 57 49 44 54 C8 00 SZTERMINALWIDTH:   DB   54h,45h,52h,4Dh,49h,4Eh,41h,4Ch,20h,57h,49h,44h,54h,0C8h,00h   ; DS "TERMINAL WIDTH\0"
0E3F   20 42 59 54 45 53 20 46 52 45 C5 0D 0D SZVERSIONINFO:   DB   0x20,0x42,0x59,0x54,0x45,0x53,0x20,0x46,0x52,0x45,0xC5,0x0D,0x0D   ; DS " BYTES FREE\r\r"
0E4C   42 41 53 49 43 20 56 45 52 53 49 4F 4E 20 33 2E DB   0x42,0x41,0x53,0x49,0x43,0x20,0x56,0x45,0x52,0x53,0x49,0x4F,0x4E,0x20,0x33,0x2E   ; "BASIC VERSION 3."
0E5C   B2 0D 5B 34 4B 20 56 45 52 53 49 4F 4E DD 0D 00 DB   0xB2,0x0D,0x5B,0x34,0x4B,0x20,0x56,0x45,0x52,0x53,0x49,0x4F,0x4E,0xDD,0x0D,0x00   ; "2\r[4K VERSION]\r\0"
0E6C   4D 45 4D 4F 52 59 20 53 49 5A C5 00 SZMEMORYSIZE:   DB   0x4D,0x45,0x4D,0x4F,0x52,0x59,0x20,0x53,0x49,0x5A,0xC5,0x00   ; DS "MEMORY SIZE\0"
0E78   00           UNUSEDMEMORY:   DB   00   


UART_RX:            0018 DEFINED AT LINE 9
                    > USED AT LINE 502
                    > USED AT LINE 1973
UART_TX:            0018 DEFINED AT LINE 10
                    > USED AT LINE 495
UART_RX_STATUS:     0019 DEFINED AT LINE 11
                    > USED AT LINE 498
                    > USED AT LINE 499
                    > USED AT LINE 647
                    > USED AT LINE 648
UART_TX_STATUS:     0019 DEFINED AT LINE 12
                    > USED AT LINE 489
                    > USED AT LINE 490
UART_RX_FULL:       0001 DEFINED AT LINE 13
                    > USED AT LINE 500
                    > USED AT LINE 649
UART_TX_EMPTY:      0004 DEFINED AT LINE 14
                    > USED AT LINE 491
STK_TOP:            0F1A DEFINED AT LINE 16
                    > USED AT LINE 172
                    > USED AT LINE 1970
                    > USED AT LINE 2047
MEM_TOP:            2000 DEFINED AT LINE 17
                    > USED AT LINE 1986
START:              0000 DEFINED AT LINE 21
                    > USED AT LINE 2071
SYNTAXCHECK:        0008 DEFINED AT LINE 27
NEXTCHAR:           0010 DEFINED AT LINE 33
                    > USED AT LINE 634
OUTCHAR:            0018 DEFINED AT LINE 38
COMPAREHLDE:        0020 DEFINED AT LINE 42
TERMINAL_Y:         0026 DEFINED AT LINE 48
                    > USED AT LINE 812
TERMINAL_X:         0027 DEFINED AT LINE 49
                    > USED AT LINE 39
                    > USED AT LINE 487
                    > USED AT LINE 808
                    > USED AT LINE 814
                    > USED AT LINE 832
                    > USED AT LINE 845
FTESTSIGN:          0028 DEFINED AT LINE 50
                    > USED AT LINE 1571
PUSHNEXTWORD:       0030 DEFINED AT LINE 54
L003A:              003A DEFINED AT LINE 62
                    > USED AT LINE 55
                    > USED AT LINE 62
KW_INLINE_FNS:      003D DEFINED AT LINE 63
                    > USED AT LINE 1023
                    > USED AT LINE 2076
                    > USED AT LINE 2079
                    > USED AT LINE 2082
KW_ARITH_OP_FNS:    004B DEFINED AT LINE 70
                    > USED AT LINE 969
KEYWORDS:           0057 DEFINED AT LINE 78
                    > USED AT LINE 401
                    > USED AT LINE 533
KW_GENERAL_FNS:     00D2 DEFINED AT LINE 122
                    > USED AT LINE 624
ERROR_CODES:        00FA DEFINED AT LINE 143
                    > USED AT LINE 235
LINE_BUFFER:        0113 DEFINED AT LINE 157
                    > USED AT LINE 310
                    > USED AT LINE 390
                    > USED AT LINE 447
                    > USED AT LINE 460
                    > USED AT LINE 806
                    > USED AT LINE 1988
                    > USED AT LINE 2002
DIM_OR_EVAL:        015B DEFINED AT LINE 167
                    > USED AT LINE 1036
                    > USED AT LINE 1105
                    > USED AT LINE 1111
                    > USED AT LINE 1134
                    > USED AT LINE 1154
INPUT_OR_READ:      015C DEFINED AT LINE 168
                    > USED AT LINE 871
                    > USED AT LINE 884
                    > USED AT LINE 899
PROG_PTR_TEMP:      015D DEFINED AT LINE 169
                    > USED AT LINE 369
                    > USED AT LINE 381
                    > USED AT LINE 589
                    > USED AT LINE 739
                    > USED AT LINE 917
                    > USED AT LINE 948
L015F:              015F DEFINED AT LINE 170
                    > USED AT LINE 956
                    > USED AT LINE 957
                    > USED AT LINE 983
CURRENT_LINE:       0161 DEFINED AT LINE 171
                    > USED AT LINE 246
                    > USED AT LINE 257
                    > USED AT LINE 562
                    > USED AT LINE 610
                    > USED AT LINE 697
                    > USED AT LINE 720
                    > USED AT LINE 859
                    > USED AT LINE 943
                    > USED AT LINE 1978
STACK_TOP:          0163 DEFINED AT LINE 172
                    > USED AT LINE 375
                    > USED AT LINE 1972
                    > USED AT LINE 2052
PROGRAM_BASE:       0165 DEFINED AT LINE 173
                    > USED AT LINE 338
                    > USED AT LINE 359
                    > USED AT LINE 367
                    > USED AT LINE 641
                    > USED AT LINE 2045
VAR_BASE:           0167 DEFINED AT LINE 174
                    > USED AT LINE 280
                    > USED AT LINE 289
                    > USED AT LINE 293
                    > USED AT LINE 300
                    > USED AT LINE 365
                    > USED AT LINE 371
                    > USED AT LINE 1051
VAR_ARRAY_BASE:     0169 DEFINED AT LINE 175
                    > USED AT LINE 372
                    > USED AT LINE 1049
                    > USED AT LINE 1088
                    > USED AT LINE 1117
VAR_TOP:            016B DEFINED AT LINE 176
                    > USED AT LINE 213
                    > USED AT LINE 373
                    > USED AT LINE 1078
                    > USED AT LINE 1085
                    > USED AT LINE 1123
                    > USED AT LINE 1171
DATA_PROG_PTR:      016D DEFINED AT LINE 177
                    > USED AT LINE 643
                    > USED AT LINE 868
FACCUM:             016F DEFINED AT LINE 178
                    > USED AT LINE 50
                    > USED AT LINE 664
                    > USED AT LINE 1101
                    > USED AT LINE 1194
                    > USED AT LINE 1213
                    > USED AT LINE 1250
                    > USED AT LINE 1256
                    > USED AT LINE 1356
                    > USED AT LINE 1446
                    > USED AT LINE 1455
                    > USED AT LINE 1474
                    > USED AT LINE 1484
                    > USED AT LINE 1488
                    > USED AT LINE 1499
                    > USED AT LINE 1509
                    > USED AT LINE 1515
                    > USED AT LINE 1518
                    > USED AT LINE 1525
                    > USED AT LINE 1528
                    > USED AT LINE 1531
                    > USED AT LINE 1541
                    > USED AT LINE 1550
                    > USED AT LINE 1577
                    > USED AT LINE 1633
                    > USED AT LINE 1854
FTEMP:              0173 DEFINED AT LINE 179
                    > USED AT LINE 1299
FBUFFER:            0174 DEFINED AT LINE 180
                    > USED AT LINE 1730
                    > USED AT LINE 1862
                    > USED AT LINE 1867
SZERROR:            0181 DEFINED AT LINE 183
                    > USED AT LINE 244
SZIN:               0188 DEFINED AT LINE 184
                    > USED AT LINE 1721
SZOK:               018D DEFINED AT LINE 185
                    > USED AT LINE 254
GETFLOWPTR:         0192 DEFINED AT LINE 187
                    > USED AT LINE 200
                    > USED AT LINE 550
                    > USED AT LINE 714
                    > USED AT LINE 918
COPYMEMORYUP:       01A7 DEFINED AT LINE 201
                    > USED AT LINE 298
                    > USED AT LINE 1083
COPYMEMLOOP:        01AD DEFINED AT LINE 205
                    > USED AT LINE 211
CHECKENOUGHVARSPACE: 01B6 DEFINED AT LINE 212
                    > USED AT LINE 557
                    > USED AT LINE 693
                    > USED AT LINE 954
CHECKENOUGHMEM:     01C3 DEFINED AT LINE 220
                    > USED AT LINE 201
                    > USED AT LINE 217
                    > USED AT LINE 1170
                    > USED AT LINE 2054
OUTOFMEMORY:        01CD DEFINED AT LINE 228
                    > USED AT LINE 2049
SYNTAXERROR:        01D0 DEFINED AT LINE 230
                    > USED AT LINE 32
                    > USED AT LINE 599
                    > USED AT LINE 619
                    > USED AT LINE 677
                    > USED AT LINE 761
                    > USED AT LINE 883
                    > USED AT LINE 1039
                    > USED AT LINE 1991
DIVIDEBYZERO:       01D3 DEFINED AT LINE 232
                    > USED AT LINE 1384
ERROR:              01D5 DEFINED AT LINE 233
                    > USED AT LINE 668
                    > USED AT LINE 711
                    > USED AT LINE 718
                    > USED AT LINE 864
                    > USED AT LINE 909
                    > USED AT LINE 926
                    > USED AT LINE 1137
                    > USED AT LINE 1143
                    > USED AT LINE 1286
STOP:               01F7 DEFINED AT LINE 252
                    > USED AT LINE 122
                    > USED AT LINE 137
                    > USED AT LINE 653
MAIN:               01F9 DEFINED AT LINE 254
                    > USED AT LINE 515
                    > USED AT LINE 605
                    > USED AT LINE 2068
                    > USED AT LINE 2070
GETNONBLANKLINE:    01FF DEFINED AT LINE 256
                    > USED AT LINE 262
                    > USED AT LINE 325
STOREPROGRAMLINE:   021C DEFINED AT LINE 271
REMOVEPROGRAMLINE:  0228 DEFINED AT LINE 279
REMOVELINE:         022C DEFINED AT LINE 281
                    > USED AT LINE 286
INSERTPROGRAMLINE:  0239 DEFINED AT LINE 290
                    > USED AT LINE 278
COPYFROMBUFFER:     0255 DEFINED AT LINE 310
                    > USED AT LINE 316
UPDATELINKEDLIST:   0260 DEFINED AT LINE 317
                    > USED AT LINE 292
L0265:              0265 DEFINED AT LINE 320
                    > USED AT LINE 337
L0271:              0271 DEFINED AT LINE 330
                    > USED AT LINE 332
FINDPROGRAMLINE:    027D DEFINED AT LINE 338
                    > USED AT LINE 276
                    > USED AT LINE 357
                    > USED AT LINE 508
                    > USED AT LINE 705
NEW:                0295 DEFINED AT LINE 358
                    > USED AT LINE 141
                    > USED AT LINE 2069
RUN:                02A1 DEFINED AT LINE 366
                    > USED AT LINE 131
RESETALL:           02A2 DEFINED AT LINE 367
                    > USED AT LINE 317
CLEAR:              02A6 DEFINED AT LINE 369
                    > USED AT LINE 140
RESETSTACK:         02B5 DEFINED AT LINE 374
                    > USED AT LINE 233
INPUTLINEWITH:      02C2 DEFINED AT LINE 383
                    > USED AT LINE 865
                    > USED AT LINE 890
                    > USED AT LINE 1982
                    > USED AT LINE 1998
                    > USED AT LINE 2026
TOKENIZE:           02CC DEFINED AT LINE 389
                    > USED AT LINE 266
                    > USED AT LINE 426
KWCOMPARE:          02E9 DEFINED AT LINE 404
                    > USED AT LINE 413
                    > USED AT LINE 446
NOTAKEYWORD:        02FF DEFINED AT LINE 418
                    > USED AT LINE 408
WRITECHAR:          0302 DEFINED AT LINE 421
                    > USED AT LINE 393
                    > USED AT LINE 432
FREECOPYLOOP:       030C DEFINED AT LINE 428
                    > USED AT LINE 437
FREECOPY:           0315 DEFINED AT LINE 433
                    > USED AT LINE 396
NEXTKEYWORD:        031C DEFINED AT LINE 438
                    > USED AT LINE 410
NEXTKWLOOP:         0320 DEFINED AT LINE 442
                    > USED AT LINE 444
EXIT:               0329 DEFINED AT LINE 447
                    > USED AT LINE 398
                    > USED AT LINE 430
BACKSPACE:          0332 DEFINED AT LINE 454
                    > USED AT LINE 472
RESETINPUT:         0338 DEFINED AT LINE 458
                    > USED AT LINE 470
INPUTLINE:          033C DEFINED AT LINE 460
                    > USED AT LINE 258
                    > USED AT LINE 387
INPUTNEXT:          0341 DEFINED AT LINE 462
                    > USED AT LINE 457
                    > USED AT LINE 466
                    > USED AT LINE 468
                    > USED AT LINE 483
L036A:              036A DEFINED AT LINE 482
                    > USED AT LINE 477
OUTCHAR_TAIL:       036E DEFINED AT LINE 484
                    > USED AT LINE 40
                    > USED AT LINE 2010
WAITTERMREADY:      0377 DEFINED AT LINE 488
                    > USED AT LINE 492
INPUTCHAR:          0388 DEFINED AT LINE 497
                    > USED AT LINE 462
                    > USED AT LINE 501
                    > USED AT LINE 651
LIST:               0398 DEFINED AT LINE 505
                    > USED AT LINE 139
LISTNEXTLINE:       03A1 DEFINED AT LINE 510
                    > USED AT LINE 528
LISTCHAR:           03B8 DEFINED AT LINE 524
                    > USED AT LINE 529
                    > USED AT LINE 544
TONEXTKEYWORD:      03CA DEFINED AT LINE 535
                    > USED AT LINE 538
                    > USED AT LINE 541
PRINTKEYWORD:       03D5 DEFINED AT LINE 542
                    > USED AT LINE 547
FOR:                03DF DEFINED AT LINE 548
                    > USED AT LINE 123
L03E2:              03EC DEFINED AT LINE 555
                    > USED AT LINE 552
PUSHSTEPVALUE:      041E DEFINED AT LINE 584
                    > USED AT LINE 578
ENDOFFORHANDLER:    0427 DEFINED AT LINE 591
                    > USED AT LINE 946
EXECNEXT:           042B DEFINED AT LINE 594
                    > USED AT LINE 613
                    > USED AT LINE 721
                    > USED AT LINE 949
EXEC:               0448 DEFINED AT LINE 612
                    > USED AT LINE 270
                    > USED AT LINE 597
                    > USED AT LINE 781
NEXTCHAR_TAIL:      0468 DEFINED AT LINE 633
                    > USED AT LINE 37
RESTORE:            0473 DEFINED AT LINE 640
                    > USED AT LINE 133
                    > USED AT LINE 370
L046E:              0478 DEFINED AT LINE 643
                    > USED AT LINE 903
TESTBREAKKEY:       047D DEFINED AT LINE 646
                    > USED AT LINE 516
                    > USED AT LINE 594
CHARISALPHA:        048E DEFINED AT LINE 654
                    > USED AT LINE 987
                    > USED AT LINE 1038
GETSUBSCRIPT:       0496 DEFINED AT LINE 660
                    > USED AT LINE 840
                    > USED AT LINE 1107
FUNCTIONCALLERROR:  04A6 DEFINED AT LINE 667
                    > USED AT LINE 66
                    > USED AT LINE 663
                    > USED AT LINE 1852
                    > USED AT LINE 2036
LINENUMBERFROMSTR:  04AB DEFINED AT LINE 669
                    > USED AT LINE 264
                    > USED AT LINE 505
                    > USED AT LINE 703
                    > USED AT LINE 1989
                    > USED AT LINE 2003
NEXTLINENUMCHAR:    04AF DEFINED AT LINE 671
                    > USED AT LINE 691
GOSUB:              04CC DEFINED AT LINE 692
                    > USED AT LINE 134
GOTO:               04DD DEFINED AT LINE 703
                    > USED AT LINE 130
                    > USED AT LINE 780
RETURN:             04ED DEFINED AT LINE 712
                    > USED AT LINE 135
FINDNEXTSTATEMENT:  0503 DEFINED AT LINE 723
                    > USED AT LINE 125
                    > USED AT LINE 559
REM:                0505 DEFINED AT LINE 724
                    > USED AT LINE 136
                    > USED AT LINE 778
FINDNEXTSTATEMENTLOOP: 0507 DEFINED AT LINE 726
                    > USED AT LINE 732
LET:                0510 DEFINED AT LINE 733
                    > USED AT LINE 129
                    > USED AT LINE 548
                    > USED AT LINE 617
ASSIGNVAR:          0515 DEFINED AT LINE 736
                    > USED AT LINE 893
IFL:                0524 DEFINED AT LINE 745
                    > USED AT LINE 132
GETCOMPAREOPLOOP:   052D DEFINED AT LINE 749
                    > USED AT LINE 758
GOTCOMPAREOP:       0540 DEFINED AT LINE 759
                    > USED AT LINE 750
                    > USED AT LINE 752
PRINT:              0565 DEFINED AT LINE 784
                    > USED AT LINE 138
                    > USED AT LINE 788
                    > USED AT LINE 804
                    > USED AT LINE 857
TERMINATEINPUT:     0593 DEFINED AT LINE 805
                    > USED AT LINE 464
NEWLINE:            0598 DEFINED AT LINE 807
                    > USED AT LINE 234
                    > USED AT LINE 459
                    > USED AT LINE 485
                    > USED AT LINE 518
                    > USED AT LINE 784
                    > USED AT LINE 830
                    > USED AT LINE 834
                    > USED AT LINE 1979
                    > USED AT LINE 2063
PRINTNULLLOOP:      05A4 DEFINED AT LINE 813
                    > USED AT LINE 820
PRINTSTRING:        05B1 DEFINED AT LINE 822
                    > USED AT LINE 245
                    > USED AT LINE 787
                    > USED AT LINE 800
                    > USED AT LINE 831
                    > USED AT LINE 1722
                    > USED AT LINE 1728
                    > USED AT LINE 1981
                    > USED AT LINE 1997
                    > USED AT LINE 2025
                    > USED AT LINE 2066
                    > USED AT LINE 2067
TONEXTTABBREAK:     05C1 DEFINED AT LINE 832
                    > USED AT LINE 793
                    > USED AT LINE 2017
CALCSPACECOUNT:     05CC DEFINED AT LINE 836
                    > USED AT LINE 837
TAB:                05D5 DEFINED AT LINE 840
                    > USED AT LINE 790
PRINTSPACES:        05E4 DEFINED AT LINE 849
                    > USED AT LINE 839
PRINTSPACELOOP:     05E8 DEFINED AT LINE 852
                    > USED AT LINE 854
EXITTAB:            05ED DEFINED AT LINE 855
                    > USED AT LINE 795
                    > USED AT LINE 835
                    > USED AT LINE 848
INPUT:              05F2 DEFINED AT LINE 858
                    > USED AT LINE 126
READ:               0604 DEFINED AT LINE 867
                    > USED AT LINE 128
L05FA:              0608 DEFINED AT LINE 869
                    > USED AT LINE 866
READNEXT:           060F DEFINED AT LINE 874
                    > USED AT LINE 897
GOTDATAITEM:        062E DEFINED AT LINE 891
                    > USED AT LINE 881
                    > USED AT LINE 915
NEXTDATALINE:       0643 DEFINED AT LINE 904
                    > USED AT LINE 887
                    > USED AT LINE 913
NEXT:               0657 DEFINED AT LINE 916
                    > USED AT LINE 124
FORLOOPISCOMPLETE:  0691 DEFINED AT LINE 947
                    > USED AT LINE 941
EVALEXPRESSION:     0698 DEFINED AT LINE 950
                    > USED AT LINE 566
                    > USED AT LINE 579
                    > USED AT LINE 661
                    > USED AT LINE 737
                    > USED AT LINE 745
                    > USED AT LINE 763
                    > USED AT LINE 797
                    > USED AT LINE 984
                    > USED AT LINE 999
ARITHPARSE:         06A7 DEFINED AT LINE 957
                    > USED AT LINE 977
EVALTERM:           06D2 DEFINED AT LINE 985
                    > USED AT LINE 955
                    > USED AT LINE 990
                    > USED AT LINE 1003
EVALBRACKETED:      06F0 DEFINED AT LINE 997
                    > USED AT LINE 1019
EVALMINUSTERM:      06F8 DEFINED AT LINE 1003
                    > USED AT LINE 994
EVALVARTERM:        0701 DEFINED AT LINE 1008
                    > USED AT LINE 988
EVALINLINEFN:       070B DEFINED AT LINE 1014
                    > USED AT LINE 996
DIMCONTD:           071F DEFINED AT LINE 1027
                    > USED AT LINE 1032
DIM:                0724 DEFINED AT LINE 1032
                    > USED AT LINE 127
GETVAR:             0729 DEFINED AT LINE 1035
                    > USED AT LINE 733
                    > USED AT LINE 876
                    > USED AT LINE 916
                    > USED AT LINE 1008
FINDVARLOOP:        0749 DEFINED AT LINE 1052
                    > USED AT LINE 1066
L0747:              0755 DEFINED AT LINE 1060
                    > USED AT LINE 1057
ALLOCNEWVAR:        0760 DEFINED AT LINE 1067
                    > USED AT LINE 1053
INITVARLOOP:        0784 DEFINED AT LINE 1089
                    > USED AT LINE 1092
L0782:              0790 DEFINED AT LINE 1098
                    > USED AT LINE 1061
ALREADYALLOCD:      0793 DEFINED AT LINE 1101
                    > USED AT LINE 1073
GETARRAYVAR:        0798 DEFINED AT LINE 1104
                    > USED AT LINE 1047
FINDARRAY:          07AF DEFINED AT LINE 1119
                    > USED AT LINE 1133
L07BF:              07CD DEFINED AT LINE 1138
                    > USED AT LINE 1177
ALLOCARRAY:         07DB DEFINED AT LINE 1149
                    > USED AT LINE 1127
L07E1:              07EF DEFINED AT LINE 1163
                    > USED AT LINE 1156
INITELEMENTS:       07FD DEFINED AT LINE 1173
                    > USED AT LINE 1176
FWORDTOFLOAT:       0807 DEFINED AT LINE 1178
FADDONEHALF:        080F DEFINED AT LINE 1182
                    > USED AT LINE 1757
                    > USED AT LINE 1928
FADDMEM:            0812 DEFINED AT LINE 1183
                    > USED AT LINE 930
FSUB:               0818 DEFINED AT LINE 1185
                    > USED AT LINE 73
                    > USED AT LINE 1920
                    > USED AT LINE 1924
FADD:               081E DEFINED AT LINE 1189
                    > USED AT LINE 71
                    > USED AT LINE 1184
                    > USED AT LINE 1483
                    > USED AT LINE 1706
                    > USED AT LINE 1872
                    > USED AT LINE 1896
                    > USED AT LINE 1936
                    > USED AT LINE 1956
L082C:              083A DEFINED AT LINE 1207
                    > USED AT LINE 1198
FSUBMANTISSAS:      085B DEFINED AT LINE 1222
                    > USED AT LINE 1214
FNORMALISE:         0869 DEFINED AT LINE 1236
                    > USED AT LINE 1351
                    > USED AT LINE 1506
                    > USED AT LINE 1641
                    > USED AT LINE 1905
NORMLOOP:           0873 DEFINED AT LINE 1241
                    > USED AT LINE 1249
FROUNDUP:           088C DEFINED AT LINE 1255
                    > USED AT LINE 1216
                    > USED AT LINE 1221
                    > USED AT LINE 1240
                    > USED AT LINE 1431
FMANTISSALEFT:      089E DEFINED AT LINE 1266
                    > USED AT LINE 1247
                    > USED AT LINE 1433
FMANTISSAINC:       08A8 DEFINED AT LINE 1276
                    > USED AT LINE 1258
                    > USED AT LINE 1621
OVERFLOW:           08B2 DEFINED AT LINE 1285
                    > USED AT LINE 1219
                    > USED AT LINE 1450
                    > USED AT LINE 1472
                    > USED AT LINE 1481
                    > USED AT LINE 1487
FADDMANTISSAS:      08B7 DEFINED AT LINE 1287
                    > USED AT LINE 1215
                    > USED AT LINE 1798
FNEGATEINT:         08C3 DEFINED AT LINE 1299
                    > USED AT LINE 1236
                    > USED AT LINE 1623
FMANTISSARTMULT:    08D7 DEFINED AT LINE 1317
                    > USED AT LINE 1211
                    > USED AT LINE 1618
RTMULTLOOP:         08DB DEFINED AT LINE 1320
                    > USED AT LINE 1324
FMANTISSARTONCE:    08E4 DEFINED AT LINE 1325
                    > USED AT LINE 1220
                    > USED AT LINE 1323
                    > USED AT LINE 1371
FMUL:               08F1 DEFINED AT LINE 1338
                    > USED AT LINE 75
                    > USED AT LINE 1876
                    > USED AT LINE 1893
                    > USED AT LINE 1941
                    > USED AT LINE 1952
                    > USED AT LINE 1963
FMULOUTERLOOP:      0913 DEFINED AT LINE 1357
                    > USED AT LINE 1353
FMULINNERLOOP:      0918 DEFINED AT LINE 1361
                    > USED AT LINE 1345
                    > USED AT LINE 1347
                    > USED AT LINE 1374
L0919:              0927 DEFINED AT LINE 1371
                    > USED AT LINE 1364
POPHLANDRETURN:     092F DEFINED AT LINE 1375
                    > USED AT LINE 1465
FDIVBYTEN:          0931 DEFINED AT LINE 1377
                    > USED AT LINE 1679
                    > USED AT LINE 1752
FDIV:               093D DEFINED AT LINE 1381
                    > USED AT LINE 77
                    > USED AT LINE 1869
                    > USED AT LINE 1915
FDIVLOOP:           0962 DEFINED AT LINE 1405
                    > USED AT LINE 1444
                    > USED AT LINE 1449
L095F:              096D DEFINED AT LINE 1414
                    > USED AT LINE 1391
                    > USED AT LINE 1394
                    > USED AT LINE 1397
                    > USED AT LINE 1404
                    > USED AT LINE 1420
                    > USED AT LINE 1438
                    > USED AT LINE 1440
L0971:              097F DEFINED AT LINE 1425
                    > USED AT LINE 1419
FEXPONENTADD:       09A9 DEFINED AT LINE 1451
                    > USED AT LINE 1343
                    > USED AT LINE 1386
                    > USED AT LINE 1453
                    > USED AT LINE 1462
FZERO:              09CC DEFINED AT LINE 1473
                    > USED AT LINE 1242
                    > USED AT LINE 1253
                    > USED AT LINE 1643
FMULBYTEN:          09D1 DEFINED AT LINE 1476
                    > USED AT LINE 1687
                    > USED AT LINE 1699
FTESTSIGN_TAIL:     09E8 DEFINED AT LINE 1488
                    > USED AT LINE 52
INVSIGNTOINT:       09EC DEFINED AT LINE 1490
                    > USED AT LINE 1572
SIGNTOINT:          09ED DEFINED AT LINE 1491
SGN:                09F2 DEFINED AT LINE 1496
                    > USED AT LINE 63
FCHARTOFLOAT:       09F3 DEFINED AT LINE 1497
                    > USED AT LINE 1181
                    > USED AT LINE 1703
                    > USED AT LINE 1727
ABS:                0A06 DEFINED AT LINE 1507
                    > USED AT LINE 65
FNEGATE:            0A08 DEFINED AT LINE 1509
                    > USED AT LINE 1005
                    > USED AT LINE 1187
                    > USED AT LINE 1740
                    > USED AT LINE 1932
                    > USED AT LINE 1938
FPUSH:              0A10 DEFINED AT LINE 1514
                    > USED AT LINE 747
                    > USED AT LINE 980
                    > USED AT LINE 1202
                    > USED AT LINE 1377
                    > USED AT LINE 1702
                    > USED AT LINE 1866
                    > USED AT LINE 1909
                    > USED AT LINE 1916
                    > USED AT LINE 1939
                    > USED AT LINE 1942
FLOADFROMMEM:       0A1D DEFINED AT LINE 1523
                    > USED AT LINE 927
                    > USED AT LINE 1011
                    > USED AT LINE 1889
                    > USED AT LINE 1944
FLOADFROMBCDE:      0A20 DEFINED AT LINE 1524
                    > USED AT LINE 1196
                    > USED AT LINE 1204
                    > USED AT LINE 1265
                    > USED AT LINE 1380
                    > USED AT LINE 1760
                    > USED AT LINE 1800
                    > USED AT LINE 1912
FCOPYTOBCDE:        0A2B DEFINED AT LINE 1531
                    > USED AT LINE 568
                    > USED AT LINE 581
                    > USED AT LINE 1476
                    > USED AT LINE 1611
                    > USED AT LINE 1780
                    > USED AT LINE 1897
                    > USED AT LINE 1940
FLOADBCDEFROMMEM:   0A2E DEFINED AT LINE 1532
                    > USED AT LINE 934
                    > USED AT LINE 940
                    > USED AT LINE 1183
                    > USED AT LINE 1523
                    > USED AT LINE 1868
                    > USED AT LINE 1954
INCHLRETURN:        0A35 DEFINED AT LINE 1539
                    > USED AT LINE 1776
                    > USED AT LINE 1815
FCOPYTOMEM:         0A37 DEFINED AT LINE 1541
                    > USED AT LINE 741
                    > USED AT LINE 932
                    > USED AT LINE 1863
                    > USED AT LINE 1907
FCOPYLOOP:          0A3C DEFINED AT LINE 1543
                    > USED AT LINE 1548
FUNPACKMANTISSAS:   0A45 DEFINED AT LINE 1550
                    > USED AT LINE 1208
                    > USED AT LINE 1466
                    > USED AT LINE 1612
FCOMPARE:           0A5A DEFINED AT LINE 1569
                    > USED AT LINE 772
                    > USED AT LINE 936
                    > USED AT LINE 1746
                    > USED AT LINE 1840
FISEQUAL:           0A72 DEFINED AT LINE 1585
                    > USED AT LINE 1581
FASINTEGER:         0A85 DEFINED AT LINE 1604
                    > USED AT LINE 666
                    > USED AT LINE 1637
                    > USED AT LINE 1759
FMANTISSADEC:       0AA9 DEFINED AT LINE 1626
                    > USED AT LINE 1615
INT:                0AB0 DEFINED AT LINE 1633
                    > USED AT LINE 64
                    > USED AT LINE 1917
FIN:                0AC1 DEFINED AT LINE 1642
                    > USED AT LINE 986
                    > USED AT LINE 992
FINLOOP:            0ACA DEFINED AT LINE 1649
                    > USED AT LINE 1672
                    > USED AT LINE 1710
GETEXPONENT:        0AD8 DEFINED AT LINE 1655
NEXTEXPONENTDIGIT:  0AE6 DEFINED AT LINE 1663
                    > USED AT LINE 1658
                    > USED AT LINE 1661
                    > USED AT LINE 1719
L0AE4:              0AF2 DEFINED AT LINE 1671
                    > USED AT LINE 1652
SCALERESULT:        0AF6 DEFINED AT LINE 1673
                    > USED AT LINE 1654
                    > USED AT LINE 1666
DECIMALLOOP:        0AF9 DEFINED AT LINE 1676
                    > USED AT LINE 1682
DECIMALLOOPEND:     0B05 DEFINED AT LINE 1682
                    > USED AT LINE 1677
DECIMALSHIFTUP:     0B0A DEFINED AT LINE 1685
                    > USED AT LINE 1676
                    > USED AT LINE 1749
PROCESSDIGIT:       0B12 DEFINED AT LINE 1691
                    > USED AT LINE 1650
DOEXPONENTDIGIT:    0B31 DEFINED AT LINE 1711
                    > USED AT LINE 1664
PRINTIN:            0B3D DEFINED AT LINE 1720
                    > USED AT LINE 250
PRINTINT:           0B45 DEFINED AT LINE 1724
                    > USED AT LINE 521
                    > USED AT LINE 2064
FOUT:               0B50 DEFINED AT LINE 1730
                    > USED AT LINE 799
DOZERO:             0B5C DEFINED AT LINE 1736
                    > USED AT LINE 1734
TOOVER100000:       0B6B DEFINED AT LINE 1744
                    > USED AT LINE 1751
L0B71:              0B7F DEFINED AT LINE 1752
                    > USED AT LINE 1842
PREPARETOPRINT:     0B88 DEFINED AT LINE 1757
                    > USED AT LINE 1747
L0B95:              0BA3 DEFINED AT LINE 1770
                    > USED AT LINE 1764
                    > USED AT LINE 1766
NEXTDIGIT:          0BA9 DEFINED AT LINE 1774
                    > USED AT LINE 1807
DIGITLOOP:          0BB8 DEFINED AT LINE 1783
                    > USED AT LINE 1797
L0BCF:              0BDD DEFINED AT LINE 1810
                    > USED AT LINE 1813
L0BDB:              0BE9 DEFINED AT LINE 1816
                    > USED AT LINE 1809
L0BEB:              0BF9 DEFINED AT LINE 1825
                    > USED AT LINE 1821
EXPDIGITLOOP:       0BFB DEFINED AT LINE 1826
                    > USED AT LINE 1828
NULLTERM:           0C08 DEFINED AT LINE 1835
                    > USED AT LINE 1738
                    > USED AT LINE 1817
TOUNDER1000000:     0C0B DEFINED AT LINE 1838
                    > USED AT LINE 1743
                    > USED AT LINE 1756
ONE_HALF:           0C19 DEFINED AT LINE 1844
                    > USED AT LINE 1182
DECIMAL_POWERS:     0C1D DEFINED AT LINE 1845
                    > USED AT LINE 1773
SQR:                0C2F DEFINED AT LINE 1851
                    > USED AT LINE 67
                    > USED AT LINE 2084
SQRLOOP:            0C47 DEFINED AT LINE 1865
                    > USED AT LINE 1879
RND:                0C6D DEFINED AT LINE 1886
                    > USED AT LINE 68
                    > USED AT LINE 2080
L0C7C:              0C8A DEFINED AT LINE 1897
                    > USED AT LINE 1887
RND_SEED:           0C9F DEFINED AT LINE 1908
                    > USED AT LINE 1888
                    > USED AT LINE 1906
SIN:                0CA3 DEFINED AT LINE 1909
                    > USED AT LINE 69
                    > USED AT LINE 2077
NEGATEIFPOSITIVE:   0CD1 DEFINED AT LINE 1931
                    > USED AT LINE 1927
TAYLORLOOP:         0CF7 DEFINED AT LINE 1948
                    > USED AT LINE 1962
TAYLOR_SERIES:      0D11 DEFINED AT LINE 1964
                    > USED AT LINE 1943
L0D17:              0D25 DEFINED AT LINE 1969
                    > USED AT LINE 2074
INIT:               0D2F DEFINED AT LINE 1970
                    > USED AT LINE 22
                    > USED AT LINE 255
CONFIGIOCODE:       0D3D DEFINED AT LINE 1977
                    > USED AT LINE 1975
L0DDE:              0D5A DEFINED AT LINE 1988
                    > USED AT LINE 1985
DONEMEMSIZE:        0D66 DEFINED AT LINE 1994
                    > USED AT LINE 1987
GETTERMINALWIDTH:   0D68 DEFINED AT LINE 1996
                    > USED AT LINE 2006
                    > USED AT LINE 2009
CALCTABBRKSIZE:     0D8A DEFINED AT LINE 2011
                    > USED AT LINE 2012
DOOPTIONALFNS:      0D97 DEFINED AT LINE 2018
                    > USED AT LINE 2001
                    > USED AT LINE 2033
OPTIONALFNSLOOP:    0D9A DEFINED AT LINE 2019
                    > USED AT LINE 2041
L0E32:              0DAE DEFINED AT LINE 2030
                    > USED AT LINE 2022
INITPROGRAMBASE:    0DC3 DEFINED AT LINE 2042
                    > USED AT LINE 2031
OPT_FN_DESCS:       0E01 DEFINED AT LINE 2074
                    > USED AT LINE 2018
SZWANTSIN:          0E15 DEFINED AT LINE 2086
                    > USED AT LINE 2020
                    > USED AT LINE 2075
SZWANTRND:          0E1E DEFINED AT LINE 2087
                    > USED AT LINE 2078
SZWANTSQR:          0E27 DEFINED AT LINE 2088
                    > USED AT LINE 2081
SZTERMINALWIDTH:    0E30 DEFINED AT LINE 2091
                    > USED AT LINE 1996
SZVERSIONINFO:      0E3F DEFINED AT LINE 2093
                    > USED AT LINE 2065
SZMEMORYSIZE:       0E6C DEFINED AT LINE 2096
                    > USED AT LINE 1980
UNUSEDMEMORY:       0E78 DEFINED AT LINE 2100